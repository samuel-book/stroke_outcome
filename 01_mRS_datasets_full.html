
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Defining modified Rankin Scale (mRS) probability distributions for untreated patients, and predicted distributions if treatment given at time of stroke onset &#8212; Stroke outcome modelling</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Mathematics for calculating odds and probabilities of mRS-level outcomes after stroke, based on time to reperfusion treatment" href="02_mRS_outcomes_maths.html" />
    <link rel="prev" title="Predicting disability outcomes and utility after treatment of stroke with thrombolysis (IVT) or thrombectomy (MT)" href="intro.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Stroke outcome modelling</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Predicting disability outcomes and utility after treatment of stroke with thrombolysis (IVT) or thrombectomy (MT)
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Defining modified Rankin Scale (mRS) probability distributions for untreated patients, and predicted distributions if treatment given at time of stroke onset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02_mRS_outcomes_maths.html">
   Mathematics for calculating odds and probabilities of mRS-level outcomes after stroke, based on time to reperfusion treatment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03_demo_of_outcome_model.html">
   Example output from stroke outcome model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04_matrix.html">
   Demonstration of added utility depending on time to IVT and MT
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05_geography.html">
   Distance-based treatment effects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06_show_outcome_model_code.html">
   Show outcome model python code
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="90_proportion_ischaemic_with_lvo.html">
   Proportion of ischaemic patients with LVO
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/01_mRS_datasets_full.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Defining modified Rankin Scale (mRS) probability distributions for untreated patients, and predicted distributions if treatment given at time of stroke onset
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plain-english-summary">
     Plain English Summary
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#method">
   Method
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-code">
   The code
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#import-packages">
     Import packages
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set-up-dictionaries-for-results">
     Set up dictionaries for results
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pre-stroke-mrs-distribution-fully-recovered">
     Pre-stroke mRS distribution (fully recovered)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#pre-stroke-mrs-distribution-for-nlvo-patients">
       Pre-stroke mRS distribution for nLVO patients
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#add-ivt-extra-deaths-to-pre-stroke-nlvo-patients">
         Add IVT extra deaths (to pre-stroke nLVO patients)
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lvo-pre-stroke-mrs-distribution">
       LVO pre-stroke mRS distribution
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#add-ivt-extra-deaths-to-pre-stroke-lvo-patients">
         Add IVT extra deaths (to pre-stroke LVO patients)
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#add-mt-extra-deaths-to-pre-stroke-lvo-patients">
         Add MT extra deaths (to pre-stroke LVO patients)
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#treatment-has-no-effect-mrs-distribution-nlvo-patients-with-ivt">
     Treatment has no effect mRS distribution: nLVO patients with IVT
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#add-ivt-extra-deaths-for-lees-untreated-control-group-combined-nlvo-lvo">
       Add IVT extra deaths (for Lees untreated control group, combined nLVO/LVO)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#add-ivt-extra-deaths-for-goyal-s-untreated-control-group-lvo">
       Add IVT extra deaths (for Goyal’s untreated control group, LVO)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#calculate-a-weighted-distribution-of-lvo-and-nlvo">
       Calculate a weighted distribution of LVO and nLVO
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#calculate-weights-without-excess-ivt-deaths">
         Calculate weights without excess IVT deaths
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#calculate-weights-with-excess-ivt-deaths">
         Calculate weights with excess IVT deaths
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#mrs-distribution-at-t-0-for-nlvo-patients-with-ivt">
       mRS distribution at
       <em>
        t = 0
       </em>
       for nLVO patients with IVT
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#treatment-has-no-effect-mrs-distribution-lvo-patients-with-ivt-or-mt">
     Treatment has no effect mRS distribution: LVO patients with IVT or MT
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#add-ivt-extra-deaths-for-goyals-untreated-control-group-lvo">
       Add IVT extra deaths (for Goyals untreated control group, LVO)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#add-mt-extra-deaths-for-goyals-untreated-control-group-lvo">
       Add MT extra deaths (for Goyals untreated control group, LVO)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#mrs-distribution-at-t-0-for-lvo-patients-with-ivt">
       mRS distribution at
       <em>
        t = 0
       </em>
       for LVO patients with IVT
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mrs-distribution-at-t-0-for-lvo-patients-with-mt">
     mRS distribution at
     <em>
      t = 0
     </em>
     for LVO patients with MT
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#show-all-results">
     Show all results
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-distributions">
     Plot distributions
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#references">
     References
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#appendix">
     Appendix
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#excess-deaths-due-to-treatment">
       1. Excess deaths due to treatment
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#ivt-deaths-due-to-fatal-intracranial-haemorrhage-emberson-et-al-2014">
         IVT deaths due to fatal intracranial haemorrhage (Emberson et al., 2014):
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#mt-deaths-goyal-et-al-2016">
         MT deaths (Goyal et al., 2016):
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Defining modified Rankin Scale (mRS) probability distributions for untreated patients, and predicted distributions if treatment given at time of stroke onset</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Defining modified Rankin Scale (mRS) probability distributions for untreated patients, and predicted distributions if treatment given at time of stroke onset
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plain-english-summary">
     Plain English Summary
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#method">
   Method
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-code">
   The code
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#import-packages">
     Import packages
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set-up-dictionaries-for-results">
     Set up dictionaries for results
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pre-stroke-mrs-distribution-fully-recovered">
     Pre-stroke mRS distribution (fully recovered)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#pre-stroke-mrs-distribution-for-nlvo-patients">
       Pre-stroke mRS distribution for nLVO patients
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#add-ivt-extra-deaths-to-pre-stroke-nlvo-patients">
         Add IVT extra deaths (to pre-stroke nLVO patients)
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lvo-pre-stroke-mrs-distribution">
       LVO pre-stroke mRS distribution
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#add-ivt-extra-deaths-to-pre-stroke-lvo-patients">
         Add IVT extra deaths (to pre-stroke LVO patients)
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#add-mt-extra-deaths-to-pre-stroke-lvo-patients">
         Add MT extra deaths (to pre-stroke LVO patients)
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#treatment-has-no-effect-mrs-distribution-nlvo-patients-with-ivt">
     Treatment has no effect mRS distribution: nLVO patients with IVT
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#add-ivt-extra-deaths-for-lees-untreated-control-group-combined-nlvo-lvo">
       Add IVT extra deaths (for Lees untreated control group, combined nLVO/LVO)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#add-ivt-extra-deaths-for-goyal-s-untreated-control-group-lvo">
       Add IVT extra deaths (for Goyal’s untreated control group, LVO)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#calculate-a-weighted-distribution-of-lvo-and-nlvo">
       Calculate a weighted distribution of LVO and nLVO
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#calculate-weights-without-excess-ivt-deaths">
         Calculate weights without excess IVT deaths
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#calculate-weights-with-excess-ivt-deaths">
         Calculate weights with excess IVT deaths
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#mrs-distribution-at-t-0-for-nlvo-patients-with-ivt">
       mRS distribution at
       <em>
        t = 0
       </em>
       for nLVO patients with IVT
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#treatment-has-no-effect-mrs-distribution-lvo-patients-with-ivt-or-mt">
     Treatment has no effect mRS distribution: LVO patients with IVT or MT
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#add-ivt-extra-deaths-for-goyals-untreated-control-group-lvo">
       Add IVT extra deaths (for Goyals untreated control group, LVO)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#add-mt-extra-deaths-for-goyals-untreated-control-group-lvo">
       Add MT extra deaths (for Goyals untreated control group, LVO)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#mrs-distribution-at-t-0-for-lvo-patients-with-ivt">
       mRS distribution at
       <em>
        t = 0
       </em>
       for LVO patients with IVT
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mrs-distribution-at-t-0-for-lvo-patients-with-mt">
     mRS distribution at
     <em>
      t = 0
     </em>
     for LVO patients with MT
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#show-all-results">
     Show all results
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-distributions">
     Plot distributions
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#references">
     References
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#appendix">
     Appendix
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#excess-deaths-due-to-treatment">
       1. Excess deaths due to treatment
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#ivt-deaths-due-to-fatal-intracranial-haemorrhage-emberson-et-al-2014">
         IVT deaths due to fatal intracranial haemorrhage (Emberson et al., 2014):
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#mt-deaths-goyal-et-al-2016">
         MT deaths (Goyal et al., 2016):
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="defining-modified-rankin-scale-mrs-probability-distributions-for-untreated-patients-and-predicted-distributions-if-treatment-given-at-time-of-stroke-onset">
<h1>Defining modified Rankin Scale (mRS) probability distributions for untreated patients, and predicted distributions if treatment given at time of stroke onset<a class="headerlink" href="#defining-modified-rankin-scale-mrs-probability-distributions-for-untreated-patients-and-predicted-distributions-if-treatment-given-at-time-of-stroke-onset" title="Permalink to this headline">#</a></h1>
<section id="plain-english-summary">
<h2>Plain English Summary<a class="headerlink" href="#plain-english-summary" title="Permalink to this headline">#</a></h2>
<p>When we predict the outcome of a person who has had a stroke, we want to be able to say what is the likely improvement in disability level they would experience due to the treatment.</p>
<p>Disability levels may be measured in various ways. In this project we are using the modified Rankin Scale (mRS). It is a commonly used scale for measuring the degree of disability or dependence in the daily activities of people who have suffered a stroke.</p>
<p>The scale runs from 0-6, running from perfect health without symptoms to death:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Score</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>No symptoms.</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>No significant disability. Able to carry out all usual activities, despite some symptoms.</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Slight disability. Able to look after own affairs without assistance, but unable to carry out all previous activities.</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>Moderate disability. Requires some help, but able to walk unassisted.</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>Moderately severe disability. Unable to attend to own bodily needs without assistance, and unable to walk unassisted.</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>Severe disability. Requires constant nursing care and attention, bedridden, incontinent.</p></td>
</tr>
<tr class="row-even"><td><p>6</p></td>
<td><p>Dead.</p></td>
</tr>
</tbody>
</table>
<p>The improvement in disability level they can get will depend on the time from when their stroke symptoms began and when they receive treatment. The best possible outcome would be if they were treated immediately after they had their stroke. The benefit of treatment reduces over time until the treatment no longer offers any benefit, and they will not be better off than having no treatment.</p>
<p>In this notebook we describe how we estimate the spread of disability levels if treatment was given immediately after the stroke (at <em>t = 0</em>), and what the spread of disability levels would be if the treatment was given at a time when it was no longer effective (at <em>t = No Effect</em>). These are two key pieces of information we will later use to estimate the spread of disability levels if we know the time after stroke symptoms began when a person was treated with either thrombolysis (IVT), a clot-busting medication, or thrombectomy (MT), the physical removal of a clot. The methodology described here is for patients with an ischaemic stroke (a stroke that is caused by a clot), where the location of the clot is either in a large vessel occlusion (LVO), or not (nLVO).</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="method">
<h1>Method<a class="headerlink" href="#method" title="Permalink to this headline">#</a></h1>
<p>A more in depth description of the method is found in the document <a class="reference internal" href="intro.html"><span class="doc std std-doc">predicting granular disability outcomes after treatment of stroke with thrombolysis (IVT) or thrombectomy (MT)</span></a></p>
<p>This model contains mRS outcome distributions for three patient-treatment cohorts: 1) nLVO-IVT (patients with an nLVO that are treated with IVT), 2) LVO-IVT (patients with an LVO that are treated with IVT), 3) LVO-MT (patients with an LVO that are treated with MT). For each patient-treatment cohort, we estimate two mRS distributions: one mRS distribution if treatment is given at <em>t = 0</em> (time of stroke onset), and one mRS distribution if treatment is given at <em>t = No Effect</em> (time of no effect). In order to estimate these two mRS distributions, we use data from reperfusion treatment clinical trials and stroke admission data from England and Wales (Sentinel Stroke National Audit Programme, SSNAP). To select the relevant patients for each cohort we will use the National Institutes of Health Stroke Scale (NIHSS) on arrival as a surrogate to classify patients as nLVO (NIHSS 0-10) or LVO (NIHSS 11+).</p>
<p>All mRS distributions created are based on the assumption that, following treatment, the mRS distribution will lie between two extremes: 1) reperfusion perfectly restores function, and the resulting mRS distribution is the same as the pre-stroke mRS distribution (this data is obtained from the SSNAP dataset), and 2) reperfusion treatment fails to restore any function and the resulting mRS distribution is the same as a control untreated population, though with added excess deaths that may be caused by the treatment. To create required mRS distributions we find a weighting between these two extremes that give us a distribution that matches published reference points.</p>
<p>The <em>t = 0</em> mRS distributions are calculated to give the expected mRS distributions if treatment was given immediately after stroke onset, and also include the risk of excess deaths caused by taking the treatment. Further details specific to stroke type and treatment type are given below.</p>
<p>The <em>t = No Effect</em> mRS distributions are based on mRS distribution data when patients did not receive any treatment (this represents what will happen if the patient takes the treatment at <em>t = No Effect</em>). This data is obtained from the untreated control group in clinical trials and further adjusted to include the risk of excess deaths caused by taking the treatment. Further details specific to stroke type and treatment type are given below.</p>
<p>From this description it can be seen that for each patient-treatment cohort four pieces of information are required:</p>
<ol class="simple">
<li><p><strong>pre-stroke mRS distribution</strong> (fully recovered)</p></li>
<li><p><strong>treatment has no effect mRS distribution</strong></p></li>
<li><p><strong>excess deaths</strong> due to treatment</p></li>
<li><p><strong>weights</strong> to combine the two mRS distributions (pre-stroke and no effect) to represent the <em>t = 0</em> mRS distribution.</p></li>
</ol>
<p>Next we describe how we obtain these four pieces of information for the three patient-treatment cohorts.</p>
<ol class="simple">
<li><p><strong>Pre-stroke mRS distribution</strong> (fully recovered)</p></li>
</ol>
<p>The <em>pre-stroke mRS distribution</em> is taken from the SSNAP dataset, extracting the patients that have an ischaemic stroke and using NIHSS 0-10 as a surrogate for nLVO, or NIHSS 11+ as a surrogate for LVO to further extract the relevant patients for each patient-treatment cohort. This mRS distribution is then corrected for the excess deaths due to treatment (see <em>weights</em> subsection below for more information).</p>
<ol class="simple">
<li><p><strong>Treatment has no effect mRS distribution</strong></p></li>
</ol>
<ul class="simple">
<li><p>For <em>nLVO patients</em> the <em>no effect mRS distribution</em> is taken from the untreated control group of combined nLVO/LVO data from Lees et al. 2010, and from that we remove the contribution of the LVO patients by using the results from the untreated control group of LVO-only data from Goyal et al. 2016. Each mRS distribution (Lees, and Goyal) are adjusted to account for the excess deaths due to IVT treatment (using their relevant patient type: nLVO and/or LVO, see <em>weights</em> subsection below for more information). The two mRS distributions are then combined, using weightings (154% Lees and -54% Goyal) chosen such that the resulting mRS distribution represents just the nLVO patients and matches the P(mRS &lt;= 1, <em>t = No Effect”</em>) of 0.46 (from the control group in Emberson with NIHSS of 0-10).</p></li>
<li><p>For <em>LVO patients</em> the <em>no effect mRS distribution</em> is taken from the untreated control population from Goyal et al. 2016.  This mRS distribution is then corrected for the excess deaths due to treatment (see <em>weights</em> subsection below for more information).</p></li>
</ul>
<ol class="simple">
<li><p><strong>Excess deaths</strong></p></li>
</ol>
<p>All mRS distributions are corrected for the <em>excess deaths</em> due to treatment. We use 1.10% for nLVO patients with IVT, 3.41% for LVO patients with IVT, 2.29% for a combination of nLVO/LVO patients with IVT (risk of fatal cerebral harmorrhage, Emberson et al., 2014), and 3.6% for MT (this is an adjustment of deaths in the model to give an overal mortality of 15.3% when treatment time is 285 minnutes, from the trial-metanalysis of Goyal et al., 2016). See appendix for more details.</p>
<ol class="simple">
<li><p><strong>Weights</strong> (for combining the no effect and fully recovered mRS distributions for t = 0)</p></li>
</ol>
<ul class="simple">
<li><p>For nLVO patients treated with IVT at <em>t = 0</em> the <em>weights</em> used to combine the two mRS distributions (61% fully recovered &amp; 39% no effect) were informed by data from Emberson et al. 2014, and found in order to match the P(mRS &lt;= 1, t=0) of 0.63. 46% of patients with NIHSS 0-10 had mRS 0-1 in the untreated group (see figure 2 Emberson et al. 2014). Translated into a odds of a good outcome (0.85), and multipied with the odds ratio for mRS 0-1 at <em>t = 0</em> (which is 2.0, obtained from extrapolating back to <em>t = 0</em> in figure 1 Emberson et al. 2014), gives a probability of 63%.</p></li>
<li><p>For LVO patients treated with IVT at <em>t = 0</em> the <em>weights</em> used to combine these two mRS distributions (18% fully recovered &amp; 82% no effect) are chosen to match predicted P(mRS &lt;= 1, t=0) of 0.20, which is set as a target by extrapolating the control group mRS for patients with NIHSS 11+ from Emberson et al. 2014 back to a predicted odds ratio of mRS 0-1 of 2.0 at <em>t = 0</em>.</p></li>
<li><p>For LVO patients treated with MT at <em>t = 0</em> the <em>weights</em> used to combine these two mRS distributions (75% fully recovered &amp; 25% no effect) are taken from Hui et al. 2020, who reported 75% successful recanalisation with thrombectomy. We assume that recanalisation at t=0 restores all pre-stroke function*.</p></li>
</ul>
<p>*Extrapolating results of good outcome, when recanalisation has been achieved with MT, from Fransen et al. 2016 back to <em>t = 0</em>, assuming 75% recanalisation, gives the same proportion of patients with mRS &lt;= 2 as the pre-stroke mRS in the SSNAP data (therefore this extrapolation would suggest full recovery of all health with MT theoretically carried out at <em>t = 0</em>).</p>
<p>Note: Also calculated in this notebook, and stored for future use, are the <strong>no treatment mRS distributions</strong> that are used as the control populations: 1) nLVO without treatment; 2) LVO without treatment.</p>
<ul class="simple">
<li><p>For <em>nLVO patients</em> the <em>no treatment mRS distribution</em> is taken from the untreated control group of combined nLVO/LVO data from Lees et al. 2010, and from that we remove the contribution of the LVO patients by using the results from the untreated control group of LVO-only data from Goyal et al. 2016. Weightings for these two untreated control groups (146% Lees and -46% Goyal) are chosen such that the resulting mRS distribution represents just the nLVO patients and matches the P(mRS &lt;= 1, <em>t = No Effect”</em>) of 0.46 (from the control group in Emberson with NIHSS of 0-10).</p></li>
<li><p>For <em>LVO patients</em> the <em>no treatment mRS distribution</em> is taken from the untreated control population from Goyal et al. 2016.</p></li>
</ul>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="the-code">
<h1>The code<a class="headerlink" href="#the-code" title="Permalink to this headline">#</a></h1>
<p>Now we will show the code to calculate the mRS distributions that we have explained above.</p>
<section id="import-packages">
<h2>Import packages<a class="headerlink" href="#import-packages" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Set NumPy and Pandas to print 4 decimal places</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.precision&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn-colorblind&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="set-up-dictionaries-for-results">
<h2>Set up dictionaries for results<a class="headerlink" href="#set-up-dictionaries-for-results" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_distributions_bins</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">all_distributions_cumsum</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="pre-stroke-mrs-distribution-fully-recovered">
<h2>Pre-stroke mRS distribution (fully recovered)<a class="headerlink" href="#pre-stroke-mrs-distribution-fully-recovered" title="Permalink to this headline">#</a></h2>
<p>Use the pre-stroke mRS distributions from SSNAP data to estimate the best possible outcome from treatment.</p>
<section id="pre-stroke-mrs-distribution-for-nlvo-patients">
<h3>Pre-stroke mRS distribution for nLVO patients<a class="headerlink" href="#pre-stroke-mrs-distribution-for-nlvo-patients" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pre-stroke nLVO uses pre-stroke mRS from SSNAP for patients with ischaemic</span>
<span class="c1"># stroke and NIHSS 0-10.</span>

<span class="c1"># Define distribution from SSNAP data</span>
<span class="n">pre_stroke_nlvo_bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="mf">0.582881</span><span class="p">,</span> <span class="mf">0.162538</span><span class="p">,</span> <span class="mf">0.103440</span><span class="p">,</span> <span class="mf">0.102223</span><span class="p">,</span> <span class="mf">0.041973</span><span class="p">,</span> <span class="mf">0.006945</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>

<span class="c1"># Normalise</span>
<span class="n">pre_stroke_nlvo_bins</span> <span class="o">=</span> <span class="n">pre_stroke_nlvo_bins</span> <span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">pre_stroke_nlvo_bins</span><span class="p">)</span>
<span class="n">all_distributions_bins</span><span class="p">[</span><span class="s1">&#39;pre_stroke_nlvo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pre_stroke_nlvo_bins</span>

<span class="c1"># Make cumulative distribution</span>
<span class="n">pre_stroke_nlvo_cumsum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">pre_stroke_nlvo_bins</span><span class="p">)</span>
<span class="n">all_distributions_cumsum</span><span class="p">[</span><span class="s1">&#39;pre_stroke_nlvo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pre_stroke_nlvo_cumsum</span>

<span class="c1"># Show</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pre-stroke nLVO&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS bins:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">pre_stroke_nlvo_bins</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS cumulative:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">pre_stroke_nlvo_cumsum</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pre-stroke nLVO
---------------
mRS bins:
array([0.5829, 0.1625, 0.1034, 0.1022, 0.042 , 0.0069, 0.    ])

mRS cumulative:
array([0.5829, 0.7454, 0.8489, 0.9511, 0.9931, 1.    , 1.    ])
</pre></div>
</div>
</div>
</div>
<section id="add-ivt-extra-deaths-to-pre-stroke-nlvo-patients">
<h4>Add IVT extra deaths (to pre-stroke nLVO patients)<a class="headerlink" href="#add-ivt-extra-deaths-to-pre-stroke-nlvo-patients" title="Permalink to this headline">#</a></h4>
<p>The distribution is corrected for 1.1% excess deaths in the IVT-treated group (from Emberson et al., 2014, using NIHSS 0-10 as a surrogate for nLVO).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Take a copy of the mRS distribution for nLVO pre-stroke</span>
<span class="n">pre_stroke_nlvo_bins_ivt_deaths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">pre_stroke_nlvo_bins</span><span class="p">)</span>

<span class="c1"># Adjust deaths to include the 1.10% excess that are due to haemorrhage from use </span>
<span class="c1"># of IVT in nLVO patents (Emberson et al., 2014)</span>
<span class="n">excess_deaths</span> <span class="o">=</span> <span class="mf">0.011</span>
<span class="n">pre_stroke_nlvo_bins_ivt_deaths</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">+=</span> <span class="n">excess_deaths</span>
<span class="n">correction_mrs_0_to_5</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">pre_stroke_nlvo_bins_ivt_deaths</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">])</span> <span class="o">-</span> <span class="n">excess_deaths</span><span class="p">)</span> <span class="o">/</span> 
    <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">pre_stroke_nlvo_bins_ivt_deaths</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">])))</span>
<span class="n">pre_stroke_nlvo_bins_ivt_deaths</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">*=</span> <span class="n">correction_mrs_0_to_5</span>
<span class="n">pre_stroke_nlvo_cumsum_ivt_deaths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">pre_stroke_nlvo_bins_ivt_deaths</span><span class="p">)</span>

<span class="c1"># Store</span>
<span class="n">all_distributions_bins</span><span class="p">[</span><span class="s1">&#39;pre_stroke_nlvo_ivt_deaths&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">pre_stroke_nlvo_bins_ivt_deaths</span>
<span class="n">all_distributions_cumsum</span><span class="p">[</span><span class="s1">&#39;pre_stroke_nlvo_ivt_deaths&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">pre_stroke_nlvo_cumsum_ivt_deaths</span>

<span class="c1"># Show</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pre-stroke nLVO with IVT deaths&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-------------------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS bins:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">pre_stroke_nlvo_bins_ivt_deaths</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS cumulative:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">pre_stroke_nlvo_cumsum_ivt_deaths</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pre-stroke nLVO with IVT deaths
-------------------------------
mRS bins:
array([0.5765, 0.1608, 0.1023, 0.1011, 0.0415, 0.0069, 0.011 ])

mRS cumulative:
array([0.5765, 0.7372, 0.8395, 0.9406, 0.9821, 0.989 , 1.    ])
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="lvo-pre-stroke-mrs-distribution">
<h3>LVO pre-stroke mRS distribution<a class="headerlink" href="#lvo-pre-stroke-mrs-distribution" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pre-stroke nLVO uses pre-stroke mRS from SSNAP for patients with ischaemic</span>
<span class="c1"># stroke and NIHSS 0-10.</span>

<span class="c1"># Define distribution from SSNAP data</span>
<span class="n">pre_stroke_lvo_bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="mf">0.417894</span><span class="p">,</span> <span class="mf">0.142959</span><span class="p">,</span> <span class="mf">0.118430</span><span class="p">,</span> <span class="mf">0.164211</span><span class="p">,</span> <span class="mf">0.113775</span><span class="p">,</span> <span class="mf">0.042731</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>

<span class="c1"># Normalise</span>
<span class="n">pre_stroke_lvo_bins</span> <span class="o">=</span> <span class="n">pre_stroke_lvo_bins</span> <span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">pre_stroke_lvo_bins</span><span class="p">)</span>
<span class="n">all_distributions_bins</span><span class="p">[</span><span class="s1">&#39;pre_stroke_lvo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pre_stroke_lvo_bins</span>

<span class="c1"># Make cumulative distribution</span>
<span class="n">pre_stroke_lvo_cumsum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">pre_stroke_lvo_bins</span><span class="p">)</span>
<span class="n">all_distributions_cumsum</span><span class="p">[</span><span class="s1">&#39;pre_stroke_lvo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pre_stroke_lvo_cumsum</span>

<span class="c1"># Show</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pre-stroke LVO&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS bins:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">pre_stroke_lvo_bins</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS cumulative:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">pre_stroke_lvo_cumsum</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pre-stroke LVO
--------------
mRS bins:
array([0.4179, 0.143 , 0.1184, 0.1642, 0.1138, 0.0427, 0.    ])

mRS cumulative:
array([0.4179, 0.5609, 0.6793, 0.8435, 0.9573, 1.    , 1.    ])
</pre></div>
</div>
</div>
</div>
<section id="add-ivt-extra-deaths-to-pre-stroke-lvo-patients">
<h4>Add IVT extra deaths (to pre-stroke LVO patients)<a class="headerlink" href="#add-ivt-extra-deaths-to-pre-stroke-lvo-patients" title="Permalink to this headline">#</a></h4>
<p>The distribution is corrected for 3.41% excess deaths in the IVT-treated group (from Emberson et al., 2014, using NIHSS 11+ as a surrogate for LVO).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Take a copy of the mRS distribution for LVO pre-stroke</span>
<span class="n">pre_stroke_lvo_bins_ivt_deaths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">pre_stroke_lvo_bins</span><span class="p">)</span>

<span class="c1"># Adjust deaths to include the 3.41% excess that are due to haemorrhage from use </span>
<span class="c1"># of IVT in LVO patents (Emberson et al., 2014)</span>
<span class="n">excess_deaths</span> <span class="o">=</span> <span class="mf">0.0341</span>
<span class="n">pre_stroke_lvo_bins_ivt_deaths</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">+=</span> <span class="n">excess_deaths</span>
<span class="n">correction_mrs_0_to_5</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">pre_stroke_lvo_bins_ivt_deaths</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">])</span> <span class="o">-</span> <span class="n">excess_deaths</span><span class="p">)</span> <span class="o">/</span> 
    <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">pre_stroke_lvo_bins_ivt_deaths</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">])))</span>
<span class="n">pre_stroke_lvo_bins_ivt_deaths</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">*=</span> <span class="n">correction_mrs_0_to_5</span>
<span class="n">pre_stroke_lvo_cumsum_ivt_deaths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">pre_stroke_lvo_bins_ivt_deaths</span><span class="p">)</span>

<span class="c1"># Store</span>
<span class="n">all_distributions_bins</span><span class="p">[</span><span class="s1">&#39;pre_stroke_lvo_ivt_deaths&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">pre_stroke_lvo_bins_ivt_deaths</span>
<span class="n">all_distributions_cumsum</span><span class="p">[</span><span class="s1">&#39;pre_stroke_lvo_ivt_deaths&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">pre_stroke_lvo_cumsum_ivt_deaths</span>

<span class="c1"># Show</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pre-stroke lvo with IVT deaths&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;------------------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS bins:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">pre_stroke_lvo_bins_ivt_deaths</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS cumulative:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">pre_stroke_lvo_cumsum_ivt_deaths</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pre-stroke lvo with IVT deaths
------------------------------
mRS bins:
array([0.4036, 0.1381, 0.1144, 0.1586, 0.1099, 0.0413, 0.0341])

mRS cumulative:
array([0.4036, 0.5417, 0.6561, 0.8147, 0.9246, 0.9659, 1.    ])
</pre></div>
</div>
</div>
</div>
</section>
<section id="add-mt-extra-deaths-to-pre-stroke-lvo-patients">
<h4>Add MT extra deaths (to pre-stroke LVO patients)<a class="headerlink" href="#add-mt-extra-deaths-to-pre-stroke-lvo-patients" title="Permalink to this headline">#</a></h4>
<p>The distribution is corrected for -3.6% excess deaths (a 3.6% percentage point reduction in deaths) in the MT-treated group (Goyal et al., 2016). These already include excess deaths from any use of IVT first.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Take a copy of the mRS distribution for LVO pre-stroke</span>
<span class="n">pre_stroke_lvo_bins_mt_deaths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">pre_stroke_lvo_bins</span><span class="p">)</span>

<span class="c1"># Adjust deaths to include give 15.3% @ 285 min treatment (Goyal et al., 2016)</span>
<span class="n">excess_deaths</span> <span class="o">=</span> <span class="mf">0.036</span>
<span class="n">pre_stroke_lvo_bins_mt_deaths</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">+=</span> <span class="n">excess_deaths</span>
<span class="n">correction_mrs_0_to_5</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">pre_stroke_lvo_bins_mt_deaths</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">])</span> <span class="o">-</span> <span class="n">excess_deaths</span><span class="p">)</span> <span class="o">/</span> 
    <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">pre_stroke_lvo_bins_mt_deaths</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">])))</span>
<span class="n">pre_stroke_lvo_bins_mt_deaths</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">*=</span> <span class="n">correction_mrs_0_to_5</span>
<span class="n">pre_stroke_lvo_cumsum_mt_deaths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">pre_stroke_lvo_bins_mt_deaths</span><span class="p">)</span>

<span class="c1"># Store</span>
<span class="n">all_distributions_bins</span><span class="p">[</span><span class="s1">&#39;pre_stroke_lvo_mt_deaths&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">pre_stroke_lvo_bins_mt_deaths</span>
<span class="n">all_distributions_cumsum</span><span class="p">[</span><span class="s1">&#39;pre_stroke_lvo_mt_deaths&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">pre_stroke_lvo_cumsum_mt_deaths</span>

<span class="c1"># Show</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pre-stroke lvo with mt deaths&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-----------------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS bins:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">pre_stroke_lvo_bins_mt_deaths</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS cumulative:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">pre_stroke_lvo_cumsum_mt_deaths</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pre-stroke lvo with mt deaths
-----------------------------
mRS bins:
array([0.4028, 0.1378, 0.1142, 0.1583, 0.1097, 0.0412, 0.036 ])

mRS cumulative:
array([0.4028, 0.5407, 0.6548, 0.8131, 0.9228, 0.964 , 1.    ])
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<hr class="docutils" />
<section id="treatment-has-no-effect-mrs-distribution-nlvo-patients-with-ivt">
<h2>Treatment has no effect mRS distribution: nLVO patients with IVT<a class="headerlink" href="#treatment-has-no-effect-mrs-distribution-nlvo-patients-with-ivt" title="Permalink to this headline">#</a></h2>
<p>This mRS distribution is taken from the untreated control group of combined nLVO/LVO data from Lees et al. 2010, and from that we remove the contribution of the LVO patients by using the results from the untreated control group of LVO-only data from Goyal et al. 2016. Weightings for these two untreated control groups (149% Lees and -49% Goyal) are chosen such that the resulting mRS distribution to represent just the nLVO patients matches the P(mRS &lt;= 1, <em>t = No Effect”</em>) of 0.46 (from the control group in Emberson with NIHSS of 0-10).</p>
<p>Before the two individual mRS distributions are combined, they are each corrected for the excess deaths due to IVT treatment. For nLVO patients this is 1.10%, and for LVO patients this is 3.41% (see appendix).</p>
<p>Set up required distributions from data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define distribution from Lees et al. 2010</span>
<span class="n">no_treatment_nlvo_lvo_bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span><span class="mf">0.1486</span><span class="p">,</span> <span class="mf">0.2022</span><span class="p">,</span> <span class="mf">0.1253</span><span class="p">,</span> <span class="mf">0.1397</span><span class="p">,</span> <span class="mf">0.1806</span><span class="p">,</span> <span class="mf">0.0861</span><span class="p">,</span> <span class="mf">0.1175</span><span class="p">])</span>

<span class="c1"># Define distribution from Goyal et al. 2016</span>
<span class="n">no_treatment_lvo_bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span><span class="mf">0.050</span><span class="p">,</span> <span class="mf">0.079</span><span class="p">,</span> <span class="mf">0.136</span><span class="p">,</span> <span class="mf">0.164</span><span class="p">,</span> <span class="mf">0.247</span><span class="p">,</span> <span class="mf">0.135</span><span class="p">,</span> <span class="mf">0.189</span><span class="p">])</span>

<span class="c1"># Normalise</span>
<span class="n">no_treatment_nlvo_lvo_bins</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">no_treatment_nlvo_lvo_bins</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">no_treatment_nlvo_lvo_bins</span><span class="p">))</span>

<span class="n">no_treatment_lvo_bins</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">no_treatment_lvo_bins</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">no_treatment_lvo_bins</span><span class="p">))</span>

<span class="c1"># Make cumulative distribution</span>
<span class="n">no_treatment_nlvo_lvo_cumsum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">no_treatment_nlvo_lvo_bins</span><span class="p">)</span>
<span class="n">no_treatment_lvo_cumsum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">no_treatment_lvo_bins</span><span class="p">)</span>

<span class="c1"># Show</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;nLVO-LVO combined no treatment effect&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-------------------------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS bins:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">no_treatment_nlvo_lvo_bins</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS cumulative:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">no_treatment_nlvo_lvo_cumsum</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;LVO combined no treatment effect&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-------------------------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS bins:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">no_treatment_lvo_bins</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS cumulative:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">no_treatment_lvo_cumsum</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>nLVO-LVO combined no treatment effect
-------------------------------------
mRS bins:
array([0.1486, 0.2022, 0.1253, 0.1397, 0.1806, 0.0861, 0.1175])

mRS cumulative:
array([0.1486, 0.3508, 0.4761, 0.6158, 0.7964, 0.8825, 1.    ])

LVO combined no treatment effect
-------------------------------------
mRS bins:
array([0.05 , 0.079, 0.136, 0.164, 0.247, 0.135, 0.189])

mRS cumulative:
array([0.05 , 0.129, 0.265, 0.429, 0.676, 0.811, 1.   ])
</pre></div>
</div>
</div>
</div>
<section id="add-ivt-extra-deaths-for-lees-untreated-control-group-combined-nlvo-lvo">
<h3>Add IVT extra deaths (for Lees untreated control group, combined nLVO/LVO)<a class="headerlink" href="#add-ivt-extra-deaths-for-lees-untreated-control-group-combined-nlvo-lvo" title="Permalink to this headline">#</a></h3>
<p>The distribution is corrected for excess deaths in the IVT-treated group (from Emberson et al., 2014). We use 1.10% for nLVO (using NIHSS 11+ as a surrogate for LVO), and 3.41% for LVO (using NIHSS 11 as a surrogate for LVO).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Take a copy of the mRS distribution for Lees untreated control group (n/LVO)</span>
<span class="n">no_treatment_nlvo_lvo_bins_ivt_deaths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">no_treatment_nlvo_lvo_bins</span><span class="p">)</span>

<span class="c1"># Adjust deaths to include the 2.29% excess due to haemorrhage from use of IVT</span>
<span class="n">excess_deaths</span> <span class="o">=</span> <span class="mf">0.0229</span>
<span class="n">no_treatment_nlvo_lvo_bins_ivt_deaths</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">+=</span> <span class="n">excess_deaths</span>
<span class="n">correction_mrs_0_to_5</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">no_treatment_nlvo_lvo_bins_ivt_deaths</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">])</span> <span class="o">-</span> <span class="n">excess_deaths</span><span class="p">)</span> <span class="o">/</span> 
    <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">no_treatment_nlvo_lvo_bins_ivt_deaths</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">])))</span>
<span class="n">no_treatment_nlvo_lvo_bins_ivt_deaths</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">*=</span> <span class="n">correction_mrs_0_to_5</span>
<span class="n">no_treatment_nlvo_lvo_cumsum_ivt_deaths</span> <span class="o">=</span> <span class="p">(</span>
                            <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">no_treatment_nlvo_lvo_bins_ivt_deaths</span><span class="p">))</span>

<span class="c1"># Show</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No treatment combined nlvo/lvo with IVT deaths&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----------------------------------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS bins:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">no_treatment_nlvo_lvo_bins_ivt_deaths</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS cumulative:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">no_treatment_nlvo_lvo_cumsum_ivt_deaths</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No treatment combined nlvo/lvo with IVT deaths
----------------------------------------------
mRS bins:
array([0.1447, 0.197 , 0.122 , 0.1361, 0.1759, 0.0839, 0.1404])

mRS cumulative:
array([0.1447, 0.3417, 0.4637, 0.5998, 0.7757, 0.8596, 1.    ])
</pre></div>
</div>
</div>
</div>
</section>
<section id="add-ivt-extra-deaths-for-goyal-s-untreated-control-group-lvo">
<h3>Add IVT extra deaths (for Goyal’s untreated control group, LVO)<a class="headerlink" href="#add-ivt-extra-deaths-for-goyal-s-untreated-control-group-lvo" title="Permalink to this headline">#</a></h3>
<p>The distribution is corrected for 3.41% excess deaths in the IVT-treated group (from Emberson et al., 2014, using NIHSS 11+ as a surrogate for LVO).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Take a copy of the mRS distribution for Goyals untreated control group (LVO)</span>
<span class="n">no_treatment_lvo_bins_ivt_deaths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">no_treatment_lvo_bins</span><span class="p">)</span>

<span class="c1"># Adjust deaths to include the 3.41% excess due to haemorrhage from use of IVT</span>
<span class="n">excess_deaths</span> <span class="o">=</span> <span class="mf">0.0341</span>
<span class="n">no_treatment_lvo_bins_ivt_deaths</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">+=</span> <span class="n">excess_deaths</span>
<span class="n">correction_mrs_0_to_5</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">no_treatment_lvo_bins_ivt_deaths</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">])</span> <span class="o">-</span> <span class="n">excess_deaths</span><span class="p">)</span> <span class="o">/</span> 
    <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">no_treatment_lvo_bins_ivt_deaths</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">])))</span>
<span class="n">no_treatment_lvo_bins_ivt_deaths</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">*=</span> <span class="n">correction_mrs_0_to_5</span>
<span class="n">no_treatment_lvo_cumsum_ivt_deaths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">no_treatment_lvo_bins_ivt_deaths</span><span class="p">)</span>

<span class="c1"># Show</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No treatment combined lvo with IVT deaths&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-----------------------------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS bins:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">no_treatment_lvo_bins_ivt_deaths</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS cumulative:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">no_treatment_lvo_cumsum_ivt_deaths</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No treatment combined lvo with IVT deaths
-----------------------------------------
mRS bins:
array([0.0479, 0.0757, 0.1303, 0.1571, 0.2366, 0.1293, 0.2231])

mRS cumulative:
array([0.0479, 0.1236, 0.2539, 0.411 , 0.6476, 0.7769, 1.    ])
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="calculate-a-weighted-distribution-of-lvo-and-nlvo">
<h3>Calculate a weighted distribution of LVO and nLVO<a class="headerlink" href="#calculate-a-weighted-distribution-of-lvo-and-nlvo" title="Permalink to this headline">#</a></h3>
<p>We want an untreated control group containing nLVO patients to use as our mRS distribution to represent when IVT treatment has no effect on nLVO patients. Using the two untreated control groups (nLVO/LVO from Lees, and LVO from Goyal) calculate the weights needed to remove the effect of the LVO patients from Lees, that also gives a mRS distribution with P(mRS &lt;= 1, <em>t = No Effect</em>) = 46% (Emberson et al. 2014).</p>
<section id="calculate-weights-without-excess-ivt-deaths">
<h4>Calculate weights without excess IVT deaths<a class="headerlink" href="#calculate-weights-without-excess-ivt-deaths" title="Permalink to this headline">#</a></h4>
<p>This is used to get the mRS distribution for nLVO patients who had no treatment (the control nLVO population). This mRS distribution is not used in this notebook, but is stored to be used in later notebooks.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the difference between the target of P(mRS&lt;=1,t=No Effect)=0.46 for  </span>
<span class="c1">#   nLVO and the no treatment combined nLVO/LVO P(mRS&lt;=1)</span>
<span class="n">target_diff</span> <span class="o">=</span> <span class="mf">0.46</span> <span class="o">-</span> <span class="n">no_treatment_nlvo_lvo_cumsum</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Calculate the known current difference between the no treatment LVO P(mRS&lt;=1) </span>
<span class="c1">#   and the combined nLVO/LVO P(mRS&lt;=1) </span>
<span class="n">current_diff</span> <span class="o">=</span> <span class="p">(</span><span class="n">no_treatment_lvo_cumsum</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">no_treatment_nlvo_lvo_cumsum</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># The weight attributable to LVO is the target difference / the current </span>
<span class="c1">#   difference</span>
<span class="n">weight_lvo</span> <span class="o">=</span> <span class="n">target_diff</span> <span class="o">/</span> <span class="n">current_diff</span>

<span class="c1"># The weight attributable to nLVO is (1 - the weight attributable to LVO)</span>
<span class="n">weight_nlvo_lvo</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">weight_lvo</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Weights (Lee, Goyal): </span><span class="si">{</span><span class="n">weight_nlvo_lvo</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">,&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">weight_lvo</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Weights (Lee, Goyal): 1.4923, -0.4923
</pre></div>
</div>
</div>
</div>
<p>Apply the weights</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Apply weights</span>
<span class="n">no_treatment_nlvo_bins</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">weight_nlvo_lvo</span> <span class="o">*</span> <span class="n">no_treatment_nlvo_lvo_bins</span><span class="p">)</span> <span class="o">+</span> 
    <span class="p">(</span><span class="n">weight_lvo</span> <span class="o">*</span> <span class="n">no_treatment_lvo_bins</span><span class="p">))</span>

<span class="c1"># Normalise</span>
<span class="n">no_treatment_nlvo_bins</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">no_treatment_nlvo_bins</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">no_treatment_nlvo_bins</span><span class="p">))</span>

<span class="c1"># Make cumulative distribution (before correction for deaths)</span>
<span class="n">no_treatment_nlvo_cumsum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">no_treatment_nlvo_bins</span><span class="p">)</span>

<span class="c1"># Copy, to add trteament deaths</span>
<span class="n">no_effect_nlvo_ivt_bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">no_treatment_nlvo_bins</span><span class="p">)</span>

<span class="c1"># Store</span>
<span class="n">all_distributions_bins</span><span class="p">[</span><span class="s1">&#39;no_treatment_nlvo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">no_effect_nlvo_ivt_bins</span>

<span class="c1"># Make cumulative distribution</span>
<span class="n">no_effect_nlvo_cumsum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">no_effect_nlvo_ivt_bins</span><span class="p">)</span>
<span class="n">all_distributions_cumsum</span><span class="p">[</span><span class="s1">&#39;no_treatment_nlvo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">no_effect_nlvo_cumsum</span>

<span class="c1"># Show</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;nLVO no treatment effect&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;------------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS bins:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">no_effect_nlvo_ivt_bins</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS cumulative:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">no_effect_nlvo_cumsum</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>nLVO no treatment effect
------------------------
mRS bins:
array([0.1971, 0.2629, 0.12  , 0.1277, 0.1479, 0.062 , 0.0823])

mRS cumulative:
array([0.1971, 0.46  , 0.58  , 0.7078, 0.8557, 0.9177, 1.    ])
</pre></div>
</div>
</div>
</div>
</section>
<section id="calculate-weights-with-excess-ivt-deaths">
<h4>Calculate weights with excess IVT deaths<a class="headerlink" href="#calculate-weights-with-excess-ivt-deaths" title="Permalink to this headline">#</a></h4>
<p>This is used to get the mRS distribution for nLVO patients who had IVT treatment at <em>t = No Effect</em> (this is for the patient-treatment cohort nLVO-IVT).</p>
<p>Note: We use the mRS distributions for no treatment with excess IVT deaths to represent the outcome of having treatment at <em>t = No Effect</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the difference between the target of P(mRS&lt;=1,t=No Effect)=0.46 for </span>
<span class="c1">#   nLVO and the no treatment combined nLVO/LVO P(mRS&lt;=1) with excess IVT deaths</span>
<span class="n">target_diff</span> <span class="o">=</span> <span class="mf">0.46</span> <span class="o">-</span> <span class="n">no_treatment_nlvo_lvo_cumsum_ivt_deaths</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Calculate the known current difference between the no treatment LVO </span>
<span class="c1">#   P(mRS&lt;=1,t=No Effect) and the combined nLVO/LVO P(mRS&lt;=1), both with </span>
<span class="c1">#   excess IVT deaths </span>
<span class="n">current_diff</span> <span class="o">=</span> <span class="p">(</span><span class="n">no_treatment_lvo_cumsum_ivt_deaths</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> 
                <span class="n">no_treatment_nlvo_lvo_cumsum_ivt_deaths</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># The weight attributable to LVO is the target difference / the current </span>
<span class="c1">#   difference</span>
<span class="n">weight_lvo</span> <span class="o">=</span> <span class="n">target_diff</span> <span class="o">/</span> <span class="n">current_diff</span>


<span class="n">weight_nlvo_lvo</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">weight_lvo</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Weights (Lee, Goyal): </span><span class="si">{</span><span class="n">weight_nlvo_lvo</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">,&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">weight_lvo</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Weights (Lee, Goyal): 1.5424, -0.5424
</pre></div>
</div>
</div>
</div>
<p>Apply the weights</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Apply weights</span>
<span class="n">no_treatment_nlvo_bins_ivt_deaths</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">weight_nlvo_lvo</span> <span class="o">*</span> <span class="n">no_treatment_nlvo_lvo_bins_ivt_deaths</span><span class="p">)</span> <span class="o">+</span> 
    <span class="p">(</span><span class="n">weight_lvo</span> <span class="o">*</span> <span class="n">no_treatment_lvo_bins_ivt_deaths</span><span class="p">))</span>

<span class="c1"># Normalise</span>
<span class="n">no_treatment_nlvo_bins_ivt_deaths</span> <span class="o">=</span> <span class="p">(</span><span class="n">no_treatment_nlvo_bins_ivt_deaths</span> <span class="o">/</span> 
                                     <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">no_treatment_nlvo_bins_ivt_deaths</span><span class="p">))</span>

<span class="c1"># Make cumulative distribution (before correction for deaths)</span>
<span class="n">no_treatment_nlvo_cumsum_ivt_deaths</span> <span class="o">=</span> \
    <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">no_treatment_nlvo_bins_ivt_deaths</span><span class="p">)</span>

<span class="c1"># Copy, to add treatment deaths</span>
<span class="n">no_effect_nlvo_ivt_bins_ivt_deaths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">no_treatment_nlvo_bins_ivt_deaths</span><span class="p">)</span>

<span class="c1"># Store</span>
<span class="n">all_distributions_bins</span><span class="p">[</span><span class="s1">&#39;no_effect_nlvo_ivt_deaths&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">no_effect_nlvo_ivt_bins_ivt_deaths</span>

<span class="c1"># Make cumulative distribution</span>
<span class="n">no_effect_nlvo_cumsum_ivt_deaths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">no_treatment_nlvo_bins_ivt_deaths</span><span class="p">)</span>
<span class="n">all_distributions_cumsum</span><span class="p">[</span><span class="s1">&#39;no_effect_nlvo_ivt_deaths&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">no_effect_nlvo_cumsum_ivt_deaths</span>

<span class="c1"># Show</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;nLVO no treatment effect_ivt_deaths&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-----------------------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS bins:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">no_effect_nlvo_ivt_bins_ivt_deaths</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS cumulative:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">no_effect_nlvo_cumsum_ivt_deaths</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>nLVO no treatment effect_ivt_deaths
-----------------------------------
mRS bins:
array([0.1973, 0.2627, 0.1176, 0.1247, 0.143 , 0.0592, 0.0955])

mRS cumulative:
array([0.1973, 0.46  , 0.5776, 0.7023, 0.8452, 0.9045, 1.    ])
</pre></div>
</div>
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="mrs-distribution-at-t-0-for-nlvo-patients-with-ivt">
<h3>mRS distribution at <em>t = 0</em> for nLVO patients with IVT<a class="headerlink" href="#mrs-distribution-at-t-0-for-nlvo-patients-with-ivt" title="Permalink to this headline">#</a></h3>
<p>We now have the two mRS distributions (fully recovered, and no effect) to calculate the mRS distribution for nLVO patients recieving IVT at <em>t = 0</em>.</p>
<p>The weights used to combine these two mRS distribution (61% fully recovered &amp; 39% no effect) were informed by data from Emberson et al. 2014, and found in order to match the P(mRS &lt;= 1, <em>t = 0</em>) of 0.63. 63% is estimated from Emberson et al. 2014, where 46% of untreated patients with NIHSS 0-10 had mRS 0-1, and the odds ratio of mRS 0-1 extrapolates back to 2.0 at <em>t = 0</em>.</p>
<p>Note 1: We use the mRS distributions for no treatment adjusted with excess IVT deaths to represent the outcome of having treatment at <em>t = No Effect</em>.<br />
Note 2: We use the mRS distributions for pre-stroke adjusted with excess IVT deaths to represent the outcome of having a full recovery with treatment at <em>t = 0</em>.</p>
<p>Calculate weights.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the difference between the target of P(mRS&lt;=1,t=0)=0.63 for nLVO</span>
<span class="c1">#   and the no treatment combined nLVO/LVO P(mRS&lt;=1) with excess IVT deaths</span>
<span class="n">target_diff</span>  <span class="o">=</span> <span class="mf">0.63</span> <span class="o">-</span> <span class="n">no_treatment_nlvo_cumsum_ivt_deaths</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Calculate the known current difference between pre-stroke nLVO P(mRS&lt;=1) and  </span>
<span class="c1">#   the no treatment nLVO P(mRS&lt;=1), both with excess IVT deaths </span>
<span class="n">current_diff</span> <span class="o">=</span> <span class="p">(</span><span class="n">pre_stroke_nlvo_cumsum_ivt_deaths</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> 
                <span class="n">no_treatment_nlvo_cumsum_ivt_deaths</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># The weight attributable to pre-stroke is the target difference / the current </span>
<span class="c1">#   difference</span>
<span class="n">weight_pre_stroke_nlvo</span> <span class="o">=</span> <span class="n">target_diff</span> <span class="o">/</span> <span class="n">current_diff</span>

<span class="c1"># The weight attributable to no treatment is (1 - the weight attributable to </span>
<span class="c1">#   pre-stroke)</span>
<span class="n">weight_no_treatment_nlvo</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">weight_pre_stroke_nlvo</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Weights (pre-stroke, no treatment): </span><span class="si">{</span><span class="n">weight_pre_stroke_nlvo</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">,&#39;</span><span class="p">,</span>
      <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">weight_no_treatment_nlvo</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Weights (pre-stroke, no treatment): 0.6132, 0.3868
</pre></div>
</div>
</div>
</div>
<p>Apply the weights.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Apply weights</span>
<span class="n">t0_treatment_nlvo_ivt_bins</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">weight_pre_stroke_nlvo</span> <span class="o">*</span> <span class="n">pre_stroke_nlvo_bins_ivt_deaths</span><span class="p">)</span> <span class="o">+</span>
    <span class="p">(</span><span class="n">weight_no_treatment_nlvo</span> <span class="o">*</span> <span class="n">no_treatment_nlvo_bins_ivt_deaths</span><span class="p">))</span>

<span class="c1"># Normalise</span>
<span class="n">t0_treatment_nlvo_ivt_bins</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">t0_treatment_nlvo_ivt_bins</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">t0_treatment_nlvo_ivt_bins</span><span class="p">))</span>

<span class="c1"># Store</span>
<span class="n">all_distributions_bins</span><span class="p">[</span><span class="s1">&#39;t0_treatment_nlvo_ivt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t0_treatment_nlvo_ivt_bins</span>

<span class="c1"># Make cumulative distribution</span>
<span class="n">t0_treatment_nlvo_ivt_cumsum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">t0_treatment_nlvo_ivt_bins</span><span class="p">)</span>
<span class="n">all_distributions_cumsum</span><span class="p">[</span><span class="s1">&#39;t0_treatment_nlvo_ivt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t0_treatment_nlvo_ivt_cumsum</span>

<span class="c1"># Show</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;nLVO IVT t0 treatment effect&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----------------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS bins:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">t0_treatment_nlvo_ivt_bins</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS cumulative:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">t0_treatment_nlvo_ivt_cumsum</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>nLVO IVT t0 treatment effect
----------------------------
mRS bins:
array([0.4298, 0.2002, 0.1082, 0.1102, 0.0808, 0.0271, 0.0437])

mRS cumulative:
array([0.4298, 0.63  , 0.7382, 0.8484, 0.9292, 0.9563, 1.    ])
</pre></div>
</div>
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="treatment-has-no-effect-mrs-distribution-lvo-patients-with-ivt-or-mt">
<h2>Treatment has no effect mRS distribution: LVO patients with IVT or MT<a class="headerlink" href="#treatment-has-no-effect-mrs-distribution-lvo-patients-with-ivt-or-mt" title="Permalink to this headline">#</a></h2>
<p>For <em>LVO patients</em> the <em>no effect mRS distribution</em> is taken from the untreated control population from Goyal et al. 2016.</p>
<p>This mRS distribution is then corrected for the excess deaths due to treatment.  We use 3.41% for LVO patients with IVT (Emberson et al., 2014), and 3.6% for MT (Goyal et al., 2016). No correction for IVT-related deaths is needed when LVO is treated with MT as the Goyal control group includes use of IVT.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Store (mRS distribution for LVO no treatment, Goyal. Calculated in cell 8)</span>
<span class="n">all_distributions_bins</span><span class="p">[</span><span class="s1">&#39;no_treatment_lvo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">no_treatment_lvo_bins</span>
<span class="n">all_distributions_cumsum</span><span class="p">[</span><span class="s1">&#39;no_treatment_lvo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">no_treatment_lvo_cumsum</span>

<span class="c1"># Show</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;LVO no treatment effect&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;------------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS bins:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">no_treatment_lvo_bins</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS cumulative:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">no_treatment_lvo_cumsum</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LVO no treatment effect
------------------------
mRS bins:
array([0.05 , 0.079, 0.136, 0.164, 0.247, 0.135, 0.189])

mRS cumulative:
array([0.05 , 0.129, 0.265, 0.429, 0.676, 0.811, 1.   ])
</pre></div>
</div>
</div>
</div>
<section id="add-ivt-extra-deaths-for-goyals-untreated-control-group-lvo">
<h3>Add IVT extra deaths (for Goyals untreated control group, LVO)<a class="headerlink" href="#add-ivt-extra-deaths-for-goyals-untreated-control-group-lvo" title="Permalink to this headline">#</a></h3>
<p>The distribution is corrected for 3.41% excess deaths in the IVT-treated group (from Emberson et al., 2014, using NIHSS 11+ as a surrogate for LVO).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Store (mRS distribution for LVO no treatment with IVT excess deaths, Goyal)</span>
<span class="n">all_distributions_bins</span><span class="p">[</span><span class="s1">&#39;no_effect_lvo_ivt_deaths&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">no_treatment_lvo_bins_ivt_deaths</span>
<span class="n">all_distributions_cumsum</span><span class="p">[</span><span class="s1">&#39;no_effect_lvo_ivt_deaths&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">no_treatment_lvo_cumsum_ivt_deaths</span>

<span class="c1"># Show</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;LVO no treatment effect IVT deaths&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----------------------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS bins:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">no_treatment_lvo_bins_ivt_deaths</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS cumulative:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">no_treatment_lvo_cumsum_ivt_deaths</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LVO no treatment effect IVT deaths
----------------------------------
mRS bins:
array([0.0479, 0.0757, 0.1303, 0.1571, 0.2366, 0.1293, 0.2231])

mRS cumulative:
array([0.0479, 0.1236, 0.2539, 0.411 , 0.6476, 0.7769, 1.    ])
</pre></div>
</div>
</div>
</div>
</section>
<section id="add-mt-extra-deaths-for-goyals-untreated-control-group-lvo">
<h3>Add MT extra deaths (for Goyals untreated control group, LVO)<a class="headerlink" href="#add-mt-extra-deaths-for-goyals-untreated-control-group-lvo" title="Permalink to this headline">#</a></h3>
<p>The distribution is corrected for 3.6% excess deaths ((a 3.6% percentage point reduction in deaths) in the MT-treated group. This is the adjustment needed to give 15.3% deaths when treated at 285 minutes (Goyal et al., 2016). These already include excess deaths from any use of IVT first.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Take copy of mRS distribution for LVO patients with no treatment</span>
<span class="n">no_treatment_lvo_bins_mt_deaths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">no_treatment_lvo_bins</span><span class="p">)</span>

<span class="c1"># Adjust deaths to include give 15.3% @ 285 min treatment (Goyal et al., 2016)</span>
<span class="n">excess_deaths</span> <span class="o">=</span> <span class="mf">0.036</span>
<span class="n">no_treatment_lvo_bins_mt_deaths</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">+=</span> <span class="n">excess_deaths</span>
<span class="n">correction_mrs_0_to_5</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">no_treatment_lvo_bins_mt_deaths</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">])</span> <span class="o">-</span> <span class="n">excess_deaths</span><span class="p">)</span> <span class="o">/</span> 
    <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">no_treatment_lvo_bins_mt_deaths</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">])))</span>
<span class="n">no_treatment_lvo_bins_mt_deaths</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">*=</span> <span class="n">correction_mrs_0_to_5</span>
<span class="n">no_treatment_lvo_cumsum_mt_deaths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">no_treatment_lvo_bins_mt_deaths</span><span class="p">)</span>

<span class="c1"># Store</span>
<span class="n">all_distributions_bins</span><span class="p">[</span><span class="s1">&#39;no_effect_lvo_mt_deaths&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">no_treatment_lvo_bins_mt_deaths</span>
<span class="n">all_distributions_cumsum</span><span class="p">[</span><span class="s1">&#39;no_effect_lvo_mt_deaths&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">no_treatment_lvo_cumsum_mt_deaths</span>

<span class="c1"># Show</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;LVO no treatment effect MT deaths&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----------------------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS bins:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">no_treatment_lvo_bins_mt_deaths</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS cumulative:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">no_treatment_lvo_cumsum_mt_deaths</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LVO no treatment effect MT deaths
----------------------------------
mRS bins:
array([0.0478, 0.0755, 0.13  , 0.1567, 0.236 , 0.129 , 0.225 ])

mRS cumulative:
array([0.0478, 0.1233, 0.2532, 0.41  , 0.646 , 0.775 , 1.    ])
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="mrs-distribution-at-t-0-for-lvo-patients-with-ivt">
<h3>mRS distribution at <em>t = 0</em> for LVO patients with IVT<a class="headerlink" href="#mrs-distribution-at-t-0-for-lvo-patients-with-ivt" title="Permalink to this headline">#</a></h3>
<p>We now have the two mRS distributions (fully recovered, and no effect) to calculate the mRS distribution for LVO patients recieving IVT at <em>t = 0</em>.</p>
<p>The weights used to combine the two mRS distribution (18% fully recovered &amp; 82% no effect) were informed by data from Emberson et al. 2014, and found in order to match the P(mRS &lt;= 1, t = 0) of 0.20, which is set as a target by extrapolating the control group mRS for patients with NIHSS 11+ back to a predicted odds ratio of mRS 0-1 of 2.0 at <em>t = 0</em>.</p>
<p>Calculate the weights needed to give a distribution with P(mRS &lt;= 1, t = 0) = 20%.</p>
<p>Note 1: We use the mRS distributions for no treatment adjusted with excess IVT deaths to represent the outcome of having treatment at <em>t = No Effect</em>.<br />
Note 2: We use the mRS distributions for pre-stroke adjusted with excess IVT deaths to represent the outcome of having a full recovery with treatment at <em>t = 0</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the difference between the target of P(mRS&lt;=1)=0.20 for LVO and the </span>
<span class="c1">#   pre-stroke LVO P(mRS&lt;=1) with excess IVT deaths</span>
<span class="n">target_diff</span> <span class="o">=</span> <span class="mf">0.20</span> <span class="o">-</span> <span class="n">pre_stroke_lvo_cumsum_ivt_deaths</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Calculate the known current difference between the no treatment LVO P(mRS&lt;=1) </span>
<span class="c1">#   and the pre-stroke LVO P(mRS&lt;=1), both with excess IVT deaths</span>
<span class="n">current_diff</span> <span class="o">=</span> <span class="p">(</span><span class="n">no_treatment_lvo_cumsum_ivt_deaths</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> 
                <span class="n">pre_stroke_lvo_cumsum_ivt_deaths</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># The weight attributable to no treatment LVO is the target difference / the </span>
<span class="c1">#   current difference</span>
<span class="n">weight_no_treatment_lvo</span> <span class="o">=</span> <span class="n">target_diff</span> <span class="o">/</span> <span class="n">current_diff</span>

<span class="c1"># The weight attributable to pre-stroke LVO is (1 - the weight attributable to</span>
<span class="c1">#   no treatment LVO</span>
<span class="n">weight_pre_stroke_lvo</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">weight_no_treatment_lvo</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s1">&#39;Weights (pre-stroke, no_treatment): </span><span class="si">{</span><span class="n">weight_pre_stroke_lvo</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">,&#39;</span><span class="p">,</span> \
    <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">weight_no_treatment_lvo</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Weights (pre-stroke, no_treatment): 0.1828, 0.8172
</pre></div>
</div>
</div>
</div>
<p>Apply the weights.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Apply weights</span>
<span class="n">t0_treatment_lvo_ivt_bins</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">weight_pre_stroke_lvo</span> <span class="o">*</span> <span class="n">pre_stroke_lvo_bins_ivt_deaths</span><span class="p">)</span> <span class="o">+</span>
    <span class="p">(</span><span class="n">weight_no_treatment_lvo</span> <span class="o">*</span> <span class="n">no_treatment_lvo_bins_ivt_deaths</span><span class="p">))</span>

<span class="c1"># Normalise</span>
<span class="n">t0_treatment_lvo_ivt_bins</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">t0_treatment_lvo_ivt_bins</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">t0_treatment_lvo_ivt_bins</span><span class="p">))</span>

<span class="n">all_distributions_bins</span><span class="p">[</span><span class="s1">&#39;t0_treatment_lvo_ivt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t0_treatment_lvo_ivt_bins</span>

<span class="c1"># Make cumulative distribution</span>
<span class="n">t0_treatment_lvo_ivt_cumsum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">t0_treatment_lvo_ivt_bins</span><span class="p">)</span>
<span class="n">all_distributions_cumsum</span><span class="p">[</span><span class="s1">&#39;t0_treatment_lvo_ivt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t0_treatment_lvo_ivt_cumsum</span>

<span class="c1"># Show</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;LVO t0 IVT treatment effect&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---------------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS bins:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">t0_treatment_lvo_ivt_bins</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS cumulative:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">t0_treatment_lvo_ivt_cumsum</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LVO t0 IVT treatment effect
---------------------------
mRS bins:
array([0.1129, 0.0871, 0.1274, 0.1574, 0.2135, 0.1132, 0.1886])

mRS cumulative:
array([0.1129, 0.2   , 0.3274, 0.4848, 0.6982, 0.8114, 1.    ])
</pre></div>
</div>
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="mrs-distribution-at-t-0-for-lvo-patients-with-mt">
<h2>mRS distribution at <em>t = 0</em> for LVO patients with MT<a class="headerlink" href="#mrs-distribution-at-t-0-for-lvo-patients-with-mt" title="Permalink to this headline">#</a></h2>
<p>We now have the two mRS distributions (fully recovered, and no effect) to calculate the mRS distribution for LVO patients recieving MT at <em>t = 0</em>.</p>
<p>The weights used to combine the two mRS distribution (75% fully recovered &amp; 25% no effect) are taken from Hui et al. 2020, who reported 75% successful recanalisation with thrombectomy. We assume that recanalisation at <em>t = 0</em> restores all pre-stroke function*.</p>
<p>*Extrapolating results of good outcome, when recanalisation has been achieved with thrombectomy, from Fransen et al. 2016 back to t = 0, assuming 75% recanalisation, gives the same proportion of patients with mRS &lt;= 2 as the pre-stroke mRS in the SSNAP data (therefore this extrapolation would suggest full recovery of all health with thrombectomy theoretically carried out at t = 0).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight_pre_stroke_lvo</span> <span class="o">=</span> <span class="mf">0.75</span>
<span class="n">weight_no_treatment_lvo</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">weight_pre_stroke_lvo</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Weights (pre-stroke, no treatment): </span><span class="si">{</span><span class="n">weight_pre_stroke_lvo</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">,&#39;</span> \
      <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">weight_no_treatment_lvo</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Weights (pre-stroke, no treatment): 0.7500,0.2500
</pre></div>
</div>
</div>
</div>
<p>Apply the weights</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Apply weights</span>
<span class="n">t0_treatment_lvo_mt_bins</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">weight_pre_stroke_lvo</span> <span class="o">*</span> <span class="n">pre_stroke_lvo_bins_mt_deaths</span><span class="p">)</span> <span class="o">+</span>
    <span class="p">(</span><span class="n">weight_no_treatment_lvo</span> <span class="o">*</span> <span class="n">no_treatment_lvo_bins_mt_deaths</span><span class="p">))</span>

<span class="c1"># Normalise</span>
<span class="n">t0_treatment_lvo_mt_bins</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">t0_treatment_lvo_mt_bins</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">t0_treatment_lvo_mt_bins</span><span class="p">))</span>
<span class="n">all_distributions_bins</span><span class="p">[</span><span class="s1">&#39;t0_treatment_lvo_mt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t0_treatment_lvo_mt_bins</span>

<span class="c1"># Make cumulative distribution</span>
<span class="n">t0_treatment_lvo_mt_cumsum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">t0_treatment_lvo_mt_bins</span><span class="p">)</span>
<span class="n">all_distributions_cumsum</span><span class="p">[</span><span class="s1">&#39;t0_treatment_lvo_mt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t0_treatment_lvo_mt_cumsum</span>

<span class="c1"># Show</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;LVO MT t0 treatment effect&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--------------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS bins:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">t0_treatment_lvo_mt_bins</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS cumulative:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">t0_treatment_lvo_mt_cumsum</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LVO MT t0 treatment effect
--------------------------
mRS bins:
array([0.3141, 0.1222, 0.1181, 0.1579, 0.1413, 0.0631, 0.0832])

mRS cumulative:
array([0.3141, 0.4363, 0.5544, 0.7123, 0.8536, 0.9167, 1.    ])
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="show-all-results">
<h2>Show all results<a class="headerlink" href="#show-all-results" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_distributions_bins_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">all_distributions_bins</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">all_distributions_bins_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span>
    <span class="s1">&#39;./outcome_utilities/mrs_dist_probs_bins.csv&#39;</span><span class="p">,</span> <span class="n">index_label</span><span class="o">=</span><span class="s1">&#39;Stroke type&#39;</span><span class="p">)</span>
<span class="n">all_distributions_bins_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>pre_stroke_nlvo</th>
      <td>0.5829</td>
      <td>0.1625</td>
      <td>0.1034</td>
      <td>0.1022</td>
      <td>0.0420</td>
      <td>0.0069</td>
      <td>0.0000</td>
    </tr>
    <tr>
      <th>pre_stroke_nlvo_ivt_deaths</th>
      <td>0.5765</td>
      <td>0.1608</td>
      <td>0.1023</td>
      <td>0.1011</td>
      <td>0.0415</td>
      <td>0.0069</td>
      <td>0.0110</td>
    </tr>
    <tr>
      <th>pre_stroke_lvo</th>
      <td>0.4179</td>
      <td>0.1430</td>
      <td>0.1184</td>
      <td>0.1642</td>
      <td>0.1138</td>
      <td>0.0427</td>
      <td>0.0000</td>
    </tr>
    <tr>
      <th>pre_stroke_lvo_ivt_deaths</th>
      <td>0.4036</td>
      <td>0.1381</td>
      <td>0.1144</td>
      <td>0.1586</td>
      <td>0.1099</td>
      <td>0.0413</td>
      <td>0.0341</td>
    </tr>
    <tr>
      <th>pre_stroke_lvo_mt_deaths</th>
      <td>0.4028</td>
      <td>0.1378</td>
      <td>0.1142</td>
      <td>0.1583</td>
      <td>0.1097</td>
      <td>0.0412</td>
      <td>0.0360</td>
    </tr>
    <tr>
      <th>no_treatment_nlvo</th>
      <td>0.1971</td>
      <td>0.2629</td>
      <td>0.1200</td>
      <td>0.1277</td>
      <td>0.1479</td>
      <td>0.0620</td>
      <td>0.0823</td>
    </tr>
    <tr>
      <th>no_effect_nlvo_ivt_deaths</th>
      <td>0.1973</td>
      <td>0.2627</td>
      <td>0.1176</td>
      <td>0.1247</td>
      <td>0.1430</td>
      <td>0.0592</td>
      <td>0.0955</td>
    </tr>
    <tr>
      <th>t0_treatment_nlvo_ivt</th>
      <td>0.4298</td>
      <td>0.2002</td>
      <td>0.1082</td>
      <td>0.1102</td>
      <td>0.0808</td>
      <td>0.0271</td>
      <td>0.0437</td>
    </tr>
    <tr>
      <th>no_treatment_lvo</th>
      <td>0.0500</td>
      <td>0.0790</td>
      <td>0.1360</td>
      <td>0.1640</td>
      <td>0.2470</td>
      <td>0.1350</td>
      <td>0.1890</td>
    </tr>
    <tr>
      <th>no_effect_lvo_ivt_deaths</th>
      <td>0.0479</td>
      <td>0.0757</td>
      <td>0.1303</td>
      <td>0.1571</td>
      <td>0.2366</td>
      <td>0.1293</td>
      <td>0.2231</td>
    </tr>
    <tr>
      <th>no_effect_lvo_mt_deaths</th>
      <td>0.0478</td>
      <td>0.0755</td>
      <td>0.1300</td>
      <td>0.1567</td>
      <td>0.2360</td>
      <td>0.1290</td>
      <td>0.2250</td>
    </tr>
    <tr>
      <th>t0_treatment_lvo_ivt</th>
      <td>0.1129</td>
      <td>0.0871</td>
      <td>0.1274</td>
      <td>0.1574</td>
      <td>0.2135</td>
      <td>0.1132</td>
      <td>0.1886</td>
    </tr>
    <tr>
      <th>t0_treatment_lvo_mt</th>
      <td>0.3141</td>
      <td>0.1222</td>
      <td>0.1181</td>
      <td>0.1579</td>
      <td>0.1413</td>
      <td>0.0631</td>
      <td>0.0832</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_distributions_cumsum_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">all_distributions_cumsum</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">all_distributions_cumsum_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span>
    <span class="s1">&#39;./outcome_utilities/mrs_dist_probs_cumsum.csv&#39;</span><span class="p">,</span> <span class="n">index_label</span><span class="o">=</span><span class="s1">&#39;Stroke type&#39;</span><span class="p">)</span>
<span class="n">all_distributions_cumsum_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>pre_stroke_nlvo</th>
      <td>0.5829</td>
      <td>0.7454</td>
      <td>0.8489</td>
      <td>0.9511</td>
      <td>0.9931</td>
      <td>1.0000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>pre_stroke_nlvo_ivt_deaths</th>
      <td>0.5765</td>
      <td>0.7372</td>
      <td>0.8395</td>
      <td>0.9406</td>
      <td>0.9821</td>
      <td>0.9890</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>pre_stroke_lvo</th>
      <td>0.4179</td>
      <td>0.5609</td>
      <td>0.6793</td>
      <td>0.8435</td>
      <td>0.9573</td>
      <td>1.0000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>pre_stroke_lvo_ivt_deaths</th>
      <td>0.4036</td>
      <td>0.5417</td>
      <td>0.6561</td>
      <td>0.8147</td>
      <td>0.9246</td>
      <td>0.9659</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>pre_stroke_lvo_mt_deaths</th>
      <td>0.4028</td>
      <td>0.5407</td>
      <td>0.6548</td>
      <td>0.8131</td>
      <td>0.9228</td>
      <td>0.9640</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>no_treatment_nlvo</th>
      <td>0.1971</td>
      <td>0.4600</td>
      <td>0.5800</td>
      <td>0.7078</td>
      <td>0.8557</td>
      <td>0.9177</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>no_effect_nlvo_ivt_deaths</th>
      <td>0.1973</td>
      <td>0.4600</td>
      <td>0.5776</td>
      <td>0.7023</td>
      <td>0.8452</td>
      <td>0.9045</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>t0_treatment_nlvo_ivt</th>
      <td>0.4298</td>
      <td>0.6300</td>
      <td>0.7382</td>
      <td>0.8484</td>
      <td>0.9292</td>
      <td>0.9563</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>no_treatment_lvo</th>
      <td>0.0500</td>
      <td>0.1290</td>
      <td>0.2650</td>
      <td>0.4290</td>
      <td>0.6760</td>
      <td>0.8110</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>no_effect_lvo_ivt_deaths</th>
      <td>0.0479</td>
      <td>0.1236</td>
      <td>0.2539</td>
      <td>0.4110</td>
      <td>0.6476</td>
      <td>0.7769</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>no_effect_lvo_mt_deaths</th>
      <td>0.0478</td>
      <td>0.1233</td>
      <td>0.2532</td>
      <td>0.4100</td>
      <td>0.6460</td>
      <td>0.7750</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>t0_treatment_lvo_ivt</th>
      <td>0.1129</td>
      <td>0.2000</td>
      <td>0.3274</td>
      <td>0.4848</td>
      <td>0.6982</td>
      <td>0.8114</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>t0_treatment_lvo_mt</th>
      <td>0.3141</td>
      <td>0.4363</td>
      <td>0.5544</td>
      <td>0.7123</td>
      <td>0.8536</td>
      <td>0.9167</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<hr class="docutils" />
<section id="plot-distributions">
<h2>Plot distributions<a class="headerlink" href="#plot-distributions" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">outcome_utilities.dist_plot</span> <span class="kn">import</span> <span class="n">draw_horizontal_bar</span><span class="p">,</span> \
    <span class="n">draw_connections</span>
</pre></div>
</div>
</div>
</div>
<p>Define plot colour scheme</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn-colorblind&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_distributions_bins_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;t0_treatment_lvo_ivt&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    0.1129
1    0.0871
2    0.1274
3    0.1574
4    0.2135
5    0.1132
6    0.1886
Name: t0_treatment_lvo_ivt, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_info</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="n">all_distributions_bins_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;no_effect_nlvo_ivt_deaths&#39;</span><span class="p">],</span> 
     <span class="n">all_distributions_bins_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;t0_treatment_nlvo_ivt&#39;</span><span class="p">],</span> 
     <span class="s1">&#39;nLVO treated with IVT&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">all_distributions_bins_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;no_effect_lvo_ivt_deaths&#39;</span><span class="p">],</span> 
     <span class="n">all_distributions_bins_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;t0_treatment_lvo_ivt&#39;</span><span class="p">],</span> 
     <span class="s1">&#39;LVO treated with IVT&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">all_distributions_bins_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;no_effect_lvo_mt_deaths&#39;</span><span class="p">],</span> 
     <span class="n">all_distributions_bins_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;t0_treatment_lvo_mt&#39;</span><span class="p">],</span> 
     <span class="s1">&#39;LVO treated with MT&#39;</span><span class="p">]</span>
    <span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">gridspec_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;wspace&#39;</span><span class="p">:</span><span class="mf">0.2</span><span class="p">})</span>
<span class="n">y_vals</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">info</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">plot_info</span><span class="p">):</span>
    <span class="n">ylabel_top</span> <span class="o">=</span> <span class="s1">&#39;Time = 0 hours&#39;</span> <span class="k">if</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">1</span> <span class="k">else</span> <span class="s1">&#39; &#39;</span>
    <span class="n">ylabel_bottom</span> <span class="o">=</span> <span class="s1">&#39;Time of no effect&#39;</span> <span class="k">if</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">1</span> <span class="k">else</span> <span class="s1">&#39;  &#39;</span>
    <span class="n">y_labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">ylabel_top</span><span class="p">,</span> <span class="n">ylabel_bottom</span><span class="p">]</span>
    
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    
    <span class="c1"># Draw no effect distribution</span>
    <span class="n">draw_horizontal_bar</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">y_vals</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">:</span>
        <span class="c1"># Add legend now to prevent doubling all the labels:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper center&#39;</span><span class="p">,</span><span class="n">ncol</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;mRS&#39;</span><span class="p">,</span> 
                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span><span class="o">-</span><span class="mf">0.1</span><span class="p">])</span>   <span class="c1"># Legend below axis.</span>
    
    <span class="c1"># Draww t=0 distribution</span>
    <span class="n">draw_horizontal_bar</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">y_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    
    <span class="c1"># Darw connecting lines</span>
    <span class="n">draw_connections</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">info</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    
    <span class="c1"># Add general content</span>
    <span class="n">label</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Probability&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.01</span><span class="p">,</span><span class="mf">0.1</span><span class="p">),</span> <span class="n">minor</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">y_vals</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">y_labels</span><span class="p">)</span>
    
    
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;./images/dist_bars.jpg&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/01_mRS_datasets_full_71_0.png" src="_images/01_mRS_datasets_full_71_0.png" />
</div>
</div>
<p>Plot individual plots</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">info</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">plot_info</span><span class="p">):</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">gridspec_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;wspace&#39;</span><span class="p">:</span><span class="mf">0.2</span><span class="p">})</span>
    <span class="n">y_vals</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

    <span class="n">ylabel_top</span> <span class="o">=</span> <span class="s1">&#39;Time = 0 hours&#39;</span>
    <span class="n">ylabel_bottom</span> <span class="o">=</span> <span class="s1">&#39;Time of no effect&#39;</span>
    <span class="n">y_labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">ylabel_top</span><span class="p">,</span> <span class="n">ylabel_bottom</span><span class="p">]</span>
    
    <span class="c1"># Draw no effect distribution</span>
    <span class="n">draw_horizontal_bar</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">y_vals</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    
    <span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper center&#39;</span><span class="p">,</span><span class="n">ncol</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;mRS&#39;</span><span class="p">,</span> 
                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span><span class="o">-</span><span class="mf">0.0</span><span class="p">])</span>   <span class="c1"># Legend below axis.</span>
    
    <span class="c1"># Draww t=0 distribution</span>
    <span class="n">draw_horizontal_bar</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">y_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    
    <span class="c1"># Darw connecting lines</span>
    <span class="n">draw_connections</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">info</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    
    <span class="c1"># Add general content</span>
    <span class="n">label</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Probability&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.01</span><span class="p">,</span><span class="mf">0.1</span><span class="p">),</span> <span class="n">minor</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">y_vals</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">y_labels</span><span class="p">)</span>
    
    <span class="n">label</span> <span class="o">=</span> <span class="n">label</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;./images/dist_bars_</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1">.jpg&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/01_mRS_datasets_full_73_0.png" src="_images/01_mRS_datasets_full_73_0.png" />
<img alt="_images/01_mRS_datasets_full_73_1.png" src="_images/01_mRS_datasets_full_73_1.png" />
<img alt="_images/01_mRS_datasets_full_73_2.png" src="_images/01_mRS_datasets_full_73_2.png" />
</div>
</div>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">#</a></h2>
<p>de la Ossa Herrero N, Carrera D, Gorchs M, Querol M, Millán M, Gomis M, et al. Design and Validation of a Prehospital Stroke Scale to Predict Large Arterial Occlusion The Rapid Arterial Occlusion Evaluation Scale. Stroke; a journal of cerebral circulation. 2013 Nov 26;45.</p>
<p>Emberson J, Lees KR, Lyden P, et al. <em>Effect of treatment delay, age, and stroke severity on the effects of intravenous thrombolysis with alteplase for acute ischaemic stroke: A meta-analysis of individual patient data from randomised trials.</em> The Lancet 2014;384:1929–35. doi:10.1016/S0140-6736(14)60584-5</p>
<p>Fransen, P., Berkhemer, O., Lingsma, H. et al. Time to Reperfusion and Treatment Effect for Acute Ischemic Stroke: A Randomized Clinical Trial. JAMA Neurol. 2016 Feb 1;73(2):190–6. DOI: 10.1001/jamaneurol.2015.3886</p>
<p>Goyal M, Menon BK, van Zwam WH, et al. <em>Endovascular thrombectomy after large-vessel ischaemic stroke: a meta-analysis of individual patient data from five randomised trials.</em> The Lancet 2016;387:1723-1731. doi:10.1016/S0140-6736(16)00163-X</p>
<p>Hui W, Wu C, Zhao W, Sun H, Hao J, Liang H, et al. Efficacy and Safety of Recanalization Therapy for Acute Ischemic Stroke With Large Vessel Occlusion. Stroke. 2020 Jul;51(7):2026–35.</p>
<p>IST-3 collaborative group, Sandercock P, Wardlaw JM, Lindley RI, Dennis M, Cohen G, et al. The benefits and harms of intravenous thrombolysis with recombinant tissue plasminogen activator within 6 h of acute ischaemic stroke (the third international stroke trial [IST-3]): a randomised controlled trial. Lancet. 2012 379:2352-63.</p>
<p>Lees KR, Bluhmki E, von Kummer R, et al. <em>Time to treatment with intravenous alteplase and outcome in stroke: an updated pooled analysis of ECASS, ATLANTIS, NINDS, and EPITHET trials</em>. The Lancet 2010;375:1695-703. doi:10.1016/S0140-6736(10)60491-6</p>
<p>McMeekin P, White P, James MA, Price CI, Flynn D, Ford GA. Estimating the number of UK stroke patients eligible for endovascular thrombectomy. European Stroke Journal. 2017;2:319–26.</p>
<p>SAMueL-1 data on mRS before stroke (DOI: 10.5281/zenodo.6896710): <a class="reference external" href="https://samuel-book.github.io/samuel-1/descriptive_stats/08_prestroke_mrs.html">https://samuel-book.github.io/samuel-1/descriptive_stats/08_prestroke_mrs.html</a></p>
</section>
<section id="appendix">
<h2>Appendix<a class="headerlink" href="#appendix" title="Permalink to this headline">#</a></h2>
<section id="excess-deaths-due-to-treatment">
<h3>1. Excess deaths due to treatment<a class="headerlink" href="#excess-deaths-due-to-treatment" title="Permalink to this headline">#</a></h3>
<section id="ivt-deaths-due-to-fatal-intracranial-haemorrhage-emberson-et-al-2014">
<h4>IVT deaths due to fatal intracranial haemorrhage (Emberson et al., 2014):<a class="headerlink" href="#ivt-deaths-due-to-fatal-intracranial-haemorrhage-emberson-et-al-2014" title="Permalink to this headline">#</a></h4>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>NIHSS</p></th>
<th class="head"><p>Treated</p></th>
<th class="head"><p>Control</p></th>
<th class="head"><p>Excess</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0-10</p></td>
<td><p>1.41%</p></td>
<td><p>0.32%</p></td>
<td><p>1.10%</p></td>
</tr>
<tr class="row-odd"><td><p>11+</p></td>
<td><p>3.85%</p></td>
<td><p>0.45%</p></td>
<td><p>3.41%</p></td>
</tr>
<tr class="row-even"><td><p>All</p></td>
<td><p>2.68%</p></td>
<td><p>0.39%</p></td>
<td><p>2.29%</p></td>
</tr>
</tbody>
</table>
<p>Excess deaths due to IVT are assumed to occur independently of time. Differing risks of death are applied according to whether the patient is assumed nLVO (NIHSS 0-10 as a surrogate for nLVO) or LVO (NIHSS 11+, as a surrogate for LVO). Note: Rounding errors exist in the “Excess” column.</p>
<p>We use Embersons 2.29% excess deaths from IVT on all patients (nLVO and LVO) with the combined nLVO/LVO population from Lees et al. 2010. From the available trial data, we assume that the split between nLVO/LVO is as near the same in both Lees and Emberson:</p>
<ul class="simple">
<li><p>Lees has 3670 patients, they provide a granular level of mRS distribution for their population (combined nLVO/LVO) but they do not provide the proportions of the split.</p></li>
<li><p>Emberson has 6756 patients (they have the 3035 patients from IST-3 in addition to those in Lees, with 51 unaccounted for), they provide the excess deaths by stroke severity. To obtain their value of 2.29% excess deaths from IVT for all patients, this requires a weighting of 48.27% nLVO and 51.73% LVO.</p></li>
<li><p>IST-3 has 3035 patients and provide proportion of patients by stroke severity: 48.24% nLVO and 51.76% LVO. This is as near as the same that we have calculated in Emberson.</p></li>
<li><p>Assuming that Lees contains the other patients in Emberson (those not from IST-3), then it is a fair assumption that Lees has the same split (nLVO/LVO) of patients as Emberson, and so can use 2.29% excess deaths from IVT for Lees combined nLVO/LVO population.</p></li>
</ul>
</section>
<section id="mt-deaths-goyal-et-al-2016">
<h4>MT deaths (Goyal et al., 2016):<a class="headerlink" href="#mt-deaths-goyal-et-al-2016" title="Permalink to this headline">#</a></h4>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Treated*</p></th>
<th class="head"><p>Control</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>15.3%</p></td>
<td><p>18.9%</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>Average onset to reperfusion time of 285 minutes.</p></li>
</ul>
<p>Without correction for MT-related deaths, the model predicts a 13.2% mortality rate for LVO patients treated at 285 minutes. Adding in a 3.6% risk of death from treatment corrects this to the trial results of 15.3% mortality at 285 minutes treatment.</p>
<p>The control group in Goyal et al. do not receive MT, but do receive other interventions such as IVT (used in 83% of patients). No additional IVT-related deaths need to be considered when modelling use of MT as the control group (used to estimate the effect of MT at a time MT is no longer effective) already includes IVT-related excess deaths.</p>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="intro.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Predicting disability outcomes and utility after treatment of stroke with thrombolysis (IVT) or thrombectomy (MT)</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="02_mRS_outcomes_maths.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Mathematics for calculating odds and probabilities of mRS-level outcomes after stroke, based on time to reperfusion treatment</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Anna Laws, Kerry Pearn & Michael Allen<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>