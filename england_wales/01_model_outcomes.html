

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Calculate outcomes &#8212; Stroke outcome modelling</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=c5ced968eda925caa686" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=c5ced968eda925caa686" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=c5ced968eda925caa686" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=c5ced968eda925caa686" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=c5ced968eda925caa686" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=c5ced968eda925caa686" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=c5ced968eda925caa686"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'england_wales/01_model_outcomes';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Combine populations for weighted outcomes" href="01c_weighted_outcomes.html" />
    <link rel="prev" title="Emergency stroke admissions predictions" href="../admission_prediction/01_msoa_regression.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Stroke outcome modelling</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">üìö Definitions reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../definitions_reference/definitions_stroke.html">Definitions for stroke</a></li>
<li class="toctree-l1"><a class="reference internal" href="../definitions_reference/definitions_maths.html">Definitions for maths</a></li>
<li class="toctree-l1"><a class="reference internal" href="../definitions_reference/paper.html">Paper creation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">üßÆ Outcome model methods</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../outcome_model_methods/01_mrs_dist_derivation.html">Derivation of mRS distributions from reference data</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../outcome_model_methods/01b_excess_deaths.html">Excess death rate calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outcome_model_methods/01c_extrapolate_time_zero.html">Extrapolating a known odds ratio back to time zero</a></li>

<li class="toctree-l2"><a class="reference internal" href="../outcome_model_methods/01d_lvo_proportion.html">Proportion of ischaemic patients with LVO</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../outcome_model_methods/02_probs_with_time.html">Calculating outcome probabilities with time to treatment</a></li>



<li class="toctree-l1 has-children"><a class="reference internal" href="../outcome_model_methods/intro_extra.html">Extra details</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../outcome_model_methods/02b_formulae.html">Extra: Formulae for probabilities with time</a></li>



<li class="toctree-l2"><a class="reference internal" href="../outcome_model_methods/02c_extra_maths.html">Extra: Logistic functions</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">üì¶ stroke-outcome package</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../package_docs/intro.html">Stroke outcome</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../package_docs/docs_continuous_outcome.html">Documentation: Continuous outcome model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../package_docs/demo_continuous_outcomes.html">Demo: Continuous outcome model</a></li>

<li class="toctree-l2"><a class="reference internal" href="../package_docs/docs_discrete_outcome.html">Documentation: Discrete outcome model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../package_docs/demo_discrete_outcomes.html">Demo: discrete outcome model</a></li>

</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">üìà General results</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../general_results/01b_population.html">Example patient population and pathway timings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general_results/04_matrix.html">Demonstration of added utility depending on time to IVT and MT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general_results/04b_matrix_maths.html">Quantifying added utility depending on time to IVT and MT</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">üß≠ Generic geography</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../general_results/05_geography.html">Distance-based treatment effects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general_results/05_geography_outcomes.html">Calculate distance-based treatment effects for many cohorts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general_results/05c_geography_outcomes_plots.html">Plot distance-based treatment effects for many cohorts</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">üåç Application to England and Wales</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="intro_data.html">Data creation</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../admission_prediction/01_msoa_regression.html">Emergency stroke admissions predictions</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Calculate outcomes</a></li>
<li class="toctree-l2"><a class="reference internal" href="01c_weighted_outcomes.html">Combine populations for weighted outcomes</a></li>
<li class="toctree-l2"><a class="reference internal" href="01d_weighted_outcomes_mrs_dists.html">Combine populations for weighted mRS distributions</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="intro_results.html">Results</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="02_lsoa_analysis_added_utility.html">Mapping outcomes</a></li>
<li class="toctree-l2"><a class="reference internal" href="04_outlier_areas.html">Mapping outliers</a></li>
<li class="toctree-l2"><a class="reference internal" href="03_national_mrs_dists.html">National mRS distributions</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">üëë Interactive demo</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../streamlit/streamlit.html">Streamlit app</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/samuel-book/stroke_outcome" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/england_wales/01_model_outcomes.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Calculate outcomes</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plain-english-summary">Plain English summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aims">Aims</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#method">Method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-packages">Load packages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#global-variables-to-use">Global variables to use</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-and-parse-data">Load and parse data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#load-and-parse-hospital-data">Load and parse hospital data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#find-lsoa-hospital-travel-time">Find LSOA-hospital travel time</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#find-inter-hospital-travel-time">Find inter-hospital travel time</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gather-travel-time-information">Gather travel time information</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#add-on-stroke-pathway-timings">Add on stroke pathway timings</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Calculate outcomes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#save-results-to-file">Save results to file</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="calculate-outcomes">
<h1>Calculate outcomes<a class="headerlink" href="#calculate-outcomes" title="Permalink to this heading">#</a></h1>
<p>This notebook calculates outcomes based on travel times from Lower Super Output Areas (LSOAs) to nearest (in time) acute stroke units that provide thrombolysis and/or thrombectomy.</p>
<p>This notebook calculates the outcomes using the stroke outcome model. The following notebooks combine different cohorts of patients to find the results for a mixed population, and then further notebooks plot the results.</p>
<section id="plain-english-summary">
<h2>Plain English summary<a class="headerlink" href="#plain-english-summary" title="Permalink to this heading">#</a></h2>
<p>We would like to know how travel time to stroke units affects patient outcomes for different parts of England and Wales. We can explore this by keeping the same timings for everything else between the start of the stroke and the beginning of treatment and only adjusting the travel time. For example, a patient who lives 20 minutes further away from the stroke unit than another patient will have an onset to treatment time 20 minutes longer.</p>
<p>In this notebook we look at each Lower Super Output Area (LSOA), a small region of the country that contains a couple of thousand people. For an idea of scale, the city of Exeter is split into around 70 or 80 LSOA. In a more rural location, a larger geographical area must be covered to collect a couple of thousand people and so the LSOAs are larger.</p>
<p>We find a few travel times:</p>
<ul class="simple">
<li><p>the travel time from each LSOA to its nearest stroke unit</p></li>
<li><p>the travel time from each LSOA to its nearest thrombectomy unit</p></li>
<li><p>the travel time between each LSOA‚Äôs nearest stroke unit and its nearest thrombectomy unit, for transfers between hospitals</p></li>
</ul>
<p>We then add these to fixed stroke pathway times to calculate a few times to treatment:</p>
<ul class="simple">
<li><p>time to IVT when travelling directly to the nearest stroke unit</p></li>
<li><p>time to MT after a transfer from the nearest stroke unit to the MT unit</p></li>
<li><p>time to IVT when travelling directly to the MT unit</p></li>
<li><p>time to MT when travelling directly to the MT unit</p></li>
</ul>
<p>In the UK most of the stroke units will provide thrombolysis but not thrombectomy. Some patients will live nearest to an MT unit and so both of their sets of times will be identical. For most patients though, the time to IVT will be longer if travelling to the MT unit because the unit is further away than their nearest unit. The time to MT is usually longer if a transfer is required than if the patient went directly to the MT unit to start with, partly because the patient spends more time travelling between units and partly because there are delays in getting the patient ready to travel between hospitals.</p>
<p>We can then feed these treatment times into the stroke outcome model. This will give us two sets of outcomes for patients in each LSOA in England and Wales: one set for patients who travel directly to the nearest stroke unit, and a second set for patients who travel directly to the MT centre.</p>
</section>
<section id="aims">
<h2>Aims<a class="headerlink" href="#aims" title="Permalink to this heading">#</a></h2>
<p>Calculate outcomes after treatment for these cohorts:</p>
<ul class="simple">
<li><p>nLVO with IVT</p></li>
<li><p>LVO with IVT only</p></li>
<li><p>LVO with MT only</p></li>
<li><p>LVO with both IVT and MT</p></li>
</ul>
<p>Calculate outcomes after treatment for these timings:</p>
<ul class="simple">
<li><p>IVT at the nearest stroke unit</p></li>
<li><p>MT after transfer to the MT unit</p></li>
<li><p>IVT after redirection to the MT unit</p></li>
<li><p>MT after redirection to the MT unit</p></li>
</ul>
<p>Then save the outcome data to file for later use.</p>
<p>Two sets of outcomes will be saved:</p>
<ul class="simple">
<li><p>population-averaged added utility, shift in mean mRS, proportion with mRS&lt;=2</p></li>
<li><p>mRS distribution after treatment</p></li>
</ul>
</section>
<section id="method">
<h2>Method<a class="headerlink" href="#method" title="Permalink to this heading">#</a></h2>
<p>The travel times are calculated from each LSOA centroid to the location of each stroke unit.</p>
<p>Travel times are estimated using Open Street Map[1], accessed by routino [2].</p>
<p>[1] <a class="reference external" href="https://www.openstreetmap.org/">https://www.openstreetmap.org/</a></p>
<p>[2] <a class="reference external" href="https://packages.debian.org/sid/routino">https://packages.debian.org/sid/routino</a></p>
<ul class="simple">
<li><p>load in stroke-map package</p></li>
<li><p>Calculate travel time from each LSOA to its nearest acute stroke unit and to its nearest unit providing thrombectomy</p></li>
<li><p>Add on fixed pathway timings (onset to call, ambulance on scene, door-in-door-out etc.) to find time to thrombolysis and time to thrombectomy</p></li>
<li><p>Feed treatment times into the outcome model to find outcomes for each patient subgroup at those treatment times.</p></li>
</ul>
</section>
<section id="load-packages">
<h2>Load packages<a class="headerlink" href="#load-packages" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dir_output</span> <span class="o">=</span> <span class="s1">&#39;output&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Adjust max rows to show</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">stroke_maps</span>
<span class="kn">import</span> <span class="nn">stroke_outcome</span>

<span class="kn">import</span> <span class="nn">stroke_outcome.outcome_utilities</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stroke_maps</span><span class="o">.</span><span class="n">__version__</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;0.5.0&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stroke_outcome</span><span class="o">.</span><span class="n">__version__</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;0.1.6&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">stroke_maps.load_data</span>
<span class="kn">import</span> <span class="nn">stroke_maps.catchment</span>

<span class="kn">from</span> <span class="nn">stroke_outcome.continuous_outcome</span> <span class="kn">import</span> <span class="n">Continuous_outcome</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="global-variables-to-use">
<h2>Global variables to use<a class="headerlink" href="#global-variables-to-use" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">limit_to_england</span> <span class="o">=</span> <span class="kc">False</span>

<span class="c1"># File name for saved results</span>
<span class="n">file_name</span> <span class="o">=</span> <span class="s1">&#39;lsoa_base&#39;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="load-and-parse-data">
<h2>Load and parse data<a class="headerlink" href="#load-and-parse-data" title="Permalink to this heading">#</a></h2>
<section id="load-and-parse-hospital-data">
<h3>Load and parse hospital data<a class="headerlink" href="#load-and-parse-hospital-data" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get list of hopsitals and limit to those used in 2022</span>
<span class="n">hospitals</span> <span class="o">=</span> <span class="n">stroke_maps</span><span class="o">.</span><span class="n">load_data</span><span class="o">.</span><span class="n">stroke_unit_region_lookup</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hospitals</span><span class="p">[</span><span class="s1">&#39;use&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hospitals</span><span class="p">[[</span><span class="s1">&#39;use_ivt&#39;</span><span class="p">,</span> <span class="s1">&#39;use_mt&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">hospitals</span><span class="p">[</span><span class="s1">&#39;use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>
<span class="n">hospitals</span> <span class="o">=</span> <span class="n">hospitals</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">limit_to_england</span><span class="p">:</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">hospitals</span><span class="p">[</span><span class="s1">&#39;country&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;England&#39;</span>
    <span class="n">hospitals</span> <span class="o">=</span> <span class="n">hospitals</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hospitals</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>stroke_team</th>
      <th>short_code</th>
      <th>ssnap_name</th>
      <th>use_ivt</th>
      <th>use_mt</th>
      <th>use_msu</th>
      <th>transfer_unit_postcode</th>
      <th>lsoa</th>
      <th>lsoa_code</th>
      <th>region</th>
      <th>region_code</th>
      <th>region_type</th>
      <th>country</th>
      <th>icb</th>
      <th>icb_code</th>
      <th>isdn</th>
      <th>use</th>
    </tr>
    <tr>
      <th>postcode</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>SY231ER</th>
      <td>Bronglais Hospital (Aberystwyth)</td>
      <td>AB</td>
      <td>Bronglais Hospital</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>nearest</td>
      <td>Ceredigion 002A</td>
      <td>W01000512</td>
      <td>Hywel Dda University Health Board</td>
      <td>W11000025</td>
      <td>LHB</td>
      <td>Wales</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
    </tr>
    <tr>
      <th>CB20QQ</th>
      <td>Addenbrooke's Hospital, Cambridge</td>
      <td>AD</td>
      <td>Addenbrooke's Hospital</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>nearest</td>
      <td>Cambridge 013D</td>
      <td>E01017995</td>
      <td>NHS Cambridgeshire and Peterborough ICB - 06H</td>
      <td>E38000260</td>
      <td>SICBL</td>
      <td>England</td>
      <td>NHS Cambridgeshire and Peterborough Integrated...</td>
      <td>E54000056</td>
      <td>East of England (South)</td>
      <td>1</td>
    </tr>
    <tr>
      <th>L97AL</th>
      <td>University Hospital Aintree, Liverpool</td>
      <td>AI</td>
      <td>University Hospital Aintree</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>nearest</td>
      <td>Liverpool 005A</td>
      <td>E01006654</td>
      <td>NHS Cheshire and Merseyside ICB - 99A</td>
      <td>E38000101</td>
      <td>SICBL</td>
      <td>England</td>
      <td>NHS Cheshire and Merseyside Integrated Care Board</td>
      <td>E54000008</td>
      <td>Cheshire and Merseyside</td>
      <td>1</td>
    </tr>
    <tr>
      <th>CH495PE</th>
      <td>Arrowe Park Hospital, Wirral</td>
      <td>AR</td>
      <td>Wirral Arrowe Park Hospital</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>nearest</td>
      <td>Wirral 025B</td>
      <td>E01007251</td>
      <td>NHS Cheshire and Merseyside ICB - 12F</td>
      <td>E38000208</td>
      <td>SICBL</td>
      <td>England</td>
      <td>NHS Cheshire and Merseyside Integrated Care Board</td>
      <td>E54000008</td>
      <td>Cheshire and Merseyside</td>
      <td>1</td>
    </tr>
    <tr>
      <th>BA13NG</th>
      <td>Royal United Hospital Bath</td>
      <td>BA</td>
      <td>Royal United Hospital Bath</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>nearest</td>
      <td>Bath and North East Somerset 008B</td>
      <td>E01014428</td>
      <td>NHS Bath and North East Somerset, Swindon and ...</td>
      <td>E38000231</td>
      <td>SICBL</td>
      <td>England</td>
      <td>NHS Bath and North East Somerset, Swindon and ...</td>
      <td>E54000040</td>
      <td>Gloucester, BSW, BNSSG and Somerset</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="find-lsoa-hospital-travel-time">
<h3>Find LSOA-hospital travel time<a class="headerlink" href="#find-lsoa-hospital-travel-time" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">travel_matrix</span> <span class="o">=</span> <span class="n">stroke_maps</span><span class="o">.</span><span class="n">load_data</span><span class="o">.</span><span class="n">travel_time_matrix_lsoa</span><span class="p">()</span>

<span class="c1"># Show the first five rows and columns:</span>
<span class="n">travel_matrix</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B152TH</th>
      <th>B714HJ</th>
      <th>B95SS</th>
      <th>BA13NG</th>
      <th>BA214AT</th>
    </tr>
    <tr>
      <th>LSOA</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Adur 001A</th>
      <td>173.3</td>
      <td>179.8</td>
      <td>171.2</td>
      <td>161.5</td>
      <td>152.9</td>
    </tr>
    <tr>
      <th>Adur 001B</th>
      <td>173.3</td>
      <td>179.8</td>
      <td>172.3</td>
      <td>161.5</td>
      <td>152.9</td>
    </tr>
    <tr>
      <th>Adur 001C</th>
      <td>173.3</td>
      <td>180.9</td>
      <td>172.3</td>
      <td>150.8</td>
      <td>151.9</td>
    </tr>
    <tr>
      <th>Adur 001D</th>
      <td>173.3</td>
      <td>180.9</td>
      <td>172.3</td>
      <td>161.5</td>
      <td>152.9</td>
    </tr>
    <tr>
      <th>Adur 001E</th>
      <td>174.4</td>
      <td>180.9</td>
      <td>173.3</td>
      <td>150.8</td>
      <td>151.9</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Limit LSOAs to England if required.</span>
<span class="c1"># Only keep LSOAs that are matched to the SICBL region type.</span>
<span class="c1"># SICBL are for England and LHB are for Wales.</span>
<span class="k">if</span> <span class="n">limit_to_england</span><span class="p">:</span>
    <span class="c1"># Load the LSOA-region lookup data:</span>
    <span class="n">df_lsoa_regions</span> <span class="o">=</span> <span class="n">stroke_maps</span><span class="o">.</span><span class="n">load_data</span><span class="o">.</span><span class="n">lsoa_region_lookup</span><span class="p">()</span>
    <span class="n">df_regions</span> <span class="o">=</span> <span class="n">stroke_maps</span><span class="o">.</span><span class="n">load_data</span><span class="o">.</span><span class="n">region_lookup</span><span class="p">()</span>
    
    <span class="c1"># Merge the ISDN names into the LSOA-region lookup:</span>
    <span class="n">df_lsoa_regions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
        <span class="n">df_lsoa_regions</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(),</span>
        <span class="n">df_regions</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()[[</span><span class="s1">&#39;region_code&#39;</span><span class="p">,</span> <span class="s1">&#39;isdn&#39;</span><span class="p">]],</span>
        <span class="n">on</span><span class="o">=</span><span class="s1">&#39;region_code&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span>
    <span class="p">)</span>
    <span class="c1"># Pick out the names of LSOA contained within SICBL:</span>
    <span class="n">england_lsoa</span> <span class="o">=</span> <span class="n">df_lsoa_regions</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_lsoa_regions</span><span class="p">[</span><span class="s1">&#39;region_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;SICBL&#39;</span><span class="p">,</span> <span class="s1">&#39;lsoa&#39;</span><span class="p">]</span>
    <span class="c1"># Limit the travel matrix to only those LSOA:</span>
    <span class="n">travel_matrix_mask</span> <span class="o">=</span> <span class="n">travel_matrix</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">england_lsoa</span><span class="p">)</span>
    <span class="n">travel_matrix</span> <span class="o">=</span> <span class="n">travel_matrix</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">travel_matrix_mask</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Identify closest IVT unit</span>
<span class="n">ivt_hospitals</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">hospitals</span><span class="p">[</span><span class="n">hospitals</span><span class="p">[</span><span class="s1">&#39;use_ivt&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">df_catchment_ivt</span> <span class="o">=</span> <span class="n">stroke_maps</span><span class="o">.</span><span class="n">catchment</span><span class="o">.</span><span class="n">find_nearest_unit</span><span class="p">(</span><span class="n">travel_matrix</span><span class="p">[</span><span class="n">ivt_hospitals</span><span class="p">])</span>

<span class="n">df_catchment_ivt</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>unit_travel_time</th>
      <th>unit_postcode</th>
    </tr>
    <tr>
      <th>LSOA</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Adur 001A</th>
      <td>17.6</td>
      <td>BN25BE</td>
    </tr>
    <tr>
      <th>Adur 001B</th>
      <td>18.7</td>
      <td>BN25BE</td>
    </tr>
    <tr>
      <th>Adur 001C</th>
      <td>17.6</td>
      <td>BN112DH</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Identify closest MT unit</span>
<span class="n">mt_hospitals</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">hospitals</span><span class="p">[</span><span class="n">hospitals</span><span class="p">[</span><span class="s1">&#39;use_mt&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">df_catchment_mt</span> <span class="o">=</span> <span class="n">stroke_maps</span><span class="o">.</span><span class="n">catchment</span><span class="o">.</span><span class="n">find_nearest_unit</span><span class="p">(</span><span class="n">travel_matrix</span><span class="p">[</span><span class="n">mt_hospitals</span><span class="p">])</span>

<span class="n">df_catchment_mt</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>unit_travel_time</th>
      <th>unit_postcode</th>
    </tr>
    <tr>
      <th>LSOA</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Adur 001A</th>
      <td>17.6</td>
      <td>BN25BE</td>
    </tr>
    <tr>
      <th>Adur 001B</th>
      <td>18.7</td>
      <td>BN25BE</td>
    </tr>
    <tr>
      <th>Adur 001C</th>
      <td>19.8</td>
      <td>BN25BE</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="find-inter-hospital-travel-time">
<h3>Find inter-hospital travel time<a class="headerlink" href="#find-inter-hospital-travel-time" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_transfer</span> <span class="o">=</span> <span class="n">stroke_maps</span><span class="o">.</span><span class="n">catchment</span><span class="o">.</span><span class="n">calculate_transfer_units</span><span class="p">(</span><span class="n">hospitals</span><span class="p">)</span>

<span class="n">df_transfer</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>transfer_unit_travel_time</th>
      <th>transfer_unit_postcode</th>
    </tr>
    <tr>
      <th>postcode</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>SY231ER</th>
      <td>135.8</td>
      <td>CF144XW</td>
    </tr>
    <tr>
      <th>CB20QQ</th>
      <td>0.0</td>
      <td>CB20QQ</td>
    </tr>
    <tr>
      <th>L97AL</th>
      <td>0.0</td>
      <td>L97AL</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="gather-travel-time-information">
<h3>Gather travel time information<a class="headerlink" href="#gather-travel-time-information" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Copy over IVT unit info:</span>
<span class="n">df_pathway</span> <span class="o">=</span> <span class="n">df_catchment_ivt</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_pathway</span> <span class="o">=</span> <span class="n">df_pathway</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;unit_travel_time&#39;</span><span class="p">:</span> <span class="s1">&#39;closest_ivt_time&#39;</span><span class="p">,</span>
    <span class="s1">&#39;unit_postcode&#39;</span><span class="p">:</span> <span class="s1">&#39;closest_ivt_unit&#39;</span>
<span class="p">})</span>

<span class="c1"># Merge in MT unit info:</span>
<span class="n">df_pathway</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">df_pathway</span><span class="p">,</span> <span class="n">df_catchment_mt</span><span class="p">,</span>
    <span class="n">left_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span>
<span class="p">)</span>
<span class="n">df_pathway</span> <span class="o">=</span> <span class="n">df_pathway</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;unit_travel_time&#39;</span><span class="p">:</span> <span class="s1">&#39;closest_mt_time&#39;</span><span class="p">,</span>
    <span class="s1">&#39;unit_postcode&#39;</span><span class="p">:</span> <span class="s1">&#39;closest_mt_unit&#39;</span>
<span class="p">})</span>

<span class="c1"># Merge in transfer unit info:</span>
<span class="n">df_pathway</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">df_pathway</span><span class="p">,</span> <span class="n">df_transfer</span><span class="p">,</span>
    <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;closest_ivt_unit&#39;</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span>
<span class="p">)</span>
<span class="n">df_pathway</span> <span class="o">=</span> <span class="n">df_pathway</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;transfer_unit_travel_time&#39;</span><span class="p">:</span> <span class="s1">&#39;transfer_mt_time&#39;</span><span class="p">,</span>
    <span class="s1">&#39;transfer_unit_postcode&#39;</span><span class="p">:</span> <span class="s1">&#39;transfer_mt_unit&#39;</span>
<span class="p">})</span>

<span class="c1"># Is a transfer required?</span>
<span class="n">df_pathway</span><span class="p">[</span><span class="s1">&#39;mt_transfer_required&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df_pathway</span><span class="p">[</span><span class="s1">&#39;closest_ivt_unit&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">df_pathway</span><span class="p">[</span><span class="s1">&#39;closest_mt_unit&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="add-on-stroke-pathway-timings">
<h3>Add on stroke pathway timings<a class="headerlink" href="#add-on-stroke-pathway-timings" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">onset_to_ambulance_arrival</span> <span class="o">=</span> <span class="mi">60</span>
<span class="n">arrival_to_ivt</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">arrival_to_mt</span> <span class="o">=</span> <span class="mi">90</span>
<span class="n">net_operational_delay_to_mt_for_transfer</span> <span class="o">=</span> <span class="mi">60</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Drip-and-ship:</span>
<span class="n">df_pathway</span><span class="p">[</span><span class="s1">&#39;ivt_drip_ship&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">onset_to_ambulance_arrival</span> <span class="o">+</span>
    <span class="n">df_pathway</span><span class="p">[</span><span class="s1">&#39;closest_ivt_time&#39;</span><span class="p">]</span> <span class="o">+</span>
    <span class="n">arrival_to_ivt</span>
<span class="p">)</span>
<span class="n">df_pathway</span><span class="p">[</span><span class="s1">&#39;mt_drip_ship&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>   
    <span class="n">onset_to_ambulance_arrival</span> <span class="o">+</span>
    <span class="n">df_pathway</span><span class="p">[</span><span class="s1">&#39;closest_ivt_time&#39;</span><span class="p">]</span> <span class="o">+</span> 
    <span class="c1"># The times in the following line are only added on if a transfer is required:</span>
    <span class="p">((</span><span class="n">net_operational_delay_to_mt_for_transfer</span> <span class="o">+</span> <span class="n">df_pathway</span><span class="p">[</span><span class="s1">&#39;transfer_mt_time&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="n">df_pathway</span><span class="p">[</span><span class="s1">&#39;mt_transfer_required&#39;</span><span class="p">])</span> <span class="o">+</span>
    <span class="n">arrival_to_mt</span>
<span class="p">)</span>

<span class="c1"># Mothership:</span>
<span class="n">df_pathway</span><span class="p">[</span><span class="s1">&#39;ivt_mothership&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">onset_to_ambulance_arrival</span> <span class="o">+</span>
    <span class="n">df_pathway</span><span class="p">[</span><span class="s1">&#39;closest_mt_time&#39;</span><span class="p">]</span> <span class="o">+</span>
    <span class="n">arrival_to_ivt</span>
<span class="p">)</span>
<span class="n">df_pathway</span><span class="p">[</span><span class="s1">&#39;mt_mothership&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">onset_to_ambulance_arrival</span> <span class="o">+</span>
    <span class="n">df_pathway</span><span class="p">[</span><span class="s1">&#39;closest_mt_time&#39;</span><span class="p">]</span> <span class="o">+</span>
    <span class="n">arrival_to_mt</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show df_pathway</span>
<span class="n">df_pathway</span><span class="o">.</span><span class="n">head</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>LSOA</th>
      <th>Adur 001A</th>
      <th>Adur 001B</th>
      <th>Adur 001C</th>
      <th>Adur 001D</th>
      <th>Adur 001E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>closest_ivt_time</th>
      <td>17.6</td>
      <td>18.7</td>
      <td>17.6</td>
      <td>17.6</td>
      <td>16.5</td>
    </tr>
    <tr>
      <th>closest_ivt_unit</th>
      <td>BN25BE</td>
      <td>BN25BE</td>
      <td>BN112DH</td>
      <td>BN112DH</td>
      <td>BN112DH</td>
    </tr>
    <tr>
      <th>closest_mt_time</th>
      <td>17.6</td>
      <td>18.7</td>
      <td>19.8</td>
      <td>19.8</td>
      <td>19.8</td>
    </tr>
    <tr>
      <th>closest_mt_unit</th>
      <td>BN25BE</td>
      <td>BN25BE</td>
      <td>BN25BE</td>
      <td>BN25BE</td>
      <td>BN25BE</td>
    </tr>
    <tr>
      <th>transfer_mt_time</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>31.6</td>
      <td>31.6</td>
      <td>31.6</td>
    </tr>
    <tr>
      <th>transfer_mt_unit</th>
      <td>BN25BE</td>
      <td>BN25BE</td>
      <td>BN25BE</td>
      <td>BN25BE</td>
      <td>BN25BE</td>
    </tr>
    <tr>
      <th>mt_transfer_required</th>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>ivt_drip_ship</th>
      <td>107.6</td>
      <td>108.7</td>
      <td>107.6</td>
      <td>107.6</td>
      <td>106.5</td>
    </tr>
    <tr>
      <th>mt_drip_ship</th>
      <td>167.6</td>
      <td>168.7</td>
      <td>259.2</td>
      <td>259.2</td>
      <td>258.1</td>
    </tr>
    <tr>
      <th>ivt_mothership</th>
      <td>107.6</td>
      <td>108.7</td>
      <td>109.8</td>
      <td>109.8</td>
      <td>109.8</td>
    </tr>
    <tr>
      <th>mt_mothership</th>
      <td>167.6</td>
      <td>168.7</td>
      <td>169.8</td>
      <td>169.8</td>
      <td>169.8</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="id1">
<h2>Calculate outcomes<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h2>
<p>Calculate the proportion mRS&lt;=2 in the no-treatment population.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mrs_dists</span><span class="p">,</span> <span class="n">mrs_dists_notes</span> <span class="o">=</span> <span class="n">stroke_outcome</span><span class="o">.</span><span class="n">outcome_utilities</span><span class="o">.</span><span class="n">import_mrs_dists_from_file</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mrs_dists</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mRS&lt;=0</th>
      <th>mRS&lt;=1</th>
      <th>mRS&lt;=2</th>
      <th>mRS&lt;=3</th>
      <th>mRS&lt;=4</th>
      <th>mRS&lt;=5</th>
      <th>mRS&lt;=6</th>
    </tr>
    <tr>
      <th>Stroke type</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>pre_stroke_nlvo</th>
      <td>0.583</td>
      <td>0.746</td>
      <td>0.850</td>
      <td>0.951</td>
      <td>0.993</td>
      <td>1.000</td>
      <td>1</td>
    </tr>
    <tr>
      <th>pre_stroke_lvo</th>
      <td>0.408</td>
      <td>0.552</td>
      <td>0.672</td>
      <td>0.838</td>
      <td>0.956</td>
      <td>1.000</td>
      <td>1</td>
    </tr>
    <tr>
      <th>no_treatment_lvo</th>
      <td>0.050</td>
      <td>0.129</td>
      <td>0.265</td>
      <td>0.429</td>
      <td>0.676</td>
      <td>0.811</td>
      <td>1</td>
    </tr>
    <tr>
      <th>no_treatment_nlvo</th>
      <td>0.198</td>
      <td>0.460</td>
      <td>0.580</td>
      <td>0.708</td>
      <td>0.856</td>
      <td>0.918</td>
      <td>1</td>
    </tr>
    <tr>
      <th>no_effect_nlvo_ivt_deaths</th>
      <td>0.196</td>
      <td>0.455</td>
      <td>0.574</td>
      <td>0.701</td>
      <td>0.847</td>
      <td>0.908</td>
      <td>1</td>
    </tr>
    <tr>
      <th>no_effect_lvo_ivt_deaths</th>
      <td>0.048</td>
      <td>0.124</td>
      <td>0.255</td>
      <td>0.414</td>
      <td>0.653</td>
      <td>0.783</td>
      <td>1</td>
    </tr>
    <tr>
      <th>no_effect_lvo_mt_deaths</th>
      <td>0.048</td>
      <td>0.124</td>
      <td>0.255</td>
      <td>0.412</td>
      <td>0.649</td>
      <td>0.779</td>
      <td>1</td>
    </tr>
    <tr>
      <th>t0_treatment_nlvo_ivt</th>
      <td>0.445</td>
      <td>0.642</td>
      <td>0.752</td>
      <td>0.862</td>
      <td>0.941</td>
      <td>0.967</td>
      <td>1</td>
    </tr>
    <tr>
      <th>t0_treatment_lvo_ivt</th>
      <td>0.140</td>
      <td>0.233</td>
      <td>0.361</td>
      <td>0.522</td>
      <td>0.730</td>
      <td>0.838</td>
      <td>1</td>
    </tr>
    <tr>
      <th>t0_treatment_lvo_mt</th>
      <td>0.306</td>
      <td>0.429</td>
      <td>0.548</td>
      <td>0.707</td>
      <td>0.851</td>
      <td>0.915</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">no_treatment_nlvo_mrsleq2</span> <span class="o">=</span> <span class="n">mrs_dists</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;no_treatment_nlvo&#39;</span><span class="p">,</span> <span class="s1">&#39;mRS&lt;=2&#39;</span><span class="p">]</span>
<span class="n">no_treatment_lvo_mrsleq2</span> <span class="o">=</span> <span class="n">mrs_dists</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;no_treatment_lvo&#39;</span><span class="p">,</span> <span class="s1">&#39;mRS&lt;=2&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up outcome model</span>
<span class="n">outcome_model</span> <span class="o">=</span> <span class="n">Continuous_outcome</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">patient_cohorts</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;nlvo_ivt&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;stroke_type_code&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;ivt_chosen_bool&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;mt_chosen_bool&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s1">&#39;lvo_ivt&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;stroke_type_code&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s1">&#39;ivt_chosen_bool&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;mt_chosen_bool&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s1">&#39;lvo_ivt_mt&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;stroke_type_code&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s1">&#39;ivt_chosen_bool&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;mt_chosen_bool&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s1">&#39;lvo_mt&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;stroke_type_code&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s1">&#39;ivt_chosen_bool&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;mt_chosen_bool&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_patients</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="c1"># Store averaged outcomes in here:</span>
<span class="n">df_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="c1"># Store mRS distributions in here:</span>
<span class="n">df_mrs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="k">for</span> <span class="n">model_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;drip_ship&#39;</span><span class="p">,</span> <span class="s1">&#39;mothership&#39;</span><span class="p">]:</span>
    <span class="n">df_patients</span><span class="p">[</span><span class="s1">&#39;onset_to_needle_mins&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_pathway</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;ivt_</span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span>
    <span class="n">df_patients</span><span class="p">[</span><span class="s1">&#39;onset_to_puncture_mins&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_pathway</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;mt_</span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span>

    <span class="c1"># df_results[f&#39;{model_name}_onset_to_needle_mins&#39;] = df_patients[&#39;onset_to_needle_mins&#39;].copy()</span>
    <span class="c1"># df_results[f&#39;{model_name}_onset_to_puncture_mins&#39;] = df_patients[&#39;onset_to_puncture_mins&#39;].copy()</span>
    
    <span class="k">for</span> <span class="n">cohort_name</span><span class="p">,</span> <span class="n">cohort_dict</span> <span class="ow">in</span> <span class="n">patient_cohorts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># Assign patient details:</span>
        <span class="n">df_patients</span><span class="p">[</span><span class="s1">&#39;stroke_type_code&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cohort_dict</span><span class="p">[</span><span class="s1">&#39;stroke_type_code&#39;</span><span class="p">]</span>
        <span class="n">df_patients</span><span class="p">[</span><span class="s1">&#39;ivt_chosen_bool&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cohort_dict</span><span class="p">[</span><span class="s1">&#39;ivt_chosen_bool&#39;</span><span class="p">]</span>
        <span class="n">df_patients</span><span class="p">[</span><span class="s1">&#39;mt_chosen_bool&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cohort_dict</span><span class="p">[</span><span class="s1">&#39;mt_chosen_bool&#39;</span><span class="p">]</span>
    
        <span class="c1"># Run outcomes:</span>
        <span class="n">outcome_model</span><span class="o">.</span><span class="n">assign_patients_to_trial</span><span class="p">(</span><span class="n">df_patients</span><span class="p">)</span>
        
        <span class="c1"># Calculate outcomes:</span>
        <span class="n">patient_data_dict</span><span class="p">,</span> <span class="n">outcomes_by_stroke_type</span><span class="p">,</span> <span class="n">full_cohort_outcomes</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">outcome_model</span><span class="o">.</span><span class="n">calculate_outcomes</span><span class="p">())</span>
        
        <span class="c1"># Make a copy of the results:</span>
        <span class="n">outcomes_by_stroke_type</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">outcomes_by_stroke_type</span><span class="p">)</span>
        <span class="n">full_cohort_outcomes</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">full_cohort_outcomes</span><span class="p">)</span>
        
        <span class="c1"># Place the relevant results into the results dataframe.</span>
        <span class="c1"># Round them to 5 decimal places which should be plenty.</span>
        <span class="n">df_results</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">cohort_name</span><span class="si">}</span><span class="s1">_added_utility&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span>
            <span class="n">full_cohort_outcomes</span><span class="p">[</span><span class="s1">&#39;each_patient_utility_shift&#39;</span><span class="p">],</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">df_results</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">cohort_name</span><span class="si">}</span><span class="s1">_mean_mrs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span>
            <span class="n">full_cohort_outcomes</span><span class="p">[</span><span class="s1">&#39;each_patient_mrs_post_stroke&#39;</span><span class="p">],</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">df_results</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">cohort_name</span><span class="si">}</span><span class="s1">_mrs_less_equal_2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span>
            <span class="n">full_cohort_outcomes</span><span class="p">[</span><span class="s1">&#39;each_patient_mrs_dist_post_stroke&#39;</span><span class="p">][:,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">df_results</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">cohort_name</span><span class="si">}</span><span class="s1">_mrs_shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span>
            <span class="n">full_cohort_outcomes</span><span class="p">[</span><span class="s1">&#39;each_patient_mrs_shift&#39;</span><span class="p">],</span> <span class="mi">5</span><span class="p">)</span>        

        <span class="c1"># Calculate the shift in the proportion mRS&lt;=2</span>
        <span class="c1"># compared with the no-treatment population.</span>
        <span class="k">if</span> <span class="n">cohort_dict</span><span class="p">[</span><span class="s1">&#39;stroke_type_code&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">no_treatment_mrsleq2</span> <span class="o">=</span> <span class="n">no_treatment_nlvo_mrsleq2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">no_treatment_mrsleq2</span> <span class="o">=</span> <span class="n">no_treatment_lvo_mrsleq2</span>

        <span class="c1"># Round the results again to avoid floating point errors.</span>
        <span class="n">df_results</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">cohort_name</span><span class="si">}</span><span class="s1">_added_mrs_less_equal_2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">((</span>
                <span class="n">df_results</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">cohort_name</span><span class="si">}</span><span class="s1">_mrs_less_equal_2&#39;</span><span class="p">]</span> <span class="o">-</span>
                <span class="n">no_treatment_mrsleq2</span>
            <span class="p">),</span> <span class="mi">5</span><span class="p">))</span>

        <span class="c1"># Copy over the mRS distributions:</span>
        <span class="c1"># # One list of mRS values per row (patient) in the data.</span>
        <span class="n">outs</span> <span class="o">=</span> <span class="n">full_cohort_outcomes</span><span class="p">[</span><span class="s1">&#39;each_patient_mrs_dist_post_stroke&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">outs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">outs</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">df_mrs</span><span class="p">[[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">cohort_name</span><span class="si">}</span><span class="s1">_mrs_dists_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">)]]</span> <span class="o">=</span> <span class="n">outs</span>
</pre></div>
</div>
</div>
</div>
<p>Merge the outcome results into the travel time dataframe:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_results</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">df_pathway</span><span class="o">.</span><span class="n">index</span>
<span class="n">df_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">df_pathway</span><span class="p">,</span> <span class="n">df_results</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_results</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>LSOA</th>
      <th>Adur 001A</th>
      <th>Adur 001B</th>
      <th>Adur 001C</th>
      <th>Adur 001D</th>
      <th>Adur 001E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>closest_ivt_time</th>
      <td>17.6</td>
      <td>18.7</td>
      <td>17.6</td>
      <td>17.6</td>
      <td>16.5</td>
    </tr>
    <tr>
      <th>closest_ivt_unit</th>
      <td>BN25BE</td>
      <td>BN25BE</td>
      <td>BN112DH</td>
      <td>BN112DH</td>
      <td>BN112DH</td>
    </tr>
    <tr>
      <th>closest_mt_time</th>
      <td>17.6</td>
      <td>18.7</td>
      <td>19.8</td>
      <td>19.8</td>
      <td>19.8</td>
    </tr>
    <tr>
      <th>closest_mt_unit</th>
      <td>BN25BE</td>
      <td>BN25BE</td>
      <td>BN25BE</td>
      <td>BN25BE</td>
      <td>BN25BE</td>
    </tr>
    <tr>
      <th>transfer_mt_time</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>31.6</td>
      <td>31.6</td>
      <td>31.6</td>
    </tr>
    <tr>
      <th>transfer_mt_unit</th>
      <td>BN25BE</td>
      <td>BN25BE</td>
      <td>BN25BE</td>
      <td>BN25BE</td>
      <td>BN25BE</td>
    </tr>
    <tr>
      <th>mt_transfer_required</th>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>ivt_drip_ship</th>
      <td>107.6</td>
      <td>108.7</td>
      <td>107.6</td>
      <td>107.6</td>
      <td>106.5</td>
    </tr>
    <tr>
      <th>mt_drip_ship</th>
      <td>167.6</td>
      <td>168.7</td>
      <td>259.2</td>
      <td>259.2</td>
      <td>258.1</td>
    </tr>
    <tr>
      <th>ivt_mothership</th>
      <td>107.6</td>
      <td>108.7</td>
      <td>109.8</td>
      <td>109.8</td>
      <td>109.8</td>
    </tr>
    <tr>
      <th>mt_mothership</th>
      <td>167.6</td>
      <td>168.7</td>
      <td>169.8</td>
      <td>169.8</td>
      <td>169.8</td>
    </tr>
    <tr>
      <th>drip_ship_nlvo_ivt_added_utility</th>
      <td>0.11685</td>
      <td>0.11641</td>
      <td>0.11685</td>
      <td>0.11685</td>
      <td>0.1173</td>
    </tr>
    <tr>
      <th>drip_ship_nlvo_ivt_mean_mrs</th>
      <td>1.63653</td>
      <td>1.63913</td>
      <td>1.63653</td>
      <td>1.63653</td>
      <td>1.63394</td>
    </tr>
    <tr>
      <th>drip_ship_nlvo_ivt_mrs_less_equal_2</th>
      <td>0.70649</td>
      <td>0.706</td>
      <td>0.70649</td>
      <td>0.70649</td>
      <td>0.70698</td>
    </tr>
    <tr>
      <th>drip_ship_nlvo_ivt_mrs_shift</th>
      <td>-0.64347</td>
      <td>-0.64087</td>
      <td>-0.64347</td>
      <td>-0.64347</td>
      <td>-0.64606</td>
    </tr>
    <tr>
      <th>drip_ship_nlvo_ivt_added_mrs_less_equal_2</th>
      <td>0.12649</td>
      <td>0.126</td>
      <td>0.12649</td>
      <td>0.12649</td>
      <td>0.12698</td>
    </tr>
    <tr>
      <th>drip_ship_lvo_ivt_added_utility</th>
      <td>0.05872</td>
      <td>0.05841</td>
      <td>0.05872</td>
      <td>0.05872</td>
      <td>0.05902</td>
    </tr>
    <tr>
      <th>drip_ship_lvo_ivt_mean_mrs</th>
      <td>3.34655</td>
      <td>3.34823</td>
      <td>3.34655</td>
      <td>3.34655</td>
      <td>3.34487</td>
    </tr>
    <tr>
      <th>drip_ship_lvo_ivt_mrs_less_equal_2</th>
      <td>0.32879</td>
      <td>0.32847</td>
      <td>0.32879</td>
      <td>0.32879</td>
      <td>0.32911</td>
    </tr>
    <tr>
      <th>drip_ship_lvo_ivt_mrs_shift</th>
      <td>-0.29345</td>
      <td>-0.29177</td>
      <td>-0.29345</td>
      <td>-0.29345</td>
      <td>-0.29513</td>
    </tr>
    <tr>
      <th>drip_ship_lvo_ivt_added_mrs_less_equal_2</th>
      <td>0.06379</td>
      <td>0.06347</td>
      <td>0.06379</td>
      <td>0.06379</td>
      <td>0.06411</td>
    </tr>
    <tr>
      <th>drip_ship_lvo_ivt_mt_added_utility</th>
      <td>0.16361</td>
      <td>0.16295</td>
      <td>0.10928</td>
      <td>0.10928</td>
      <td>0.10992</td>
    </tr>
    <tr>
      <th>drip_ship_lvo_ivt_mt_mean_mrs</th>
      <td>2.81136</td>
      <td>2.81494</td>
      <td>3.10174</td>
      <td>3.10174</td>
      <td>3.09835</td>
    </tr>
    <tr>
      <th>drip_ship_lvo_ivt_mt_mrs_less_equal_2</th>
      <td>0.43807</td>
      <td>0.43736</td>
      <td>0.37981</td>
      <td>0.37981</td>
      <td>0.38049</td>
    </tr>
    <tr>
      <th>drip_ship_lvo_ivt_mt_mrs_shift</th>
      <td>-0.82864</td>
      <td>-0.82506</td>
      <td>-0.53826</td>
      <td>-0.53826</td>
      <td>-0.54165</td>
    </tr>
    <tr>
      <th>drip_ship_lvo_ivt_mt_added_mrs_less_equal_2</th>
      <td>0.17307</td>
      <td>0.17236</td>
      <td>0.11481</td>
      <td>0.11481</td>
      <td>0.11549</td>
    </tr>
    <tr>
      <th>drip_ship_lvo_mt_added_utility</th>
      <td>0.16361</td>
      <td>0.16295</td>
      <td>0.10928</td>
      <td>0.10928</td>
      <td>0.10992</td>
    </tr>
    <tr>
      <th>drip_ship_lvo_mt_mean_mrs</th>
      <td>2.81136</td>
      <td>2.81494</td>
      <td>3.10174</td>
      <td>3.10174</td>
      <td>3.09835</td>
    </tr>
    <tr>
      <th>drip_ship_lvo_mt_mrs_less_equal_2</th>
      <td>0.43807</td>
      <td>0.43736</td>
      <td>0.37981</td>
      <td>0.37981</td>
      <td>0.38049</td>
    </tr>
    <tr>
      <th>drip_ship_lvo_mt_mrs_shift</th>
      <td>-0.82864</td>
      <td>-0.82506</td>
      <td>-0.53826</td>
      <td>-0.53826</td>
      <td>-0.54165</td>
    </tr>
    <tr>
      <th>drip_ship_lvo_mt_added_mrs_less_equal_2</th>
      <td>0.17307</td>
      <td>0.17236</td>
      <td>0.11481</td>
      <td>0.11481</td>
      <td>0.11549</td>
    </tr>
    <tr>
      <th>mothership_nlvo_ivt_added_utility</th>
      <td>0.11685</td>
      <td>0.11641</td>
      <td>0.11596</td>
      <td>0.11596</td>
      <td>0.11596</td>
    </tr>
    <tr>
      <th>mothership_nlvo_ivt_mean_mrs</th>
      <td>1.63653</td>
      <td>1.63913</td>
      <td>1.64173</td>
      <td>1.64173</td>
      <td>1.64173</td>
    </tr>
    <tr>
      <th>mothership_nlvo_ivt_mrs_less_equal_2</th>
      <td>0.70649</td>
      <td>0.706</td>
      <td>0.70551</td>
      <td>0.70551</td>
      <td>0.70551</td>
    </tr>
    <tr>
      <th>mothership_nlvo_ivt_mrs_shift</th>
      <td>-0.64347</td>
      <td>-0.64087</td>
      <td>-0.63827</td>
      <td>-0.63827</td>
      <td>-0.63827</td>
    </tr>
    <tr>
      <th>mothership_nlvo_ivt_added_mrs_less_equal_2</th>
      <td>0.12649</td>
      <td>0.126</td>
      <td>0.12551</td>
      <td>0.12551</td>
      <td>0.12551</td>
    </tr>
    <tr>
      <th>mothership_lvo_ivt_added_utility</th>
      <td>0.05872</td>
      <td>0.05841</td>
      <td>0.05811</td>
      <td>0.05811</td>
      <td>0.05811</td>
    </tr>
    <tr>
      <th>mothership_lvo_ivt_mean_mrs</th>
      <td>3.34655</td>
      <td>3.34823</td>
      <td>3.3499</td>
      <td>3.3499</td>
      <td>3.3499</td>
    </tr>
    <tr>
      <th>mothership_lvo_ivt_mrs_less_equal_2</th>
      <td>0.32879</td>
      <td>0.32847</td>
      <td>0.32815</td>
      <td>0.32815</td>
      <td>0.32815</td>
    </tr>
    <tr>
      <th>mothership_lvo_ivt_mrs_shift</th>
      <td>-0.29345</td>
      <td>-0.29177</td>
      <td>-0.2901</td>
      <td>-0.2901</td>
      <td>-0.2901</td>
    </tr>
    <tr>
      <th>mothership_lvo_ivt_added_mrs_less_equal_2</th>
      <td>0.06379</td>
      <td>0.06347</td>
      <td>0.06315</td>
      <td>0.06315</td>
      <td>0.06315</td>
    </tr>
    <tr>
      <th>mothership_lvo_ivt_mt_added_utility</th>
      <td>0.16361</td>
      <td>0.16295</td>
      <td>0.16229</td>
      <td>0.16229</td>
      <td>0.16229</td>
    </tr>
    <tr>
      <th>mothership_lvo_ivt_mt_mean_mrs</th>
      <td>2.81136</td>
      <td>2.81494</td>
      <td>2.81852</td>
      <td>2.81852</td>
      <td>2.81852</td>
    </tr>
    <tr>
      <th>mothership_lvo_ivt_mt_mrs_less_equal_2</th>
      <td>0.43807</td>
      <td>0.43736</td>
      <td>0.43664</td>
      <td>0.43664</td>
      <td>0.43664</td>
    </tr>
    <tr>
      <th>mothership_lvo_ivt_mt_mrs_shift</th>
      <td>-0.82864</td>
      <td>-0.82506</td>
      <td>-0.82148</td>
      <td>-0.82148</td>
      <td>-0.82148</td>
    </tr>
    <tr>
      <th>mothership_lvo_ivt_mt_added_mrs_less_equal_2</th>
      <td>0.17307</td>
      <td>0.17236</td>
      <td>0.17164</td>
      <td>0.17164</td>
      <td>0.17164</td>
    </tr>
    <tr>
      <th>mothership_lvo_mt_added_utility</th>
      <td>0.16361</td>
      <td>0.16295</td>
      <td>0.16229</td>
      <td>0.16229</td>
      <td>0.16229</td>
    </tr>
    <tr>
      <th>mothership_lvo_mt_mean_mrs</th>
      <td>2.81136</td>
      <td>2.81494</td>
      <td>2.81852</td>
      <td>2.81852</td>
      <td>2.81852</td>
    </tr>
    <tr>
      <th>mothership_lvo_mt_mrs_less_equal_2</th>
      <td>0.43807</td>
      <td>0.43736</td>
      <td>0.43664</td>
      <td>0.43664</td>
      <td>0.43664</td>
    </tr>
    <tr>
      <th>mothership_lvo_mt_mrs_shift</th>
      <td>-0.82864</td>
      <td>-0.82506</td>
      <td>-0.82148</td>
      <td>-0.82148</td>
      <td>-0.82148</td>
    </tr>
    <tr>
      <th>mothership_lvo_mt_added_mrs_less_equal_2</th>
      <td>0.17307</td>
      <td>0.17236</td>
      <td>0.17164</td>
      <td>0.17164</td>
      <td>0.17164</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_mrs</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">df_pathway</span><span class="o">.</span><span class="n">index</span>
<span class="n">df_mrs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">df_pathway</span><span class="p">,</span> <span class="n">df_mrs</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_mrs</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>LSOA</th>
      <th>Adur 001A</th>
      <th>Adur 001B</th>
      <th>Adur 001C</th>
      <th>Adur 001D</th>
      <th>Adur 001E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>closest_ivt_time</th>
      <td>17.6</td>
      <td>18.7</td>
      <td>17.6</td>
      <td>17.6</td>
      <td>16.5</td>
    </tr>
    <tr>
      <th>closest_ivt_unit</th>
      <td>BN25BE</td>
      <td>BN25BE</td>
      <td>BN112DH</td>
      <td>BN112DH</td>
      <td>BN112DH</td>
    </tr>
    <tr>
      <th>closest_mt_time</th>
      <td>17.6</td>
      <td>18.7</td>
      <td>19.8</td>
      <td>19.8</td>
      <td>19.8</td>
    </tr>
    <tr>
      <th>closest_mt_unit</th>
      <td>BN25BE</td>
      <td>BN25BE</td>
      <td>BN25BE</td>
      <td>BN25BE</td>
      <td>BN25BE</td>
    </tr>
    <tr>
      <th>transfer_mt_time</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>31.6</td>
      <td>31.6</td>
      <td>31.6</td>
    </tr>
    <tr>
      <th>transfer_mt_unit</th>
      <td>BN25BE</td>
      <td>BN25BE</td>
      <td>BN25BE</td>
      <td>BN25BE</td>
      <td>BN25BE</td>
    </tr>
    <tr>
      <th>mt_transfer_required</th>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>ivt_drip_ship</th>
      <td>107.6</td>
      <td>108.7</td>
      <td>107.6</td>
      <td>107.6</td>
      <td>106.5</td>
    </tr>
    <tr>
      <th>mt_drip_ship</th>
      <td>167.6</td>
      <td>168.7</td>
      <td>259.2</td>
      <td>259.2</td>
      <td>258.1</td>
    </tr>
    <tr>
      <th>ivt_mothership</th>
      <td>107.6</td>
      <td>108.7</td>
      <td>109.8</td>
      <td>109.8</td>
      <td>109.8</td>
    </tr>
    <tr>
      <th>mt_mothership</th>
      <td>167.6</td>
      <td>168.7</td>
      <td>169.8</td>
      <td>169.8</td>
      <td>169.8</td>
    </tr>
    <tr>
      <th>drip_ship_nlvo_ivt_mrs_dists_0</th>
      <td>0.36359</td>
      <td>0.36279</td>
      <td>0.36359</td>
      <td>0.36359</td>
      <td>0.3644</td>
    </tr>
    <tr>
      <th>drip_ship_nlvo_ivt_mrs_dists_1</th>
      <td>0.59059</td>
      <td>0.59006</td>
      <td>0.59059</td>
      <td>0.59059</td>
      <td>0.59113</td>
    </tr>
    <tr>
      <th>drip_ship_nlvo_ivt_mrs_dists_2</th>
      <td>0.70649</td>
      <td>0.706</td>
      <td>0.70649</td>
      <td>0.70649</td>
      <td>0.70698</td>
    </tr>
    <tr>
      <th>drip_ship_nlvo_ivt_mrs_dists_3</th>
      <td>0.82535</td>
      <td>0.82494</td>
      <td>0.82535</td>
      <td>0.82535</td>
      <td>0.82577</td>
    </tr>
    <tr>
      <th>drip_ship_nlvo_ivt_mrs_dists_4</th>
      <td>0.92188</td>
      <td>0.92166</td>
      <td>0.92188</td>
      <td>0.92188</td>
      <td>0.9221</td>
    </tr>
    <tr>
      <th>drip_ship_nlvo_ivt_mrs_dists_5</th>
      <td>0.95555</td>
      <td>0.95542</td>
      <td>0.95555</td>
      <td>0.95555</td>
      <td>0.95568</td>
    </tr>
    <tr>
      <th>drip_ship_nlvo_ivt_mrs_dists_6</th>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>drip_ship_lvo_ivt_mrs_dists_0</th>
      <td>0.10443</td>
      <td>0.10411</td>
      <td>0.10443</td>
      <td>0.10443</td>
      <td>0.10475</td>
    </tr>
    <tr>
      <th>drip_ship_lvo_ivt_mrs_dists_1</th>
      <td>0.19642</td>
      <td>0.19607</td>
      <td>0.19642</td>
      <td>0.19642</td>
      <td>0.19677</td>
    </tr>
    <tr>
      <th>drip_ship_lvo_ivt_mrs_dists_2</th>
      <td>0.32879</td>
      <td>0.32847</td>
      <td>0.32879</td>
      <td>0.32879</td>
      <td>0.32911</td>
    </tr>
    <tr>
      <th>drip_ship_lvo_ivt_mrs_dists_3</th>
      <td>0.49102</td>
      <td>0.49071</td>
      <td>0.49102</td>
      <td>0.49102</td>
      <td>0.49134</td>
    </tr>
    <tr>
      <th>drip_ship_lvo_ivt_mrs_dists_4</th>
      <td>0.70919</td>
      <td>0.70898</td>
      <td>0.70919</td>
      <td>0.70919</td>
      <td>0.70941</td>
    </tr>
    <tr>
      <th>drip_ship_lvo_ivt_mrs_dists_5</th>
      <td>0.82359</td>
      <td>0.82344</td>
      <td>0.82359</td>
      <td>0.82359</td>
      <td>0.82375</td>
    </tr>
    <tr>
      <th>drip_ship_lvo_ivt_mrs_dists_6</th>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>drip_ship_lvo_ivt_mt_mrs_dists_0</th>
      <td>0.17136</td>
      <td>0.17065</td>
      <td>0.12027</td>
      <td>0.12027</td>
      <td>0.1208</td>
    </tr>
    <tr>
      <th>drip_ship_lvo_ivt_mt_mrs_dists_1</th>
      <td>0.29552</td>
      <td>0.29472</td>
      <td>0.23375</td>
      <td>0.23375</td>
      <td>0.23443</td>
    </tr>
    <tr>
      <th>drip_ship_lvo_ivt_mt_mrs_dists_2</th>
      <td>0.43807</td>
      <td>0.43736</td>
      <td>0.37981</td>
      <td>0.37981</td>
      <td>0.38049</td>
    </tr>
    <tr>
      <th>drip_ship_lvo_ivt_mt_mrs_dists_3</th>
      <td>0.61042</td>
      <td>0.60975</td>
      <td>0.55308</td>
      <td>0.55308</td>
      <td>0.55378</td>
    </tr>
    <tr>
      <th>drip_ship_lvo_ivt_mt_mrs_dists_4</th>
      <td>0.79391</td>
      <td>0.79349</td>
      <td>0.75647</td>
      <td>0.75647</td>
      <td>0.75695</td>
    </tr>
    <tr>
      <th>drip_ship_lvo_ivt_mt_mrs_dists_5</th>
      <td>0.87937</td>
      <td>0.8791</td>
      <td>0.85488</td>
      <td>0.85488</td>
      <td>0.8552</td>
    </tr>
    <tr>
      <th>drip_ship_lvo_ivt_mt_mrs_dists_6</th>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>drip_ship_lvo_mt_mrs_dists_0</th>
      <td>0.17136</td>
      <td>0.17065</td>
      <td>0.12027</td>
      <td>0.12027</td>
      <td>0.1208</td>
    </tr>
    <tr>
      <th>drip_ship_lvo_mt_mrs_dists_1</th>
      <td>0.29552</td>
      <td>0.29472</td>
      <td>0.23375</td>
      <td>0.23375</td>
      <td>0.23443</td>
    </tr>
    <tr>
      <th>drip_ship_lvo_mt_mrs_dists_2</th>
      <td>0.43807</td>
      <td>0.43736</td>
      <td>0.37981</td>
      <td>0.37981</td>
      <td>0.38049</td>
    </tr>
    <tr>
      <th>drip_ship_lvo_mt_mrs_dists_3</th>
      <td>0.61042</td>
      <td>0.60975</td>
      <td>0.55308</td>
      <td>0.55308</td>
      <td>0.55378</td>
    </tr>
    <tr>
      <th>drip_ship_lvo_mt_mrs_dists_4</th>
      <td>0.79391</td>
      <td>0.79349</td>
      <td>0.75647</td>
      <td>0.75647</td>
      <td>0.75695</td>
    </tr>
    <tr>
      <th>drip_ship_lvo_mt_mrs_dists_5</th>
      <td>0.87937</td>
      <td>0.8791</td>
      <td>0.85488</td>
      <td>0.85488</td>
      <td>0.8552</td>
    </tr>
    <tr>
      <th>drip_ship_lvo_mt_mrs_dists_6</th>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>mothership_nlvo_ivt_mrs_dists_0</th>
      <td>0.36359</td>
      <td>0.36279</td>
      <td>0.36199</td>
      <td>0.36199</td>
      <td>0.36199</td>
    </tr>
    <tr>
      <th>mothership_nlvo_ivt_mrs_dists_1</th>
      <td>0.59059</td>
      <td>0.59006</td>
      <td>0.58952</td>
      <td>0.58952</td>
      <td>0.58952</td>
    </tr>
    <tr>
      <th>mothership_nlvo_ivt_mrs_dists_2</th>
      <td>0.70649</td>
      <td>0.706</td>
      <td>0.70551</td>
      <td>0.70551</td>
      <td>0.70551</td>
    </tr>
    <tr>
      <th>mothership_nlvo_ivt_mrs_dists_3</th>
      <td>0.82535</td>
      <td>0.82494</td>
      <td>0.82453</td>
      <td>0.82453</td>
      <td>0.82453</td>
    </tr>
    <tr>
      <th>mothership_nlvo_ivt_mrs_dists_4</th>
      <td>0.92188</td>
      <td>0.92166</td>
      <td>0.92144</td>
      <td>0.92144</td>
      <td>0.92144</td>
    </tr>
    <tr>
      <th>mothership_nlvo_ivt_mrs_dists_5</th>
      <td>0.95555</td>
      <td>0.95542</td>
      <td>0.95528</td>
      <td>0.95528</td>
      <td>0.95528</td>
    </tr>
    <tr>
      <th>mothership_nlvo_ivt_mrs_dists_6</th>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>mothership_lvo_ivt_mrs_dists_0</th>
      <td>0.10443</td>
      <td>0.10411</td>
      <td>0.1038</td>
      <td>0.1038</td>
      <td>0.1038</td>
    </tr>
    <tr>
      <th>mothership_lvo_ivt_mrs_dists_1</th>
      <td>0.19642</td>
      <td>0.19607</td>
      <td>0.19572</td>
      <td>0.19572</td>
      <td>0.19572</td>
    </tr>
    <tr>
      <th>mothership_lvo_ivt_mrs_dists_2</th>
      <td>0.32879</td>
      <td>0.32847</td>
      <td>0.32815</td>
      <td>0.32815</td>
      <td>0.32815</td>
    </tr>
    <tr>
      <th>mothership_lvo_ivt_mrs_dists_3</th>
      <td>0.49102</td>
      <td>0.49071</td>
      <td>0.49039</td>
      <td>0.49039</td>
      <td>0.49039</td>
    </tr>
    <tr>
      <th>mothership_lvo_ivt_mrs_dists_4</th>
      <td>0.70919</td>
      <td>0.70898</td>
      <td>0.70876</td>
      <td>0.70876</td>
      <td>0.70876</td>
    </tr>
    <tr>
      <th>mothership_lvo_ivt_mrs_dists_5</th>
      <td>0.82359</td>
      <td>0.82344</td>
      <td>0.82329</td>
      <td>0.82329</td>
      <td>0.82329</td>
    </tr>
    <tr>
      <th>mothership_lvo_ivt_mrs_dists_6</th>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>mothership_lvo_ivt_mt_mrs_dists_0</th>
      <td>0.17136</td>
      <td>0.17065</td>
      <td>0.16995</td>
      <td>0.16995</td>
      <td>0.16995</td>
    </tr>
    <tr>
      <th>mothership_lvo_ivt_mt_mrs_dists_1</th>
      <td>0.29552</td>
      <td>0.29472</td>
      <td>0.29393</td>
      <td>0.29393</td>
      <td>0.29393</td>
    </tr>
    <tr>
      <th>mothership_lvo_ivt_mt_mrs_dists_2</th>
      <td>0.43807</td>
      <td>0.43736</td>
      <td>0.43664</td>
      <td>0.43664</td>
      <td>0.43664</td>
    </tr>
    <tr>
      <th>mothership_lvo_ivt_mt_mrs_dists_3</th>
      <td>0.61042</td>
      <td>0.60975</td>
      <td>0.60907</td>
      <td>0.60907</td>
      <td>0.60907</td>
    </tr>
    <tr>
      <th>mothership_lvo_ivt_mt_mrs_dists_4</th>
      <td>0.79391</td>
      <td>0.79349</td>
      <td>0.79306</td>
      <td>0.79306</td>
      <td>0.79306</td>
    </tr>
    <tr>
      <th>mothership_lvo_ivt_mt_mrs_dists_5</th>
      <td>0.87937</td>
      <td>0.8791</td>
      <td>0.87882</td>
      <td>0.87882</td>
      <td>0.87882</td>
    </tr>
    <tr>
      <th>mothership_lvo_ivt_mt_mrs_dists_6</th>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>mothership_lvo_mt_mrs_dists_0</th>
      <td>0.17136</td>
      <td>0.17065</td>
      <td>0.16995</td>
      <td>0.16995</td>
      <td>0.16995</td>
    </tr>
    <tr>
      <th>mothership_lvo_mt_mrs_dists_1</th>
      <td>0.29552</td>
      <td>0.29472</td>
      <td>0.29393</td>
      <td>0.29393</td>
      <td>0.29393</td>
    </tr>
    <tr>
      <th>mothership_lvo_mt_mrs_dists_2</th>
      <td>0.43807</td>
      <td>0.43736</td>
      <td>0.43664</td>
      <td>0.43664</td>
      <td>0.43664</td>
    </tr>
    <tr>
      <th>mothership_lvo_mt_mrs_dists_3</th>
      <td>0.61042</td>
      <td>0.60975</td>
      <td>0.60907</td>
      <td>0.60907</td>
      <td>0.60907</td>
    </tr>
    <tr>
      <th>mothership_lvo_mt_mrs_dists_4</th>
      <td>0.79391</td>
      <td>0.79349</td>
      <td>0.79306</td>
      <td>0.79306</td>
      <td>0.79306</td>
    </tr>
    <tr>
      <th>mothership_lvo_mt_mrs_dists_5</th>
      <td>0.87937</td>
      <td>0.8791</td>
      <td>0.87882</td>
      <td>0.87882</td>
      <td>0.87882</td>
    </tr>
    <tr>
      <th>mothership_lvo_mt_mrs_dists_6</th>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="save-results-to-file">
<h3>Save results to file<a class="headerlink" href="#save-results-to-file" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_results</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_output</span><span class="p">,</span> <span class="s1">&#39;cohort_outcomes.csv&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_mrs</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_output</span><span class="p">,</span> <span class="s1">&#39;cohort_mrs_dists.csv&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Calculate summary stats for the outcomes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">summary</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">df_results</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">summary</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_output</span><span class="p">,</span> <span class="s1">&#39;cohort_outcomes_summary.csv&#39;</span><span class="p">),</span> <span class="n">index_label</span><span class="o">=</span><span class="s1">&#39;lsoa&#39;</span><span class="p">)</span>
<span class="n">summary</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>closest_ivt_time                                 19.54818
closest_mt_time                                  34.93931
transfer_mt_time                                 27.50945
mt_transfer_required                              0.67510
ivt_drip_ship                                   109.54818
mt_drip_ship                                    237.56350
ivt_mothership                                  124.93931
mt_mothership                                   184.93931
drip_ship_nlvo_ivt_added_utility                  0.11605
drip_ship_nlvo_ivt_mean_mrs                       1.64118
drip_ship_nlvo_ivt_mrs_less_equal_2               0.70561
drip_ship_nlvo_ivt_mrs_shift                     -0.63882
drip_ship_nlvo_ivt_added_mrs_less_equal_2         0.12561
drip_ship_lvo_ivt_added_utility                   0.05818
drip_ship_lvo_ivt_mean_mrs                        3.34948
drip_ship_lvo_ivt_mrs_less_equal_2                0.32822
drip_ship_lvo_ivt_mrs_shift                      -0.29052
drip_ship_lvo_ivt_added_mrs_less_equal_2          0.06322
drip_ship_lvo_ivt_mt_added_utility                0.12224
drip_ship_lvo_ivt_mt_mean_mrs                     3.03180
drip_ship_lvo_ivt_mt_mrs_less_equal_2             0.39381
drip_ship_lvo_ivt_mt_mrs_shift                   -0.60820
drip_ship_lvo_ivt_mt_added_mrs_less_equal_2       0.12881
drip_ship_lvo_mt_added_utility                    0.12223
drip_ship_lvo_mt_mean_mrs                         3.03199
drip_ship_lvo_mt_mrs_less_equal_2                 0.39379
drip_ship_lvo_mt_mrs_shift                       -0.60801
drip_ship_lvo_mt_added_mrs_less_equal_2           0.12879
mothership_nlvo_ivt_added_utility                 0.10969
mothership_nlvo_ivt_mean_mrs                      1.67795
mothership_nlvo_ivt_mrs_less_equal_2              0.69864
mothership_nlvo_ivt_mrs_shift                    -0.60205
mothership_nlvo_ivt_added_mrs_less_equal_2        0.11864
mothership_lvo_ivt_added_utility                  0.05395
mothership_lvo_ivt_mean_mrs                       3.37261
mothership_lvo_ivt_mrs_less_equal_2               0.32377
mothership_lvo_ivt_mrs_shift                     -0.26739
mothership_lvo_ivt_added_mrs_less_equal_2         0.05877
mothership_lvo_ivt_mt_added_utility               0.15326
mothership_lvo_ivt_mt_mean_mrs                    2.86715
mothership_lvo_ivt_mt_mrs_less_equal_2            0.42692
mothership_lvo_ivt_mt_mrs_shift                  -0.77285
mothership_lvo_ivt_mt_added_mrs_less_equal_2      0.16192
mothership_lvo_mt_added_utility                   0.15326
mothership_lvo_mt_mean_mrs                        2.86715
mothership_lvo_mt_mrs_less_equal_2                0.42692
mothership_lvo_mt_mrs_shift                      -0.77285
mothership_lvo_mt_added_mrs_less_equal_2          0.16192
dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this heading">#</a></h2>
<p>We have calculated all of the outcome data for the separate cohorts and for both the drip-and-ship and mothership scenarios.</p>
<p>The next notebooks combine the cohorts to find the average results for a mixed population.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./england_wales"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../admission_prediction/01_msoa_regression.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Emergency stroke admissions predictions</p>
      </div>
    </a>
    <a class="right-next"
       href="01c_weighted_outcomes.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Combine populations for weighted outcomes</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plain-english-summary">Plain English summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aims">Aims</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#method">Method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-packages">Load packages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#global-variables-to-use">Global variables to use</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-and-parse-data">Load and parse data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#load-and-parse-hospital-data">Load and parse hospital data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#find-lsoa-hospital-travel-time">Find LSOA-hospital travel time</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#find-inter-hospital-travel-time">Find inter-hospital travel time</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gather-travel-time-information">Gather travel time information</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#add-on-stroke-pathway-timings">Add on stroke pathway timings</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Calculate outcomes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#save-results-to-file">Save results to file</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Anna Laws, Kerry Pearn, Michael Allen, Peter McMeekin, and Martin James
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      ¬© Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=c5ced968eda925caa686"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=c5ced968eda925caa686"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>