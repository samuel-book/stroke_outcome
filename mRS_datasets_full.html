
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Defining modified Rankin Scale (mRS) probability distributions for untreated patients, and predicted distributions if treatment given at time of stroke onset &#8212; Stroke outcome modelling</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Mathematics for calculating odds and probabilities of mRS-level outcomes after stroke, based on time to reperfusion treatment" href="mRS_outcomes_maths.html" />
    <link rel="prev" title="Predicting granular disability outcomes after treatment of stroke with thrombolysis (IVT) or thrombectomy (MT)" href="intro.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Stroke outcome modelling</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Predicting granular disability outcomes after treatment of stroke with thrombolysis (IVT) or thrombectomy (MT)
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Defining modified Rankin Scale (mRS) probability distributions for untreated patients, and predicted distributions if treatment given at time of stroke onset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mRS_outcomes_maths.html">
   Mathematics for calculating odds and probabilities of mRS-level outcomes after stroke, based on time to reperfusion treatment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="demo_of_outcome_model.html">
   Example output from stroke outcome model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="show_outcome_model_code.html">
   Show outcome model python code
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/mRS_datasets_full.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plain-english-summary">
   Plain English Summary
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#descriptions-of-the-mrs-data-sets-derived-here-and-basic-methodology">
   Descriptions of the mRS data sets derived here, and basic methodology
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#deaths-due-to-treatment">
     Deaths due to treatment
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#proportion-of-ischaemic-patients-with-lvo">
     Proportion of ischaemic patients with LVO
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#analysis-of-samuel-data">
       Analysis of SAMueL data
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#racecat-pre-hospital-diagnosis-of-lvo">
       RACECAT pre-hospital diagnosis of LVO
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#estimating-the-number-of-uk-stroke-patients-eligible-for-endovascular-thrombectomy-review-analysis">
       Estimating the number of UK stroke patients eligible for endovascular thrombectomy (review/analysis)
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#import-packages">
   Import packages
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#set-up-dictionaries-for-results">
   Set up dictionaries for results
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pre-stroke-mrs-distributions">
   Pre-stroke mRS distributions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#nlvo-pre-stroke-mrs-distribution">
     nLVO pre-stroke mRS distribution
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#add-ivt-extra-deaths">
       Add IVT extra deaths:
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lvo-pre-stroke-mrs-distribution">
     LVO pre-stroke mRS distribution
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Add IVT extra deaths:
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#add-mt-extra-deaths">
       Add MT extra deaths:
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#nlvo-baseline-no-treatment-effect">
   nLVO baseline (no treatment effect)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#add-in-extra-ivt-deaths-combined-nlvo-lvo">
     Add in extra IVT deaths (combined nLVO/LVO):
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#add-in-extra-ivt-deaths-lvo">
     Add in extra IVT deaths (LVO):
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculate-a-weighted-distribution-of-lvo-and-nlvo">
     Calculate a weighted distribution of LVO and nLVO
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#without-ivt-deaths">
       Without IVT deaths
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#with-ivt-deaths">
       With IVT deaths
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#nlvo-t-0-treatment-with-ivt">
   nLVO t=0 treatment with IVT
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lvo-baseline-no-treatment-effect">
   LVO baseline (no treatment effect)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     With IVT deaths:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#with-mt-deaths">
     With MT deaths:
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lvo-t-0-treatment-with-ivt">
   LVO t=0 treatment with IVT
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lvo-t-0-treatment-with-mt">
   LVO t=0 treatment with MT
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#show-all-results">
   Show all results
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plot-distributions">
   Plot distributions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Defining modified Rankin Scale (mRS) probability distributions for untreated patients, and predicted distributions if treatment given at time of stroke onset</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plain-english-summary">
   Plain English Summary
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#descriptions-of-the-mrs-data-sets-derived-here-and-basic-methodology">
   Descriptions of the mRS data sets derived here, and basic methodology
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#deaths-due-to-treatment">
     Deaths due to treatment
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#proportion-of-ischaemic-patients-with-lvo">
     Proportion of ischaemic patients with LVO
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#analysis-of-samuel-data">
       Analysis of SAMueL data
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#racecat-pre-hospital-diagnosis-of-lvo">
       RACECAT pre-hospital diagnosis of LVO
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#estimating-the-number-of-uk-stroke-patients-eligible-for-endovascular-thrombectomy-review-analysis">
       Estimating the number of UK stroke patients eligible for endovascular thrombectomy (review/analysis)
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#import-packages">
   Import packages
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#set-up-dictionaries-for-results">
   Set up dictionaries for results
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pre-stroke-mrs-distributions">
   Pre-stroke mRS distributions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#nlvo-pre-stroke-mrs-distribution">
     nLVO pre-stroke mRS distribution
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#add-ivt-extra-deaths">
       Add IVT extra deaths:
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lvo-pre-stroke-mrs-distribution">
     LVO pre-stroke mRS distribution
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Add IVT extra deaths:
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#add-mt-extra-deaths">
       Add MT extra deaths:
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#nlvo-baseline-no-treatment-effect">
   nLVO baseline (no treatment effect)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#add-in-extra-ivt-deaths-combined-nlvo-lvo">
     Add in extra IVT deaths (combined nLVO/LVO):
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#add-in-extra-ivt-deaths-lvo">
     Add in extra IVT deaths (LVO):
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculate-a-weighted-distribution-of-lvo-and-nlvo">
     Calculate a weighted distribution of LVO and nLVO
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#without-ivt-deaths">
       Without IVT deaths
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#with-ivt-deaths">
       With IVT deaths
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#nlvo-t-0-treatment-with-ivt">
   nLVO t=0 treatment with IVT
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lvo-baseline-no-treatment-effect">
   LVO baseline (no treatment effect)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     With IVT deaths:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#with-mt-deaths">
     With MT deaths:
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lvo-t-0-treatment-with-ivt">
   LVO t=0 treatment with IVT
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lvo-t-0-treatment-with-mt">
   LVO t=0 treatment with MT
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#show-all-results">
   Show all results
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plot-distributions">
   Plot distributions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="defining-modified-rankin-scale-mrs-probability-distributions-for-untreated-patients-and-predicted-distributions-if-treatment-given-at-time-of-stroke-onset">
<h1>Defining modified Rankin Scale (mRS) probability distributions for untreated patients, and predicted distributions if treatment given at time of stroke onset<a class="headerlink" href="#defining-modified-rankin-scale-mrs-probability-distributions-for-untreated-patients-and-predicted-distributions-if-treatment-given-at-time-of-stroke-onset" title="Permalink to this headline">#</a></h1>
<section id="plain-english-summary">
<h2>Plain English Summary<a class="headerlink" href="#plain-english-summary" title="Permalink to this headline">#</a></h2>
<p>Disability levels may be measured in various ways. In this project we are using the modified Rankin Scale (mRS). It is a commonly used scale for measuring the degree of disability or dependence in the daily activities of people who have suffered a stroke.</p>
<p>The scale runs from 0-6, running from perfect health without symptoms to death:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Score</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>No symptoms.</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>No significant disability. Able to carry out all usual activities, despite some symptoms.</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Slight disability. Able to look after own affairs without assistance, but unable to carry out all previous activities.</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>Moderate disability. Requires some help, but able to walk unassisted.</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>Moderately severe disability. Unable to attend to own bodily needs without assistance, and unable to walk unassisted.</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>Severe disability. Requires constant nursing care and attention, bedridden, incontinent.</p></td>
</tr>
<tr class="row-even"><td><p>6</p></td>
<td><p>Dead.</p></td>
</tr>
</tbody>
</table>
<p>When we predict the outcome of a person who has had a stroke, we want to be able to say what is the likely improvement in disability level they would experience due to the treatment.</p>
<p>The improvement they can get will depend on the time from when their stroke symptoms began and when they receive treatment. The best possible outcome would be if they were treated immediately after they had their stroke. The benefit of treatment reduces over time until the treatment no longer offer any benefit, and they will not be better off than having no treatment.</p>
<p>In this notebook we describe how we estimate the spread of disability levels if treatment was given immediately after the stroke, and what the spread of disability levels would be if the treatment was given at a time when it was no longer effective. These are two key pieces of information we will later use to estimate the spread of disability levels if we know the time after stroke symptoms began when a person was treated with either thrombolysis (clot-busting medication) or thrombectomy (physical removal of a clot).</p>
</section>
<section id="descriptions-of-the-mrs-data-sets-derived-here-and-basic-methodology">
<h2>Descriptions of the mRS data sets derived here, and basic methodology<a class="headerlink" href="#descriptions-of-the-mrs-data-sets-derived-here-and-basic-methodology" title="Permalink to this headline">#</a></h2>
<p><strong>Pre-stroke mRS distributions</strong>: Pre-stroke mRS distributions give the best possible outcome (i.e. 100% effective treatment). These distributions come from the SAMueL data set, and may be stratified by haemorrgage vs. infarction (ischaemic), and by NIHSS on arrival where, for ischaemic stroke, NIHSS 0-10 is taken as a surrogate for nLVO, and NIHSS 11+ is taken as a surrogate for LVO.</p>
<p><strong>nLVO baseline (no treatment effect)</strong>: The weighted combination of the untreated control group of combined nLVO/LVO data from Lees et al. 2010 (67%) and the untreated control group of LVO-only data from Goyal et al. 2016 (33%). Weightings are chosen to match the P(mRS &lt;= 1) of 46% (from the control group in Emberson with NIHSS of 0-10). This distribution is then corrected for the excess deaths due to treatment with IVT.</p>
<p><strong>nLVO t=0 treatment with IVT</strong>: The weighted combination of pre-stroke mRS for patients with NIHSS 0-10 (61%) and untreated control group of nLVO (39%) distributions, where weights are chosen to match the P(mRS &lt;= 1, t=0)=0.63. 63% is estimated from Emberson et al. 2014, where 46% of untreated patients with NIHSS 0-10 had mRS 0-1, and the odds ratio of mRS 0-1 extrapolates back to 2.0 at t=0. Pre-stroke mRS is for ischaemic stroke with NIHSS 0-10 (from the SAMueL data set). This distribution is then corrected for the excess deaths due to treatment with IVT,</p>
<p><strong>LVO baseline (no treatment effect)</strong>: The control population from Goyal et al. 2016. This distribution is then corrected for the deaths due to treatment with IVT,</p>
<p><strong>LVO t=0 treatment with IVT</strong>: Weighted combination of the no treatment LVO data from Goyal et al. 2016 (82%) and the pre-stroke mRS distribution (18%%, for ischaemic stroke with NIHSS 11+, from the SAMueL data set). The weights are chosen to match P(mRS &lt;= 1) of 0.20 which is set as a target by extrapolating the control group mRS for patients with NIHSS 11+ from Emberson et al. 2014 back to a predicted odds ratio of mRS 0-1 of 2.0 at t=0. This distribution is then corrected for the excess deaths due to treatment with IVT.</p>
<p><strong>LVO t=0 treatment with MT</strong>: The weighted combination of pre-stroke (75%) and untreated LVO at no-effect-time (25%). Hui et al. 2020 reported 75% successful recanalisation with thrombectomy. We assume that recanalisation at t=0 restores all pre-stroke function*. Pre-stroke mRS is for ischaemic stroke with NIHSS 11+ (from the SAMueL data set). This distribution is then corrected for the excess deaths due to treatment with MT.</p>
<p>*Extrapolating results of good outcome, when recanalisation has been achieved with thrombectomy, from Fransen et al. 2016 back to t=0, assuming 75% recanalisation, gives the same proportion of patients with mRS &lt;= 2 as the pre-stroke mRS in the SAMueL data (therefore this extrapolation would suggest full recovery of all health with thrombectomy theoretically carried out at t=0).</p>
<section id="deaths-due-to-treatment">
<h3>Deaths due to treatment<a class="headerlink" href="#deaths-due-to-treatment" title="Permalink to this headline">#</a></h3>
<p>IVT deaths due to fatal intracranial haemorrhage (Emberson et al., 2014):</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>NIHSS</p></th>
<th class="head"><p>Treated</p></th>
<th class="head"><p>Control</p></th>
<th class="head"><p>Excess</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0-10</p></td>
<td><p>1.41%</p></td>
<td><p>0.32%</p></td>
<td><p>1.10%</p></td>
</tr>
<tr class="row-odd"><td><p>11+</p></td>
<td><p>3.85%</p></td>
<td><p>0.45%</p></td>
<td><p>3.41%</p></td>
</tr>
<tr class="row-even"><td><p>All</p></td>
<td><p>2.68%</p></td>
<td><p>0.39%</p></td>
<td><p>2.29%</p></td>
</tr>
</tbody>
</table>
<p>Excess deaths due to IVT are assumed to occur independently of time. Differing risks of death are applied according to whether the patient in assumed nLVO (NIHSS 0-10 as a surrogate for nLVO) or LVO (NIHSS 11+, as a surrogate for LVO).</p>
<p>MT deaths (Goyal et al., 2016):</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Treated</p></th>
<th class="head"><p>Control</p></th>
<th class="head"><p>Excess</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>18.9%</p></td>
<td><p>15.3%</p></td>
<td><p>3.6%</p></td>
</tr>
</tbody>
</table>
<p>The control group in Goyal et al. do not receive MT, but do receive other interventions such as IVT (used in 83% of patients). No additional IVT-related deaths need to be considered when modelling use of MT as the control group (used to estimate the effect of MT at a time MT is no longer effectivbe) already includes IVT-related excess deaths.</p>
</section>
<section id="proportion-of-ischaemic-patients-with-lvo">
<h3>Proportion of ischaemic patients with LVO<a class="headerlink" href="#proportion-of-ischaemic-patients-with-lvo" title="Permalink to this headline">#</a></h3>
<section id="analysis-of-samuel-data">
<h4>Analysis of SAMueL data<a class="headerlink" href="#analysis-of-samuel-data" title="Permalink to this headline">#</a></h4>
<p>The proportion of ischaemic patients with LVO may be estimated in various ways. Estimates are likely to be swayed by the population being studied (e.g. treatment trial results may under-estimate nLVO as very low severity patients may not be selected for the trial). Below are various estimated of the  relative occurrence of LVO and nLVO:</p>
<p>Data from SAMueL using NIHSS 11+ as a surrogate for LVO:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Admission type</p></th>
<th class="head"><p>All arrivals</p></th>
<th class="head"><p>Arrival within 6 hrs known onset</p></th>
<th class="head"><p>Arrival within 4 hrs known onset</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Proportion all admissions</p></td>
<td><p>1.0</p></td>
<td><p>42.9</p></td>
<td><p>37.1</p></td>
</tr>
<tr class="row-odd"><td><p>Proportion haemorrhagic</p></td>
<td><p>11.5</p></td>
<td><p>13.6</p></td>
<td><p>14.1</p></td>
</tr>
<tr class="row-even"><td><p>Proportion ischaemic</p></td>
<td><p>88.5</p></td>
<td><p>86.4</p></td>
<td><p>85.9</p></td>
</tr>
<tr class="row-odd"><td><p>Proportion ischaemic with NIHSS 0-10</p></td>
<td><p>74.9</p></td>
<td><p>67.4</p></td>
<td><p>65.7</p></td>
</tr>
<tr class="row-even"><td><p>Proportion ischaemic with NIHSS 11+</p></td>
<td><p>25.1</p></td>
<td><p>32.6</p></td>
<td><p>34.3</p></td>
</tr>
</tbody>
</table>
<p>For original analysis see: <a class="reference external" href="https://samuel-book.github.io/samuel-1/descriptive_stats/10_using_nihss_10_for_lvo.html">https://samuel-book.github.io/samuel-1/descriptive_stats/10_using_nihss_10_for_lvo.html</a></p>
</section>
<section id="racecat-pre-hospital-diagnosis-of-lvo">
<h4>RACECAT pre-hospital diagnosis of LVO<a class="headerlink" href="#racecat-pre-hospital-diagnosis-of-lvo" title="Permalink to this headline">#</a></h4>
<p>A breakdown on stroke type from , 20the design of the RACE test for pre-hopsital diagnosis of LVO (de la Ossa Herrero et al., 2013). Note - there appears to be some discrepancies between reporting of the results between the text and the detailed breakdown by RACE score in figure 2 of the paper.</p>
<ul class="simple">
<li><p>Trial recruited from patients who presented at the emergency department within 6 hours from symptoms onset.</p></li>
<li><p>In the text: Of 357 patients in the analysis, the stroke subtype was ischemic stroke in 240 (67.2%), hemorrhagic stroke in 52 (14.6%), transient ischemic attack in 20 (5.6%), and stroke mimic in 45 (12.6%). LVO was detected in 76 patients (31.7% of ischaemic strokes).</p></li>
<li><p>In figure 2: Of 357 patients in the analysis, the stroke subtype was ischemic stroke in 260 (72.8), hemorrhagic stroke in 52 (14.6%), and stroke mimic in 45 (12.6%). LVO was detected in 99 patients (38.1% of ischaemic strokes). It appears that TIAs may be counted in with ischaemic strokes in this analysis.</p></li>
</ul>
</section>
<section id="estimating-the-number-of-uk-stroke-patients-eligible-for-endovascular-thrombectomy-review-analysis">
<h4>Estimating the number of UK stroke patients eligible for endovascular thrombectomy (review/analysis)<a class="headerlink" href="#estimating-the-number-of-uk-stroke-patients-eligible-for-endovascular-thrombectomy-review-analysis" title="Permalink to this headline">#</a></h4>
<p>McMeekin et al. (2017) review the evdidence for estimating the number of UK stroke patients eligible for endovascular thrombectomy. They estimate:</p>
<ul class="simple">
<li><p>40% of ischaemic stroke patients have LVO; 80% of which have NIHSS &gt;=6 and say be suitable for thrombectomy. This is equivalent to 32% of admitted patients having LVO suitable for thrombectomy.</p></li>
</ul>
</section>
</section>
</section>
<section id="import-packages">
<h2>Import packages<a class="headerlink" href="#import-packages" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Set NumPy and Pandas to print 4 decimal places</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.precision&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="set-up-dictionaries-for-results">
<h2>Set up dictionaries for results<a class="headerlink" href="#set-up-dictionaries-for-results" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_distributions_bins</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">all_distributions_cumsum</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="pre-stroke-mrs-distributions">
<h2>Pre-stroke mRS distributions<a class="headerlink" href="#pre-stroke-mrs-distributions" title="Permalink to this headline">#</a></h2>
<p>Pre-stroke mRS distributions come from SSNAP data. They are used to estimate the best possible outcome from treatment.</p>
<section id="nlvo-pre-stroke-mrs-distribution">
<h3>nLVO pre-stroke mRS distribution<a class="headerlink" href="#nlvo-pre-stroke-mrs-distribution" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pre-stroke nLVO uses pre-stroke mRS from SAMueL wfor patients with ischaemic</span>
<span class="c1"># stroke and NIHSS 0-10.</span>

<span class="c1"># Define distribution from data</span>
<span class="n">pre_stroke_nlvo_bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="mf">0.582881</span><span class="p">,</span> <span class="mf">0.162538</span><span class="p">,</span> <span class="mf">0.103440</span><span class="p">,</span> <span class="mf">0.102223</span><span class="p">,</span> <span class="mf">0.041973</span><span class="p">,</span> <span class="mf">0.006945</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>

<span class="c1"># Normalise</span>
<span class="n">pre_stroke_nlvo_bins</span> <span class="o">=</span> <span class="n">pre_stroke_nlvo_bins</span> <span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">pre_stroke_nlvo_bins</span><span class="p">)</span>
<span class="n">all_distributions_bins</span><span class="p">[</span><span class="s1">&#39;pre_stroke_nlvo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pre_stroke_nlvo_bins</span>

<span class="c1"># Make cumulative distribution</span>
<span class="n">pre_stroke_nlvo_cumsum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">pre_stroke_nlvo_bins</span><span class="p">)</span>
<span class="n">all_distributions_cumsum</span><span class="p">[</span><span class="s1">&#39;pre_stroke_nlvo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pre_stroke_nlvo_cumsum</span>

<span class="c1"># Show</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pre-stroke nLVO&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS bins:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">pre_stroke_nlvo_bins</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS cumulative:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">pre_stroke_nlvo_cumsum</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pre-stroke nLVO
---------------
mRS bins:
array([0.5829, 0.1625, 0.1034, 0.1022, 0.042 , 0.0069, 0.    ])

mRS cumulative:
array([0.5829, 0.7454, 0.8489, 0.9511, 0.9931, 1.    , 1.    ])
</pre></div>
</div>
</div>
</div>
<section id="add-ivt-extra-deaths">
<h4>Add IVT extra deaths:<a class="headerlink" href="#add-ivt-extra-deaths" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pre_stroke_nlvo_bins_ivt_deaths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">pre_stroke_nlvo_bins</span><span class="p">)</span>

<span class="c1"># Correct deaths to be deaths due to haemorrhage seen by Emberson et al</span>
<span class="n">excess_deaths</span> <span class="o">=</span> <span class="mf">0.011</span>
<span class="n">pre_stroke_nlvo_bins_ivt_deaths</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">+=</span> <span class="n">excess_deaths</span>
<span class="n">correction_mrs_0_to_5</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">pre_stroke_nlvo_bins_ivt_deaths</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">])</span> <span class="o">-</span> <span class="n">excess_deaths</span><span class="p">)</span> <span class="o">/</span> 
    <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">pre_stroke_nlvo_bins_ivt_deaths</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">])))</span>
<span class="n">pre_stroke_nlvo_bins_ivt_deaths</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">*=</span> <span class="n">correction_mrs_0_to_5</span>
<span class="n">pre_stroke_nlvo_cumsum_ivt_deaths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">pre_stroke_nlvo_bins_ivt_deaths</span><span class="p">)</span>

<span class="c1"># Store</span>
<span class="n">all_distributions_bins</span><span class="p">[</span><span class="s1">&#39;pre_stroke_nlvo_ivt_deaths&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">pre_stroke_nlvo_bins_ivt_deaths</span>
<span class="n">all_distributions_cumsum</span><span class="p">[</span><span class="s1">&#39;pre_stroke_nlvo_ivt_deaths&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">pre_stroke_nlvo_cumsum_ivt_deaths</span>

<span class="c1"># Show</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pre-stroke nLVO with IVT deaths&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-------------------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS bins:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">pre_stroke_nlvo_bins_ivt_deaths</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS cumulative:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">pre_stroke_nlvo_cumsum_ivt_deaths</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pre-stroke nLVO with IVT deaths
-------------------------------
mRS bins:
array([0.5765, 0.1608, 0.1023, 0.1011, 0.0415, 0.0069, 0.011 ])

mRS cumulative:
array([0.5765, 0.7372, 0.8395, 0.9406, 0.9821, 0.989 , 1.    ])
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="lvo-pre-stroke-mrs-distribution">
<h3>LVO pre-stroke mRS distribution<a class="headerlink" href="#lvo-pre-stroke-mrs-distribution" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pre-stroke nLVO uses pre-stroke mRS from SAMueL wfor patients with ischaemic</span>
<span class="c1"># stroke and NIHSS 0-10.</span>

<span class="c1"># Define distribution from data</span>
<span class="n">pre_stroke_lvo_bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="mf">0.417894</span><span class="p">,</span> <span class="mf">0.142959</span><span class="p">,</span> <span class="mf">0.118430</span><span class="p">,</span> <span class="mf">0.164211</span><span class="p">,</span> <span class="mf">0.113775</span><span class="p">,</span> <span class="mf">0.042731</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>

<span class="c1"># Normalise</span>
<span class="n">pre_stroke_lvo_bins</span> <span class="o">=</span> <span class="n">pre_stroke_lvo_bins</span> <span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">pre_stroke_lvo_bins</span><span class="p">)</span>
<span class="n">all_distributions_bins</span><span class="p">[</span><span class="s1">&#39;pre_stroke_lvo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pre_stroke_lvo_bins</span>

<span class="c1"># Make cumulative distribution</span>
<span class="n">pre_stroke_lvo_cumsum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">pre_stroke_lvo_bins</span><span class="p">)</span>
<span class="n">all_distributions_cumsum</span><span class="p">[</span><span class="s1">&#39;pre_stroke_lvo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pre_stroke_lvo_cumsum</span>

<span class="c1"># Show</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pre-stroke LVO&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS bins:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">pre_stroke_lvo_bins</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS cumulative:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">pre_stroke_lvo_cumsum</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pre-stroke LVO
--------------
mRS bins:
array([0.4179, 0.143 , 0.1184, 0.1642, 0.1138, 0.0427, 0.    ])

mRS cumulative:
array([0.4179, 0.5609, 0.6793, 0.8435, 0.9573, 1.    , 1.    ])
</pre></div>
</div>
</div>
</div>
<section id="id1">
<h4>Add IVT extra deaths:<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pre_stroke_lvo_bins_ivt_deaths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">pre_stroke_lvo_bins</span><span class="p">)</span>

<span class="c1"># Correct deaths to be 3.41% deaths due to haemorrhage</span>
<span class="n">excess_deaths</span> <span class="o">=</span> <span class="mf">0.0341</span>
<span class="n">pre_stroke_lvo_bins_ivt_deaths</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">+=</span> <span class="n">excess_deaths</span>
<span class="n">correction_mrs_0_to_5</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">pre_stroke_lvo_bins_ivt_deaths</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">])</span> <span class="o">-</span> <span class="n">excess_deaths</span><span class="p">)</span> <span class="o">/</span> 
    <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">pre_stroke_lvo_bins_ivt_deaths</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">])))</span>
<span class="n">pre_stroke_lvo_bins_ivt_deaths</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">*=</span> <span class="n">correction_mrs_0_to_5</span>
<span class="n">pre_stroke_lvo_cumsum_ivt_deaths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">pre_stroke_lvo_bins_ivt_deaths</span><span class="p">)</span>

<span class="c1"># Store</span>
<span class="n">all_distributions_bins</span><span class="p">[</span><span class="s1">&#39;pre_stroke_lvo_ivt_deaths&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">pre_stroke_lvo_bins_ivt_deaths</span>
<span class="n">all_distributions_cumsum</span><span class="p">[</span><span class="s1">&#39;pre_stroke_lvo_ivt_deaths&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">pre_stroke_lvo_cumsum_ivt_deaths</span>

<span class="c1"># Show</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pre-stroke lvo with IVT deaths&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;------------------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS bins:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">pre_stroke_lvo_bins_ivt_deaths</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS cumulative:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">pre_stroke_lvo_cumsum_ivt_deaths</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pre-stroke lvo with IVT deaths
------------------------------
mRS bins:
array([0.4036, 0.1381, 0.1144, 0.1586, 0.1099, 0.0413, 0.0341])

mRS cumulative:
array([0.4036, 0.5417, 0.6561, 0.8147, 0.9246, 0.9659, 1.    ])
</pre></div>
</div>
</div>
</div>
</section>
<section id="add-mt-extra-deaths">
<h4>Add MT extra deaths:<a class="headerlink" href="#add-mt-extra-deaths" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pre_stroke_lvo_bins_mt_deaths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">pre_stroke_lvo_bins</span><span class="p">)</span>

<span class="c1"># Correct deaths to be excess 3.6% deaths</span>
<span class="n">excess_deaths</span> <span class="o">=</span> <span class="mf">0.036</span>
<span class="n">pre_stroke_lvo_bins_mt_deaths</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">+=</span> <span class="n">excess_deaths</span>
<span class="n">correction_mrs_0_to_5</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">pre_stroke_lvo_bins_mt_deaths</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">])</span> <span class="o">-</span> <span class="n">excess_deaths</span><span class="p">)</span> <span class="o">/</span> 
    <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">pre_stroke_lvo_bins_mt_deaths</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">])))</span>
<span class="n">pre_stroke_lvo_bins_mt_deaths</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">*=</span> <span class="n">correction_mrs_0_to_5</span>
<span class="n">pre_stroke_lvo_cumsum_mt_deaths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">pre_stroke_lvo_bins_mt_deaths</span><span class="p">)</span>

<span class="c1"># Store</span>
<span class="n">all_distributions_bins</span><span class="p">[</span><span class="s1">&#39;pre_stroke_lvo_mt_deaths&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">pre_stroke_lvo_bins_mt_deaths</span>
<span class="n">all_distributions_cumsum</span><span class="p">[</span><span class="s1">&#39;pre_stroke_lvo_mt_deaths&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">pre_stroke_lvo_cumsum_mt_deaths</span>

<span class="c1"># Show</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pre-stroke lvo with mt deaths&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-----------------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS bins:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">pre_stroke_lvo_bins_mt_deaths</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS cumulative:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">pre_stroke_lvo_cumsum_mt_deaths</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pre-stroke lvo with mt deaths
-----------------------------
mRS bins:
array([0.4028, 0.1378, 0.1142, 0.1583, 0.1097, 0.0412, 0.036 ])

mRS cumulative:
array([0.4028, 0.5407, 0.6548, 0.8131, 0.9228, 0.964 , 1.    ])
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="nlvo-baseline-no-treatment-effect">
<h2>nLVO baseline (no treatment effect)<a class="headerlink" href="#nlvo-baseline-no-treatment-effect" title="Permalink to this headline">#</a></h2>
<p>The weighted combination of the untreated control group of combined nLVO/LVO data from Lees et al. 2010 (100%) and the untreated control group of LVO-only data from Goyal et al. 2016. Weightings are chosen to match the P(mRS &lt;= 1) of 46% (from the control group in Emberson with NIHSS of 0-10).</p>
<p>The distribution is corrected for 1.1% excess deaths in the IVT-treated group (from Emberson et al., 2014, using NIHSS 0-10 as a surrogate for nLVO).</p>
<p>Set up required distributions from data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define distributions from data</span>
<span class="n">no_treatment_nlvo_lvo_bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span><span class="mf">0.1486</span><span class="p">,</span> <span class="mf">0.2022</span><span class="p">,</span> <span class="mf">0.1253</span><span class="p">,</span> <span class="mf">0.1397</span><span class="p">,</span> <span class="mf">0.1806</span><span class="p">,</span> <span class="mf">0.0861</span><span class="p">,</span> <span class="mf">0.1175</span><span class="p">])</span>

<span class="n">no_treatment_lvo_bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span><span class="mf">0.050</span><span class="p">,</span> <span class="mf">0.079</span><span class="p">,</span> <span class="mf">0.136</span><span class="p">,</span> <span class="mf">0.164</span><span class="p">,</span> <span class="mf">0.247</span><span class="p">,</span> <span class="mf">0.135</span><span class="p">,</span> <span class="mf">0.189</span><span class="p">])</span>

<span class="c1"># Normalise</span>
<span class="n">no_treatment_nlvo_lvo_bins</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">no_treatment_nlvo_lvo_bins</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">no_treatment_nlvo_lvo_bins</span><span class="p">))</span>

<span class="n">no_treatment_lvo_bins</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">no_treatment_lvo_bins</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">no_treatment_lvo_bins</span><span class="p">))</span>

<span class="c1"># Make cumulative distribution</span>
<span class="n">no_treatment_nlvo_lvo_cumsum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">no_treatment_nlvo_lvo_bins</span><span class="p">)</span>
<span class="n">no_treatment_lvo_cumsum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">no_treatment_lvo_bins</span><span class="p">)</span>

<span class="c1"># Show</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;nLVO-LVO combined no treatment effect&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-------------------------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS bins:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">no_treatment_nlvo_lvo_bins</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS cumulative:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">no_treatment_nlvo_lvo_cumsum</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;LVO combined no treatment effect&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-------------------------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS bins:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">no_treatment_lvo_bins</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS cumulative:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">no_treatment_lvo_cumsum</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>nLVO-LVO combined no treatment effect
-------------------------------------
mRS bins:
array([0.1486, 0.2022, 0.1253, 0.1397, 0.1806, 0.0861, 0.1175])

mRS cumulative:
array([0.1486, 0.3508, 0.4761, 0.6158, 0.7964, 0.8825, 1.    ])

LVO combined no treatment effect
-------------------------------------
mRS bins:
array([0.05 , 0.079, 0.136, 0.164, 0.247, 0.135, 0.189])

mRS cumulative:
array([0.05 , 0.129, 0.265, 0.429, 0.676, 0.811, 1.   ])
</pre></div>
</div>
</div>
</div>
<section id="add-in-extra-ivt-deaths-combined-nlvo-lvo">
<h3>Add in extra IVT deaths (combined nLVO/LVO):<a class="headerlink" href="#add-in-extra-ivt-deaths-combined-nlvo-lvo" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">no_treatment_nlvo_lvo_bins_ivt_deaths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">no_treatment_nlvo_lvo_bins</span><span class="p">)</span>

<span class="c1"># Correct deaths to 2.29% deaths due to haemorrhage</span>
<span class="n">excess_deaths</span> <span class="o">=</span> <span class="mf">0.0229</span>
<span class="n">no_treatment_nlvo_lvo_bins_ivt_deaths</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">+=</span> <span class="n">excess_deaths</span>
<span class="n">correction_mrs_0_to_5</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">no_treatment_nlvo_lvo_bins_ivt_deaths</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">])</span> <span class="o">-</span> <span class="n">excess_deaths</span><span class="p">)</span> <span class="o">/</span> 
    <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">no_treatment_nlvo_lvo_bins_ivt_deaths</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">])))</span>
<span class="n">no_treatment_nlvo_lvo_bins_ivt_deaths</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">*=</span> <span class="n">correction_mrs_0_to_5</span>
<span class="n">no_treatment_nlvo_lvo_cumsum_ivt_deaths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">no_treatment_nlvo_lvo_bins_ivt_deaths</span><span class="p">)</span>

<span class="c1"># Show</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No treatment combined nlvo/lvo with IVT deaths&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----------------------------------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS bins:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">no_treatment_nlvo_lvo_bins_ivt_deaths</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS cumulative:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">no_treatment_nlvo_lvo_cumsum_ivt_deaths</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No treatment combined nlvo/lvo with IVT deaths
----------------------------------------------
mRS bins:
array([0.1447, 0.197 , 0.122 , 0.1361, 0.1759, 0.0839, 0.1404])

mRS cumulative:
array([0.1447, 0.3417, 0.4637, 0.5998, 0.7757, 0.8596, 1.    ])
</pre></div>
</div>
</div>
</div>
</section>
<section id="add-in-extra-ivt-deaths-lvo">
<h3>Add in extra IVT deaths (LVO):<a class="headerlink" href="#add-in-extra-ivt-deaths-lvo" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">no_treatment_lvo_bins_ivt_deaths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">no_treatment_lvo_bins</span><span class="p">)</span>

<span class="c1"># Correct deaths 3.41% deaths due to haemorrhage</span>
<span class="n">excess_deaths</span> <span class="o">=</span> <span class="mf">0.0341</span>
<span class="n">no_treatment_lvo_bins_ivt_deaths</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">+=</span> <span class="n">excess_deaths</span>
<span class="n">correction_mrs_0_to_5</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">no_treatment_lvo_bins_ivt_deaths</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">])</span> <span class="o">-</span> <span class="n">excess_deaths</span><span class="p">)</span> <span class="o">/</span> 
    <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">no_treatment_lvo_bins_ivt_deaths</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">])))</span>
<span class="n">no_treatment_lvo_bins_ivt_deaths</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">*=</span> <span class="n">correction_mrs_0_to_5</span>
<span class="n">no_treatment_lvo_cumsum_ivt_deaths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">no_treatment_lvo_bins_ivt_deaths</span><span class="p">)</span>

<span class="c1"># Show</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No treatment combined lvo with IVT deaths&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-----------------------------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS bins:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">no_treatment_lvo_bins_ivt_deaths</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS cumulative:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">no_treatment_lvo_cumsum_ivt_deaths</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No treatment combined lvo with IVT deaths
-----------------------------------------
mRS bins:
array([0.0479, 0.0757, 0.1303, 0.1571, 0.2366, 0.1293, 0.2231])

mRS cumulative:
array([0.0479, 0.1236, 0.2539, 0.411 , 0.6476, 0.7769, 1.    ])
</pre></div>
</div>
</div>
</div>
</section>
<section id="calculate-a-weighted-distribution-of-lvo-and-nlvo">
<h3>Calculate a weighted distribution of LVO and nLVO<a class="headerlink" href="#calculate-a-weighted-distribution-of-lvo-and-nlvo" title="Permalink to this headline">#</a></h3>
<p>Calculate the weights needed to give a distribution with P(mRS &lt;-1, t=tne) = 46%</p>
<section id="without-ivt-deaths">
<h4>Without IVT deaths<a class="headerlink" href="#without-ivt-deaths" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">target_diff</span>  <span class="o">=</span> <span class="p">(</span><span class="mf">0.46</span><span class="p">)</span>  <span class="o">-</span> <span class="n">no_treatment_nlvo_lvo_cumsum</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">current_diff</span> <span class="o">=</span> <span class="p">(</span><span class="n">no_treatment_lvo_cumsum</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> 
                <span class="n">no_treatment_nlvo_lvo_cumsum</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">weight_lvo</span>   <span class="o">=</span> <span class="n">target_diff</span> <span class="o">/</span> <span class="n">current_diff</span>
<span class="n">weight_nlvo_lvo</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">weight_lvo</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Weights: </span><span class="si">{</span><span class="n">weight_lvo</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">,&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">weight_nlvo_lvo</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Weights: -0.4923, 1.4923
</pre></div>
</div>
</div>
</div>
<p>Apply the weights</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Apply weights</span>
<span class="n">no_treatment_nlvo_bins</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">weight_nlvo_lvo</span> <span class="o">*</span> <span class="n">no_treatment_nlvo_lvo_bins</span><span class="p">)</span> <span class="o">+</span> 
    <span class="p">(</span><span class="n">weight_lvo</span>      <span class="o">*</span> <span class="n">no_treatment_lvo_bins</span><span class="p">)</span> <span class="p">)</span>

<span class="c1"># Normalise</span>
<span class="n">no_treatment_nlvo_bins</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">no_treatment_nlvo_bins</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">no_treatment_nlvo_bins</span><span class="p">))</span>

<span class="c1"># Make cumulative distribution (before correction for deaths)</span>
<span class="n">no_treatment_nlvo_cumsum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">no_treatment_nlvo_bins</span><span class="p">)</span>

<span class="c1"># Copy, to add trteament deaths</span>
<span class="n">no_effect_nlvo_ivt_bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">no_treatment_nlvo_bins</span><span class="p">)</span>

<span class="c1"># Store</span>
<span class="n">all_distributions_bins</span><span class="p">[</span><span class="s1">&#39;no_treatment_nlvo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">no_effect_nlvo_ivt_bins</span>

<span class="c1"># Make cumulative distribution</span>
<span class="n">no_effect_nlvo_cumsum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">no_effect_nlvo_ivt_bins</span><span class="p">)</span>
<span class="n">all_distributions_cumsum</span><span class="p">[</span><span class="s1">&#39;no_treatment_nlvo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">no_effect_nlvo_cumsum</span>

<span class="c1"># Show</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;nLVO no treatment effect&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;------------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS bins:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">no_effect_nlvo_ivt_bins</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS cumulative:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">no_effect_nlvo_cumsum</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>nLVO no treatment effect
------------------------
mRS bins:
array([0.1971, 0.2629, 0.12  , 0.1277, 0.1479, 0.062 , 0.0823])

mRS cumulative:
array([0.1971, 0.46  , 0.58  , 0.7078, 0.8557, 0.9177, 1.    ])
</pre></div>
</div>
</div>
</div>
</section>
<section id="with-ivt-deaths">
<h4>With IVT deaths<a class="headerlink" href="#with-ivt-deaths" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">target_diff</span>  <span class="o">=</span> <span class="mf">0.46</span>  <span class="o">-</span> <span class="n">no_treatment_nlvo_lvo_cumsum_ivt_deaths</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">current_diff</span> <span class="o">=</span> <span class="p">(</span><span class="n">no_treatment_lvo_cumsum_ivt_deaths</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> 
                <span class="n">no_treatment_nlvo_lvo_cumsum_ivt_deaths</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">weight_lvo</span>   <span class="o">=</span> <span class="n">target_diff</span> <span class="o">/</span> <span class="n">current_diff</span>
<span class="n">weight_nlvo_lvo</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">weight_lvo</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Weights: </span><span class="si">{</span><span class="n">weight_lvo</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">,&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">weight_nlvo_lvo</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Weights: -0.5424, 1.5424
</pre></div>
</div>
</div>
</div>
<p>Apply the weights</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Apply weights</span>
<span class="n">no_treatment_nlvo_bins_ivt_deaths</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">weight_nlvo_lvo</span> <span class="o">*</span> <span class="n">no_treatment_nlvo_lvo_bins_ivt_deaths</span><span class="p">)</span> <span class="o">+</span> 
    <span class="p">(</span><span class="n">weight_lvo</span>      <span class="o">*</span> <span class="n">no_treatment_lvo_bins_ivt_deaths</span><span class="p">)</span> <span class="p">)</span>

<span class="c1"># Normalise</span>
<span class="n">no_treatment_nlvo_bins_ivt_deaths</span> <span class="o">=</span> <span class="p">(</span><span class="n">no_treatment_nlvo_bins_ivt_deaths</span> <span class="o">/</span> 
                                     <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">no_treatment_nlvo_bins_ivt_deaths</span><span class="p">))</span>

<span class="c1"># Make cumulative distribution (before correction for deaths)</span>
<span class="n">no_treatment_nlvo_cumsum_ivt_deaths</span> <span class="o">=</span> \
    <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">no_treatment_nlvo_bins_ivt_deaths</span><span class="p">)</span>

<span class="c1"># Copy, to add trteament deaths</span>
<span class="n">no_effect_nlvo_ivt_bins_ivt_deaths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">no_treatment_nlvo_bins_ivt_deaths</span><span class="p">)</span>

<span class="c1"># Store</span>
<span class="n">all_distributions_bins</span><span class="p">[</span><span class="s1">&#39;no_effect_nlvo_ivt_deaths&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">no_effect_nlvo_ivt_bins_ivt_deaths</span>

<span class="c1"># Make cumulative distribution</span>
<span class="n">no_effect_nlvo_cumsum_ivt_deaths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">no_treatment_nlvo_bins_ivt_deaths</span><span class="p">)</span>
<span class="n">all_distributions_cumsum</span><span class="p">[</span><span class="s1">&#39;no_effect_nlvo_ivt_deaths&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">no_effect_nlvo_cumsum_ivt_deaths</span>

<span class="c1"># Show</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;nLVO no treatment effect_ivt_deaths&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-----------------------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS bins:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">no_effect_nlvo_ivt_bins_ivt_deaths</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS cumulative:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">no_effect_nlvo_cumsum_ivt_deaths</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>nLVO no treatment effect_ivt_deaths
-----------------------------------
mRS bins:
array([0.1973, 0.2627, 0.1176, 0.1247, 0.143 , 0.0592, 0.0955])

mRS cumulative:
array([0.1973, 0.46  , 0.5776, 0.7023, 0.8452, 0.9045, 1.    ])
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="nlvo-t-0-treatment-with-ivt">
<h2>nLVO t=0 treatment with IVT<a class="headerlink" href="#nlvo-t-0-treatment-with-ivt" title="Permalink to this headline">#</a></h2>
<p>The weighted combination of pre-stroke mRS for patients with NIHSS 0-10 and untreated control group of nLVO distributions, where weights are chosen to match the P(mRS &lt;= 1, t=0)=0.63. 63% is estimated from Emberson et al. 2014, where 46% of untreated patients with NIHSS 0-10 had mRS 0-1, and the odds ratio of mRS 0-1 extrapolates back to 2.0 at t=0. Pre-stroke mRS is for ischaemic stroke with NIHSS 0-10 (from the SAMueL data set).</p>
<p>The distribution is corrected for 1.1% excess deaths in the IVT-treated group (from Emberson et al., 2014, using NIHSS 0-10 as a surrogate for nLVO).</p>
<p>Calculate weights</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">target_diff</span>  <span class="o">=</span> <span class="mf">0.63</span>  <span class="o">-</span> <span class="n">no_treatment_nlvo_cumsum_ivt_deaths</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">current_diff</span> <span class="o">=</span> <span class="p">(</span><span class="n">pre_stroke_nlvo_cumsum_ivt_deaths</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> 
                <span class="n">no_treatment_nlvo_cumsum_ivt_deaths</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">weight_pre_stroke_nlvo</span>   <span class="o">=</span> <span class="n">target_diff</span> <span class="o">/</span> <span class="n">current_diff</span>
<span class="n">weight_no_treatment_nlvo</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">weight_pre_stroke_nlvo</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Weights (pre-stroke, no_treatment): </span><span class="si">{</span><span class="n">weight_pre_stroke_nlvo</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">,&#39;</span><span class="p">,</span>
      <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">weight_no_treatment_nlvo</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Weights (pre-stroke, no_treatment): 0.6132, 0.3868
</pre></div>
</div>
</div>
</div>
<p>Apply the weights.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Apply weights</span>
<span class="n">t0_treatment_nlvo_ivt_bins</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">weight_pre_stroke_nlvo</span>   <span class="o">*</span> <span class="n">pre_stroke_nlvo_bins_ivt_deaths</span><span class="p">)</span> <span class="o">+</span>
    <span class="p">(</span><span class="n">weight_no_treatment_nlvo</span> <span class="o">*</span> <span class="n">no_treatment_nlvo_bins_ivt_deaths</span><span class="p">))</span>

<span class="c1"># Normalise</span>
<span class="n">t0_treatment_nlvo_ivt_bins</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">t0_treatment_nlvo_ivt_bins</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">t0_treatment_nlvo_ivt_bins</span><span class="p">))</span>

<span class="c1"># Store</span>
<span class="n">all_distributions_bins</span><span class="p">[</span><span class="s1">&#39;t0_treatment_nlvo_ivt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t0_treatment_nlvo_ivt_bins</span>

<span class="c1"># Make cumulative distribution</span>
<span class="n">t0_treatment_nlvo_ivt_cumsum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">t0_treatment_nlvo_ivt_bins</span><span class="p">)</span>
<span class="n">all_distributions_cumsum</span><span class="p">[</span><span class="s1">&#39;t0_treatment_nlvo_ivt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t0_treatment_nlvo_ivt_cumsum</span>

<span class="c1"># Show</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;nLVO IVT t0 treatment effect&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----------------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS bins:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">t0_treatment_nlvo_ivt_bins</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS cumulative:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">t0_treatment_nlvo_ivt_cumsum</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>nLVO IVT t0 treatment effect
----------------------------
mRS bins:
array([0.4298, 0.2002, 0.1082, 0.1102, 0.0808, 0.0271, 0.0437])

mRS cumulative:
array([0.4298, 0.63  , 0.7382, 0.8484, 0.9292, 0.9563, 1.    ])
</pre></div>
</div>
</div>
</div>
</section>
<section id="lvo-baseline-no-treatment-effect">
<h2>LVO baseline (no treatment effect)<a class="headerlink" href="#lvo-baseline-no-treatment-effect" title="Permalink to this headline">#</a></h2>
<p>The control population from Goyal et al. 2016, with added MT-related excess deaths.</p>
<p>No correction for IVT-related deaths is needed when LVO is treated with MT as the Goyal control group includes use of IVT.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># LVO Baseline distributions were defined in cell 5</span>
<span class="n">all_distributions_bins</span><span class="p">[</span><span class="s1">&#39;no_treatment_lvo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">no_treatment_lvo_bins</span>
<span class="n">all_distributions_cumsum</span><span class="p">[</span><span class="s1">&#39;no_treatment_lvo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">no_treatment_lvo_cumsum</span>

<span class="c1"># Show</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;LVO no treatment effect&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;------------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS bins:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">no_treatment_lvo_bins</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS cumulative:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">no_treatment_lvo_cumsum</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LVO no treatment effect
------------------------
mRS bins:
array([0.05 , 0.079, 0.136, 0.164, 0.247, 0.135, 0.189])

mRS cumulative:
array([0.05 , 0.129, 0.265, 0.429, 0.676, 0.811, 1.   ])
</pre></div>
</div>
</div>
</div>
<section id="id2">
<h3>With IVT deaths:<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># LVO Baseline distributions were defined in cell 5</span>
<span class="n">all_distributions_bins</span><span class="p">[</span><span class="s1">&#39;no_effect_lvo_ivt_deaths&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">no_treatment_lvo_bins_ivt_deaths</span>
<span class="n">all_distributions_cumsum</span><span class="p">[</span><span class="s1">&#39;no_effect_lvo_ivt_deaths&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">no_treatment_lvo_cumsum_ivt_deaths</span>

<span class="c1"># Show</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;LVO no treatment effect IVT deaths&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----------------------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS bins:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">no_treatment_lvo_bins_ivt_deaths</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS cumulative:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">no_treatment_lvo_cumsum_ivt_deaths</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LVO no treatment effect IVT deaths
----------------------------------
mRS bins:
array([0.0479, 0.0757, 0.1303, 0.1571, 0.2366, 0.1293, 0.2231])

mRS cumulative:
array([0.0479, 0.1236, 0.2539, 0.411 , 0.6476, 0.7769, 1.    ])
</pre></div>
</div>
</div>
</div>
</section>
<section id="with-mt-deaths">
<h3>With MT deaths:<a class="headerlink" href="#with-mt-deaths" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">no_treatment_lvo_bins_mt_deaths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">no_treatment_lvo_bins</span><span class="p">)</span>

<span class="c1"># Correct deaths 3.85% deaths due to haemorrhage</span>
<span class="n">excess_deaths</span> <span class="o">=</span> <span class="mf">0.0385</span>
<span class="n">no_treatment_lvo_bins_mt_deaths</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">+=</span> <span class="n">excess_deaths</span>
<span class="n">correction_mrs_0_to_5</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">no_treatment_lvo_bins_mt_deaths</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">])</span> <span class="o">-</span> <span class="n">excess_deaths</span><span class="p">)</span> <span class="o">/</span> 
    <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">no_treatment_lvo_bins_mt_deaths</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">])))</span>
<span class="n">no_treatment_lvo_bins_mt_deaths</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">*=</span> <span class="n">correction_mrs_0_to_5</span>
<span class="n">no_treatment_lvo_cumsum_mt_deaths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">no_treatment_lvo_bins_mt_deaths</span><span class="p">)</span>

<span class="c1"># Show</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No treatment combined lvo with mt deaths&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-----------------------------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS bins:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">no_treatment_lvo_bins_mt_deaths</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS cumulative:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">no_treatment_lvo_cumsum_mt_deaths</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No treatment combined lvo with mt deaths
-----------------------------------------
mRS bins:
array([0.0476, 0.0752, 0.1295, 0.1562, 0.2353, 0.1286, 0.2275])

mRS cumulative:
array([0.0476, 0.1229, 0.2524, 0.4086, 0.6439, 0.7725, 1.    ])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># LVO Baseline distributions were defined in cell 5</span>
<span class="n">all_distributions_bins</span><span class="p">[</span><span class="s1">&#39;no_effect_lvo_mt_deaths&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">no_treatment_lvo_bins_mt_deaths</span>
<span class="n">all_distributions_cumsum</span><span class="p">[</span><span class="s1">&#39;no_effect_lvo_mt_deaths&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">no_treatment_lvo_cumsum_mt_deaths</span>

<span class="c1"># Show</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;LVO no treatment effect mt deaths&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----------------------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS bins:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">no_treatment_lvo_bins_mt_deaths</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS cumulative:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">no_treatment_lvo_cumsum_mt_deaths</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LVO no treatment effect mt deaths
----------------------------------
mRS bins:
array([0.0476, 0.0752, 0.1295, 0.1562, 0.2353, 0.1286, 0.2275])

mRS cumulative:
array([0.0476, 0.1229, 0.2524, 0.4086, 0.6439, 0.7725, 1.    ])
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="lvo-t-0-treatment-with-ivt">
<h2>LVO t=0 treatment with IVT<a class="headerlink" href="#lvo-t-0-treatment-with-ivt" title="Permalink to this headline">#</a></h2>
<p>Weighted combination of the no treatment LVO data from Goyal et al. 2016 and the pre-stroke mRS distribution (for ischaemic stroke with NIHSS 11+, from the SAMueL data set). The weights are chosen to match P(mRS &lt;= 1) of 0.20 which is set as a target by extrapolating the control group mRS for patients with NIHSS 11+ from Emberson et al. 2014 back to a predicted odds ratio of mRS 0-1 of 2.0 at t=0.</p>
<p>The distribution is corrected for 3.4% excess deaths in the IVT-treated group (from Emberson et al., 2014, using NIHSS 11+ as a surrogate for LVO).</p>
<p>Calculate the weights needed to give a distribution with P(mRS &lt;=1, t=0) = 20%.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">target_diff</span>  <span class="o">=</span> <span class="mf">0.20</span> <span class="o">-</span> <span class="n">pre_stroke_lvo_cumsum_ivt_deaths</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">current_diff</span> <span class="o">=</span> <span class="p">(</span><span class="n">no_treatment_lvo_cumsum_ivt_deaths</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> 
                <span class="n">pre_stroke_lvo_cumsum_ivt_deaths</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">weight_no_treatment_lvo</span>   <span class="o">=</span> <span class="n">target_diff</span> <span class="o">/</span> <span class="n">current_diff</span>
<span class="n">weight_pre_stroke_lvo</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">weight_no_treatment_lvo</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s1">&#39;Weights: </span><span class="si">{</span><span class="n">weight_no_treatment_lvo</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">,&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">weight_pre_stroke_lvo</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Weights: 0.8172, 0.1828
</pre></div>
</div>
</div>
</div>
<p>Apply the weights.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Apply weights</span>
<span class="n">t0_treatment_lvo_ivt_bins</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">weight_pre_stroke_lvo</span>   <span class="o">*</span> <span class="n">pre_stroke_lvo_bins_ivt_deaths</span><span class="p">)</span> <span class="o">+</span>
    <span class="p">(</span><span class="n">weight_no_treatment_lvo</span> <span class="o">*</span> <span class="n">no_treatment_lvo_bins_ivt_deaths</span><span class="p">))</span>

<span class="c1"># Normalise</span>
<span class="n">t0_treatment_lvo_ivt_bins</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">t0_treatment_lvo_ivt_bins</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">t0_treatment_lvo_ivt_bins</span><span class="p">))</span>

<span class="n">all_distributions_bins</span><span class="p">[</span><span class="s1">&#39;t0_treatment_lvo_ivt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t0_treatment_lvo_ivt_bins</span>

<span class="c1"># Make cumulative distribution</span>
<span class="n">t0_treatment_lvo_ivt_cumsum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">t0_treatment_lvo_ivt_bins</span><span class="p">)</span>
<span class="n">all_distributions_cumsum</span><span class="p">[</span><span class="s1">&#39;t0_treatment_lvo_ivt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t0_treatment_lvo_ivt_cumsum</span>

<span class="c1"># Show</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;LVO t0 IVT treatment effect&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---------------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS bins:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">t0_treatment_lvo_ivt_bins</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS cumulative:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">t0_treatment_lvo_ivt_cumsum</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LVO t0 IVT treatment effect
---------------------------
mRS bins:
array([0.1129, 0.0871, 0.1274, 0.1574, 0.2135, 0.1132, 0.1886])

mRS cumulative:
array([0.1129, 0.2   , 0.3274, 0.4848, 0.6982, 0.8114, 1.    ])
</pre></div>
</div>
</div>
</div>
</section>
<section id="lvo-t-0-treatment-with-mt">
<h2>LVO t=0 treatment with MT<a class="headerlink" href="#lvo-t-0-treatment-with-mt" title="Permalink to this headline">#</a></h2>
<p>The weighted combination of pre-stroke (75%) and untreated LVO at no-effect-time (25%). Hui et al. 2020 reported 75% successful recanalisation with thrombectomy. We assume that recanalisation at t=0 restores all pre-stroke function*. Pre-stroke mRS is for ischaemic stroke with NIHSS 11+ (from the SAMueL data set).</p>
<p>*Extrapolating results of good outcome, when recanalisation has been achieved with thrombectomy, from Fransen et al. 2016 back to t=0, assuming 75% recanalisation, gives the same proportion of patients with mRS &lt;= 2 as the pre-stroke mRS in the SAMueL data (therefore this extrapolation would suggest full recovery of all health with thrombectomy theoretically carried out at t=0).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight_pre_stroke_lvo</span> <span class="o">=</span> <span class="mf">0.75</span>
<span class="n">weight_no_treatment_lvo</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">weight_pre_stroke_lvo</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Weights: </span><span class="si">{</span><span class="n">weight_pre_stroke_lvo</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">,&#39;</span> \
      <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">weight_no_treatment_lvo</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Weights: 0.7500,0.2500
</pre></div>
</div>
</div>
</div>
<p>Apply the weights</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Apply weights</span>
<span class="n">t0_treatment_lvo_mt_bins</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">weight_pre_stroke_lvo</span>   <span class="o">*</span> <span class="n">pre_stroke_lvo_bins_mt_deaths</span><span class="p">)</span> <span class="o">+</span>
    <span class="p">(</span><span class="n">weight_no_treatment_lvo</span> <span class="o">*</span> <span class="n">no_treatment_lvo_bins_mt_deaths</span><span class="p">))</span>

<span class="c1"># Normalise</span>
<span class="n">t0_treatment_lvo_mt_bins</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">t0_treatment_lvo_mt_bins</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">t0_treatment_lvo_mt_bins</span><span class="p">))</span>
<span class="n">all_distributions_bins</span><span class="p">[</span><span class="s1">&#39;t0_treatment_lvo_mt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t0_treatment_lvo_mt_bins</span>

<span class="c1"># Make cumulative distribution</span>
<span class="n">t0_treatment_lvo_mt_cumsum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">t0_treatment_lvo_mt_bins</span><span class="p">)</span>
<span class="n">all_distributions_cumsum</span><span class="p">[</span><span class="s1">&#39;t0_treatment_lvo_mt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t0_treatment_lvo_mt_cumsum</span>

<span class="c1"># Show</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;LVO MT t0 treatment effect&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--------------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS bins:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">t0_treatment_lvo_mt_bins</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mRS cumulative:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">t0_treatment_lvo_mt_cumsum</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LVO MT t0 treatment effect
--------------------------
mRS bins:
array([0.314 , 0.1222, 0.118 , 0.1578, 0.1411, 0.063 , 0.0839])

mRS cumulative:
array([0.314 , 0.4362, 0.5542, 0.712 , 0.8531, 0.9161, 1.    ])
</pre></div>
</div>
</div>
</div>
</section>
<section id="show-all-results">
<h2>Show all results<a class="headerlink" href="#show-all-results" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_distributions_bins_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">all_distributions_bins</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">all_distributions_bins_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span>
    <span class="s1">&#39;./outcome_utilities/mrs_dist_probs_bins.csv&#39;</span><span class="p">,</span> <span class="n">index_label</span><span class="o">=</span><span class="s1">&#39;Stroke type&#39;</span><span class="p">)</span>
<span class="n">all_distributions_bins_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>pre_stroke_nlvo</th>
      <td>0.5829</td>
      <td>0.1625</td>
      <td>0.1034</td>
      <td>0.1022</td>
      <td>0.0420</td>
      <td>0.0069</td>
      <td>0.0000</td>
    </tr>
    <tr>
      <th>pre_stroke_nlvo_ivt_deaths</th>
      <td>0.5765</td>
      <td>0.1608</td>
      <td>0.1023</td>
      <td>0.1011</td>
      <td>0.0415</td>
      <td>0.0069</td>
      <td>0.0110</td>
    </tr>
    <tr>
      <th>pre_stroke_lvo</th>
      <td>0.4179</td>
      <td>0.1430</td>
      <td>0.1184</td>
      <td>0.1642</td>
      <td>0.1138</td>
      <td>0.0427</td>
      <td>0.0000</td>
    </tr>
    <tr>
      <th>pre_stroke_lvo_ivt_deaths</th>
      <td>0.4036</td>
      <td>0.1381</td>
      <td>0.1144</td>
      <td>0.1586</td>
      <td>0.1099</td>
      <td>0.0413</td>
      <td>0.0341</td>
    </tr>
    <tr>
      <th>pre_stroke_lvo_mt_deaths</th>
      <td>0.4028</td>
      <td>0.1378</td>
      <td>0.1142</td>
      <td>0.1583</td>
      <td>0.1097</td>
      <td>0.0412</td>
      <td>0.0360</td>
    </tr>
    <tr>
      <th>no_treatment_nlvo</th>
      <td>0.1971</td>
      <td>0.2629</td>
      <td>0.1200</td>
      <td>0.1277</td>
      <td>0.1479</td>
      <td>0.0620</td>
      <td>0.0823</td>
    </tr>
    <tr>
      <th>no_effect_nlvo_ivt_deaths</th>
      <td>0.1973</td>
      <td>0.2627</td>
      <td>0.1176</td>
      <td>0.1247</td>
      <td>0.1430</td>
      <td>0.0592</td>
      <td>0.0955</td>
    </tr>
    <tr>
      <th>t0_treatment_nlvo_ivt</th>
      <td>0.4298</td>
      <td>0.2002</td>
      <td>0.1082</td>
      <td>0.1102</td>
      <td>0.0808</td>
      <td>0.0271</td>
      <td>0.0437</td>
    </tr>
    <tr>
      <th>no_treatment_lvo</th>
      <td>0.0500</td>
      <td>0.0790</td>
      <td>0.1360</td>
      <td>0.1640</td>
      <td>0.2470</td>
      <td>0.1350</td>
      <td>0.1890</td>
    </tr>
    <tr>
      <th>no_effect_lvo_ivt_deaths</th>
      <td>0.0479</td>
      <td>0.0757</td>
      <td>0.1303</td>
      <td>0.1571</td>
      <td>0.2366</td>
      <td>0.1293</td>
      <td>0.2231</td>
    </tr>
    <tr>
      <th>no_effect_lvo_mt_deaths</th>
      <td>0.0476</td>
      <td>0.0752</td>
      <td>0.1295</td>
      <td>0.1562</td>
      <td>0.2353</td>
      <td>0.1286</td>
      <td>0.2275</td>
    </tr>
    <tr>
      <th>t0_treatment_lvo_ivt</th>
      <td>0.1129</td>
      <td>0.0871</td>
      <td>0.1274</td>
      <td>0.1574</td>
      <td>0.2135</td>
      <td>0.1132</td>
      <td>0.1886</td>
    </tr>
    <tr>
      <th>t0_treatment_lvo_mt</th>
      <td>0.3140</td>
      <td>0.1222</td>
      <td>0.1180</td>
      <td>0.1578</td>
      <td>0.1411</td>
      <td>0.0630</td>
      <td>0.0839</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_distributions_cumsum_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">all_distributions_cumsum</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">all_distributions_cumsum_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span>
    <span class="s1">&#39;./outcome_utilities/mrs_dist_probs_cumsum.csv&#39;</span><span class="p">,</span> <span class="n">index_label</span><span class="o">=</span><span class="s1">&#39;Stroke type&#39;</span><span class="p">)</span>
<span class="n">all_distributions_cumsum_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>pre_stroke_nlvo</th>
      <td>0.5829</td>
      <td>0.7454</td>
      <td>0.8489</td>
      <td>0.9511</td>
      <td>0.9931</td>
      <td>1.0000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>pre_stroke_nlvo_ivt_deaths</th>
      <td>0.5765</td>
      <td>0.7372</td>
      <td>0.8395</td>
      <td>0.9406</td>
      <td>0.9821</td>
      <td>0.9890</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>pre_stroke_lvo</th>
      <td>0.4179</td>
      <td>0.5609</td>
      <td>0.6793</td>
      <td>0.8435</td>
      <td>0.9573</td>
      <td>1.0000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>pre_stroke_lvo_ivt_deaths</th>
      <td>0.4036</td>
      <td>0.5417</td>
      <td>0.6561</td>
      <td>0.8147</td>
      <td>0.9246</td>
      <td>0.9659</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>pre_stroke_lvo_mt_deaths</th>
      <td>0.4028</td>
      <td>0.5407</td>
      <td>0.6548</td>
      <td>0.8131</td>
      <td>0.9228</td>
      <td>0.9640</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>no_treatment_nlvo</th>
      <td>0.1971</td>
      <td>0.4600</td>
      <td>0.5800</td>
      <td>0.7078</td>
      <td>0.8557</td>
      <td>0.9177</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>no_effect_nlvo_ivt_deaths</th>
      <td>0.1973</td>
      <td>0.4600</td>
      <td>0.5776</td>
      <td>0.7023</td>
      <td>0.8452</td>
      <td>0.9045</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>t0_treatment_nlvo_ivt</th>
      <td>0.4298</td>
      <td>0.6300</td>
      <td>0.7382</td>
      <td>0.8484</td>
      <td>0.9292</td>
      <td>0.9563</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>no_treatment_lvo</th>
      <td>0.0500</td>
      <td>0.1290</td>
      <td>0.2650</td>
      <td>0.4290</td>
      <td>0.6760</td>
      <td>0.8110</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>no_effect_lvo_ivt_deaths</th>
      <td>0.0479</td>
      <td>0.1236</td>
      <td>0.2539</td>
      <td>0.4110</td>
      <td>0.6476</td>
      <td>0.7769</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>no_effect_lvo_mt_deaths</th>
      <td>0.0476</td>
      <td>0.1229</td>
      <td>0.2524</td>
      <td>0.4086</td>
      <td>0.6439</td>
      <td>0.7725</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>t0_treatment_lvo_ivt</th>
      <td>0.1129</td>
      <td>0.2000</td>
      <td>0.3274</td>
      <td>0.4848</td>
      <td>0.6982</td>
      <td>0.8114</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>t0_treatment_lvo_mt</th>
      <td>0.3140</td>
      <td>0.4362</td>
      <td>0.5542</td>
      <td>0.7120</td>
      <td>0.8531</td>
      <td>0.9161</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="plot-distributions">
<h2>Plot distributions<a class="headerlink" href="#plot-distributions" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn-colorblind&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">draw_horizontal_bar</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Draw a stacked horizontal bar chart of the values in &#39;dist&#39;.</span>
<span class="sd">    </span>
<span class="sd">    dist  - list or np.array. The probability distribution </span>
<span class="sd">            (non-cumulative).</span>
<span class="sd">    label - string. The name printed next to these stacked bars.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">colour_list</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.prop_cycle&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">by_key</span><span class="p">()[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span>
    <span class="c1"># The first bar will start at this point on the x-axis:</span>
    <span class="n">left</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dist</span><span class="p">)):</span>
        <span class="c1"># Draw a bar starting from &#39;left&#39;, the end of the previous bar,</span>
        <span class="c1"># with a width equal to the probability of this mRS:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">dist</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">left</span><span class="o">=</span><span class="n">left</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> 
                 <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colour_list</span><span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="k">6</span>])
        <span class="c1"># Update &#39;left&#39; with the width of the current bar so that the </span>
        <span class="c1"># next bar drawn will start in the correct place.    </span>
        <span class="n">left</span> <span class="o">+=</span> <span class="n">dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">draw_connections</span><span class="p">(</span><span class="n">dist_t0</span><span class="p">,</span> <span class="n">dist_tne</span><span class="p">,</span> <span class="n">top_tne</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">bottom_t0</span><span class="o">=</span><span class="mf">0.75</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Draw lines connecting the mRS bins in the top and bottom rows.</span>
<span class="sd">    </span>
<span class="sd">    dist_t0, dist_tne - lists or arrays. Probability distributions.</span>
<span class="sd">    top_tne, bottom_t0 - floats. y-coordinates just inside the bars. </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">left_t0</span>   <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">left_tne</span>  <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">d_t0</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dist_t0</span><span class="p">):</span>
        <span class="n">left_t0</span>  <span class="o">+=</span> <span class="n">dist_t0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">left_tne</span> <span class="o">+=</span> <span class="n">dist_tne</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">left_t0</span><span class="p">,</span><span class="n">left_tne</span><span class="p">],[</span><span class="n">bottom_t0</span><span class="p">,</span><span class="n">top_tne</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_info</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="n">no_effect_nlvo_ivt_bins</span><span class="p">,</span> <span class="n">t0_treatment_nlvo_ivt_bins</span><span class="p">,</span> <span class="s1">&#39;nLVO-IVT&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">no_treatment_lvo_bins</span><span class="p">,</span> <span class="n">t0_treatment_lvo_ivt_bins</span><span class="p">,</span> <span class="s1">&#39;LVO-IVT&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">no_treatment_lvo_bins</span><span class="p">,</span> <span class="n">t0_treatment_lvo_mt_bins</span><span class="p">,</span> <span class="s1">&#39;LVO-MT&#39;</span><span class="p">]]</span>

<span class="k">for</span> <span class="n">info</span> <span class="ow">in</span> <span class="n">plot_info</span><span class="p">:</span>
    
    <span class="c1"># Draw no effect distribution</span>
    <span class="n">draw_horizontal_bar</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;No effect time&#39;</span><span class="p">)</span>
    
    <span class="c1"># Add legend now to prevent doubling all the labels:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">ncol</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;mRS&#39;</span><span class="p">,</span> 
               <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.5</span><span class="p">])</span>   <span class="c1"># Legend below axis.</span>
    
    <span class="c1"># Draww t=0 distribution</span>
    <span class="n">draw_horizontal_bar</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;t=0hr&#39;</span><span class="p">)</span>
    
    <span class="c1"># Darw connecting lines</span>
    <span class="n">draw_connections</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">info</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    
    <span class="c1"># Add general content</span>
    <span class="n">label</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Probability&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;./images/</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1">.jpg&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span> 
        <span class="n">pad_inches</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/mRS_datasets_full_61_0.png" src="_images/mRS_datasets_full_61_0.png" />
<img alt="_images/mRS_datasets_full_61_1.png" src="_images/mRS_datasets_full_61_1.png" />
<img alt="_images/mRS_datasets_full_61_2.png" src="_images/mRS_datasets_full_61_2.png" />
</div>
</div>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">#</a></h2>
<p>de la Ossa Herrero N, Carrera D, Gorchs M, Querol M, Millán M, Gomis M, et al. Design and Validation of a Prehospital Stroke Scale to Predict Large Arterial Occlusion The Rapid Arterial Occlusion Evaluation Scale. Stroke; a journal of cerebral circulation. 2013 Nov 26;45.</p>
<p>Emberson J, Lees KR, Lyden P, et al. <em>Effect of treatment delay, age, and stroke severity on the effects of intravenous thrombolysis with alteplase for acute ischaemic stroke: A meta-analysis of individual patient data from randomised trials.</em> The Lancet 2014;384:1929–35. doi:10.1016/S0140-6736(14)60584-5</p>
<p>Fransen, P., Berkhemer, O., Lingsma, H. et al. Time to Reperfusion and Treatment Effect for Acute Ischemic Stroke: A Randomized Clinical Trial. JAMA Neurol. 2016 Feb 1;73(2):190–6. DOI: 10.1001/jamaneurol.2015.3886</p>
<p>Goyal M, Menon BK, van Zwam WH, et al. <em>Endovascular thrombectomy after large-vessel ischaemic stroke: a meta-analysis of individual patient data from five randomised trials.</em> The Lancet 2016;387:1723-1731. doi:10.1016/S0140-6736(16)00163-X</p>
<p>Hui W, Wu C, Zhao W, Sun H, Hao J, Liang H, et al. Efficacy and Safety of Recanalization Therapy for Acute Ischemic Stroke With Large Vessel Occlusion. Stroke. 2020 Jul;51(7):2026–35.</p>
<p>Lees KR, Bluhmki E, von Kummer R, et al. <em>Time to treatment with intravenous alteplase and outcome in stroke: an updated pooled analysis of ECASS, ATLANTIS, NINDS, and EPITHET trials</em>. The Lancet 2010;375:1695-703. doi:10.1016/S0140-6736(10)60491-6</p>
<p>McMeekin P, White P, James MA, Price CI, Flynn D, Ford GA. Estimating the number of UK stroke patients eligible for endovascular thrombectomy. European Stroke Journal. 2017;2:319–26.</p>
<p>SAMueL-1 data on mRS before stroke (DOI: 10.5281/zenodo.6896710): <a class="reference external" href="https://samuel-book.github.io/samuel-1/descriptive_stats/08_prestroke_mrs.html">https://samuel-book.github.io/samuel-1/descriptive_stats/08_prestroke_mrs.html</a></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="intro.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Predicting granular disability outcomes after treatment of stroke with thrombolysis (IVT) or thrombectomy (MT)</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="mRS_outcomes_maths.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Mathematics for calculating odds and probabilities of mRS-level outcomes after stroke, based on time to reperfusion treatment</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Anna Laws & Michael Allen<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>